/*
 * Integrated by Dominique Cavailhez (c) 2016
 * https://github.com/Dominique92/MyLeaflet
 * Includes parts of :
	https://github.com/Dominique92/Leaflet.GeoJSON.Ajax/commit/b7c40acf84784877bb86497976a23dbd844fc56a
	https://github.com/Dominique92/Leaflet.Map.MultiVendors/commit/f071889a25e92ccc10b20ba192a4eef0a289a92d
	https://github.com/Dominique92/Leaflet.Marker.coordinates/commit/22e32460b86dc07142ce43b2bc1401fc468184d6
	https://github.com/Dominique92/Leaflet.Permalink.Cookies/commit/b34704272cac9c028666675716218bd3c6700c20
	https://github.com/Dominique92/Leaflet.draw.plus/commit/718441c75b35cef4d53a1b5598b96139024b08cb
	https://github.com/Dominique92/MyLeaflet/commit/f50c076cb0b5142539669d85245b2030a00b1e75
	https://github.com/Leaflet/Leaflet.draw/commit/818af15d667dcb86d3cc42ad548b24a7358af3d4
	https://github.com/Leaflet/Leaflet.fullscreen/commit/22141a4a2224e0fab02ce37d6472c92f6d9d03de
	https://github.com/Leaflet/Leaflet/commit/ed36a04aefd12cb92c78074fe63a8e460db1d464
	https://github.com/MrMufflon/Leaflet.Coordinates/commit/09ffcfdfa2bee2a7cee24a9653baef0ec0abc660
	https://github.com/erictheise/rrose/commit/04fac08b0b367e137b64fb4e5e08e2dd020955c6
	https://github.com/k4r573n/leaflet-control-osm-geocoder/commit/4a886e2725c6af998338f4866671f39e323aa6b8
	https://github.com/kartena/Proj4Leaflet/commit/a71147055b60380b1e9e9db69df994221009d268
	https://github.com/makinacorpus/Leaflet.FileLayer/commit/41d5aa292038f64b00cc946d01baffd33f78140a
	https://github.com/makinacorpus/Leaflet.GeometryUtil/commit/0d23b1db73b9416165673f44a07c064fd4584749
	https://github.com/makinacorpus/Leaflet.Snap/commit/43fbe4f6a7cd2b275912294d7d27e1034639e519
	https://github.com/mapbox/togeojson/commit/79bc6a3d2c6a0da4eb15542e4d880776d0862090
	https://github.com/proj4js/proj4js/commit/6b0324e49ccc0351552be8b872157b9113f70fab
	https://github.com/rob-murray/os-leaflet/commit/9a7d11ed12b9421c55b99f871fe15018848d850d
	https://github.com/rowanwins/leaflet-easyPrint/commit/77d57fb56c5126dc02dc08ddf93bdc8e6bf689ab
	https://github.com/shramov/leaflet-plugins/commit/0d639aad6a2618d2be3527964236c0a24091c540
	https://github.com/stefanocudini/leaflet-gps/commit/e90fbee2af3e62f9203c301d844557d1e873a32c
*/

!function(e,i,n){function a(){var i=e.L;t.noConflict=function(){return e.L=i,this},e.L=t};var t={version:'1.0.3'};'object'==typeof module&&'object'==typeof module.exports?module.exports=t:'function'==typeof define&&define.amd&&define(t),'undefined'!=typeof e&&a(),t.Util={extend:function(t){var i,e,o,n;for(e=1,o=arguments.length;e<o;e++){n=arguments[e];for(i in n)t[i]=n[i]};return t},create:Object.create||function(){function t(){};return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(e){return e._leaflet_id=e._leaflet_id||++t.Util.lastId,e._leaflet_id},lastId:0,throttle:function(t,e,i){var o,n,s,r;return r=function(){o=!1,n&&(s.apply(i,n),n=!1)},s=function(){o?n=arguments:(t.apply(i,arguments),setTimeout(r,e),o=!0)}},wrapNum:function(t,e,i){var s=e[1],n=e[0],o=s-n;return t===s&&i?t:((t-n)%o+o)%o+n},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,'')},splitWords:function(e){return t.Util.trim(e).split(/\s+/)},setOptions:function(e,i){e.hasOwnProperty('options')||(e.options=e.options?t.Util.create(e.options):{});for(var n in i)e.options[n]=i[n];return e.options},getParamString:function(t,e,i){var o=[];for(var n in t)o.push(encodeURIComponent(i?n.toUpperCase():n)+'='+encodeURIComponent(t[n]));return(e&&e.indexOf('?')!==-1?'&':'?')+o.join('&')},template:function(e,i){return e.replace(t.Util.templateRe,function(t,e){var o=i[e];if(o===n)throw new Error('No value provided for variable '+t);return'function'==typeof o&&(o=o(i)),o})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return'[object Array]'===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs='},function(){function i(t){return e['webkit'+t]||e['moz'+t]||e['ms'+t]};function s(t){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,e.setTimeout(t,o)};var n=0,o=e.requestAnimationFrame||i('RequestAnimationFrame')||s,r=e.cancelAnimationFrame||i('CancelAnimationFrame')||i('CancelRequestAnimationFrame')||function(t){e.clearTimeout(t)};t.Util.requestAnimFrame=function(i,n,r){return r&&o===s?void i.call(n):o.call(e,t.bind(i,n))},t.Util.cancelAnimFrame=function(t){t&&r.call(e,t)}}(),t.extend=t.Util.extend,t.bind=t.Util.bind,t.stamp=t.Util.stamp,t.setOptions=t.Util.setOptions,t.Class=function(){},t.Class.extend=function(e){var n=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},s=n.__super__=this.prototype,i=t.Util.create(s);i.constructor=n,n.prototype=i;for(var o in this)this.hasOwnProperty(o)&&'prototype'!==o&&(n[o]=this[o]);return e.statics&&(t.extend(n,e.statics),delete e.statics),e.includes&&(t.Util.extend.apply(null,[i].concat(e.includes)),delete e.includes),i.options&&(e.options=t.Util.extend(t.Util.create(i.options),e.options)),t.extend(i,e),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){s.callInitHooks&&s.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},n},t.Class.include=function(e){return t.extend(this.prototype,e),this},t.Class.mergeOptions=function(e){return t.extend(this.prototype.options,e),this},t.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i='function'==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},t.Evented=t.Class.extend({on:function(e,i,n){if('object'==typeof e)for(var s in e)this._on(s,e[s],i);else{e=t.Util.splitWords(e);for(var o=0,r=e.length;o<r;o++)this._on(e[o],i,n)};return this},off:function(e,i,n){if(e)if('object'==typeof e)for(var s in e)this._off(s,e[s],i);else{e=t.Util.splitWords(e);for(var o=0,r=e.length;o<r;o++)this._off(e[o],i,n)}
else delete this._events;return this},_on:function(t,e,i){this._events=this._events||{};var r=this._events[t];r||(r=[],this._events[t]=r),i===this&&(i=n);for(var a={fn:e,ctx:i},o=r,s=0,h=o.length;s<h;s++)if(o[s].fn===e&&o[s].ctx===i)return;o.push(a)},_off:function(e,i,o){var s,r,a;if(this._events&&(s=this._events[e])){if(!i){for(r=0,a=s.length;r<a;r++)s[r].fn=t.Util.falseFn;return void delete this._events[e]};if(o===this&&(o=n),s)for(r=0,a=s.length;r<a;r++){var h=s[r];if(h.ctx===o&&h.fn===i)return h.fn=t.Util.falseFn,this._firingCount&&(this._events[e]=s=s.slice()),void s.splice(r,1)}}},fire:function(e,i,n){if(!this.listens(e,n))return this;var a=t.Util.extend({},i,{type:e,target:this});if(this._events){var s=this._events[e];if(s){this._firingCount=this._firingCount+1||1;for(var o=0,h=s.length;o<h;o++){var r=s[o];r.fn.call(r.ctx||this,a)};this._firingCount--}};return n&&this._propagateEvent(a),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(e,i,n){if('object'==typeof e){for(var s in e)this.once(s,e[s],i);return this};var o=t.bind(function(){this.off(e,i,n).off(e,o,n)},this);return this.on(e,i,n).on(e,o,n)},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[t.stamp(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[t.stamp(e)],this},_propagateEvent:function(e){for(var i in this._eventParents)this._eventParents[i].fire(e.type,t.extend({layer:e.target},e),!0)}});var o=t.Evented.prototype;o.addEventListener=o.on,o.removeEventListener=o.clearAllEventListeners=o.off,o.addOneTimeEventListener=o.once,o.fireEvent=o.fire,o.hasEventListeners=o.listens,t.Mixin={Events:o},function(){var n=navigator.userAgent.toLowerCase(),r=i.documentElement,s='ActiveXObject'in e,a=n.indexOf('webkit')!==-1,v=n.indexOf('phantom')!==-1,l=n.search('android [23]')!==-1,u=n.indexOf('chrome')!==-1,c=n.indexOf('gecko')!==-1&&!a&&!e.opera&&!s,y=0===navigator.platform.indexOf('Win'),o='undefined'!=typeof orientation||n.indexOf('mobile')!==-1,d=!e.PointerEvent&&e.MSPointerEvent,m=e.PointerEvent||d,p=s&&'transition'in r.style,h='WebKitCSSMatrix'in e&&'m11'in new e.WebKitCSSMatrix&&!l,f='MozPerspective'in r.style,g='OTransition'in r.style,P=!e.L_NO_TOUCH&&(m||'ontouchstart'in e||e.DocumentTouch&&i instanceof e.DocumentTouch);t.Browser={ie:s,ielt9:s&&!i.addEventListener,edge:'msLaunchUri'in navigator&&!('documentMode'in i),webkit:a,gecko:c,android:n.indexOf('android')!==-1,android23:l,chrome:u,safari:!u&&n.indexOf('safari')!==-1,win:y,ie3d:p,webkit3d:h,gecko3d:f,opera12:g,any3d:!e.L_DISABLE_3D&&(p||h||f)&&!g&&!v,mobile:o,mobileWebkit:o&&a,mobileWebkit3d:o&&h,mobileOpera:o&&e.opera,mobileGecko:o&&c,touch:!!P,msPointer:!!d,pointer:!!m,retina:(e.devicePixelRatio||e.screen.deviceXDPI/e.screen.logicalXDPI)>1}}(),t.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},t.Point.prototype={clone:function(){return new t.Point(this.x,this.y)},add:function(e){return this.clone()._add(t.point(e))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(e){return this.clone()._subtract(t.point(e))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(e){return new t.Point(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new t.Point(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(e){e=t.point(e);var i=e.x-this.x,n=e.y-this.y;return Math.sqrt(i*i+n*n)},equals:function(e){return e=t.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=t.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return'Point('+t.Util.formatNum(this.x)+', '+t.Util.formatNum(this.y)+')'}},t.point=function(e,i,o){return e instanceof t.Point?e:t.Util.isArray(e)?new t.Point(e[0],e[1]):e===n||null===e?e:'object'==typeof e&&'x'in e&&'y'in e?new t.Point(e.x,e.y):new t.Point(e,i,o)},t.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])},t.Bounds.prototype={extend:function(e){return e=t.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new t.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new t.Point(this.min.x,this.max.y)},getTopRight:function(){return new t.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var i,n;return e='number'==typeof e[0]||e instanceof t.Point?t.point(e):t.bounds(e),e instanceof t.Bounds?(i=e.min,n=e.max):i=n=e,i.x>=this.min.x&&n.x<=this.max.x&&i.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=t.bounds(e);var i=this.min,n=this.max,o=e.min,s=e.max,r=s.x>=i.x&&o.x<=n.x,a=s.y>=i.y&&o.y<=n.y;return r&&a},overlaps:function(e){e=t.bounds(e);var i=this.min,n=this.max,o=e.min,s=e.max,r=s.x>i.x&&o.x<n.x,a=s.y>i.y&&o.y<n.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},t.bounds=function(e,i){return!e||e instanceof t.Bounds?e:new t.Bounds(e,i)},t.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},t.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(e,i){return i=i||1,new t.Point((e.x/i-this._b)/this._a,(e.y/i-this._d)/this._c)}},t.DomUtil={get:function(t){return'string'==typeof t?i.getElementById(t):t},getStyle:function(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||'auto'===n)&&i.defaultView){var o=i.defaultView.getComputedStyle(t,null);n=o?o[e]:null};return'auto'===n?null:n},create:function(t,e,n){var o=i.createElement(t);return o.className=e||'',n&&n.appendChild(o),o},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(e,i){if(e.classList!==n)return e.classList.contains(i);var o=t.DomUtil.getClass(e);return o.length>0&&new RegExp('(^|\\s)'+i+'(\\s|$)').test(o)},addClass:function(e,i){if(e.classList!==n)for(var r=t.Util.splitWords(i),o=0,a=r.length;o<a;o++)e.classList.add(r[o]);else if(!t.DomUtil.hasClass(e,i)){var s=t.DomUtil.getClass(e);t.DomUtil.setClass(e,(s?s+' ':'')+i)}},removeClass:function(e,i){e.classList!==n?e.classList.remove(i):t.DomUtil.setClass(e,t.Util.trim((' '+t.DomUtil.getClass(e)+' ').replace(' '+i+' ',' ')))},setClass:function(t,e){t.className.baseVal===n?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===n?t.className:t.className.baseVal},setOpacity:function(e,i){'opacity'in e.style?e.style.opacity=i:'filter'in e.style&&t.DomUtil._setOpacityIE(e,i)},_setOpacityIE:function(t,e){var i=!1,o='DXImageTransform.Microsoft.Alpha';try{i=t.filters.item(o)}catch(n){if(1===e)return};e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=' progid:'+o+'(opacity='+e+')'},testProp:function(t){for(var n=i.documentElement.style,e=0;e<t.length;e++)if(t[e]in n)return t[e];return!1},setTransform:function(e,i,n){var o=i||new t.Point(0,0);e.style[t.DomUtil.TRANSFORM]=(t.Browser.ie3d?'translate('+o.x+'px,'+o.y+'px)':'translate3d('+o.x+'px,'+o.y+'px,0)')+(n?' scale('+n+')':'')},setPosition:function(e,i){e._leaflet_pos=i,t.Browser.any3d?t.DomUtil.setTransform(e,i):(e.style.left=i.x+'px',e.style.top=i.y+'px')},getPosition:function(e){return e._leaflet_pos||new t.Point(0,0)}},function(){t.DomUtil.TRANSFORM=t.DomUtil.testProp(['transform','WebkitTransform','OTransform','MozTransform','msTransform']);var o=t.DomUtil.TRANSITION=t.DomUtil.testProp(['webkitTransition','transition','OTransition','MozTransition','msTransition']);if(t.DomUtil.TRANSITION_END='webkitTransition'===o||'OTransition'===o?o+'End':'transitionend','onselectstart'in i)t.DomUtil.disableTextSelection=function(){t.DomEvent.on(e,'selectstart',t.DomEvent.preventDefault)},t.DomUtil.enableTextSelection=function(){t.DomEvent.off(e,'selectstart',t.DomEvent.preventDefault)};else{var n=t.DomUtil.testProp(['userSelect','WebkitUserSelect','OUserSelect','MozUserSelect','msUserSelect']);t.DomUtil.disableTextSelection=function(){if(n){var t=i.documentElement.style;this._userSelect=t[n],t[n]='none'}},t.DomUtil.enableTextSelection=function(){n&&(i.documentElement.style[n]=this._userSelect,delete this._userSelect)}};t.DomUtil.disableImageDrag=function(){t.DomEvent.on(e,'dragstart',t.DomEvent.preventDefault)},t.DomUtil.enableImageDrag=function(){t.DomEvent.off(e,'dragstart',t.DomEvent.preventDefault)},t.DomUtil.preventOutline=function(i){for(;i.tabIndex===-1;)i=i.parentNode;i&&i.style&&(t.DomUtil.restoreOutline(),this._outlineElement=i,this._outlineStyle=i.style.outline,i.style.outline='none',t.DomEvent.on(e,'keydown',t.DomUtil.restoreOutline,this))},t.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,t.DomEvent.off(e,'keydown',t.DomUtil.restoreOutline,this))}}(),t.LatLng=function(t,e,i){if(isNaN(t)||isNaN(e))throw new Error('Invalid LatLng object: ('+t+', '+e+')');this.lat=+t,this.lng=+e,i!==n&&(this.alt=+i)},t.LatLng.prototype={equals:function(e,i){if(!e)return!1;e=t.latLng(e);var o=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return o<=(i===n?1e-9:i)},toString:function(e){return'LatLng('+t.Util.formatNum(this.lat,e)+', '+t.Util.formatNum(this.lng,e)+')'},distanceTo:function(e){return t.CRS.Earth.distance(this,t.latLng(e))},wrap:function(){return t.CRS.Earth.wrapLatLng(this)},toBounds:function(e){var i=180*e/40075017,n=i/Math.cos(Math.PI/180*this.lat);return t.latLngBounds([this.lat-i,this.lng-n],[this.lat+i,this.lng+n])},clone:function(){return new t.LatLng(this.lat,this.lng,this.alt)}},t.latLng=function(e,i,o){return e instanceof t.LatLng?e:t.Util.isArray(e)&&'object'!=typeof e[0]?3===e.length?new t.LatLng(e[0],e[1],e[2]):2===e.length?new t.LatLng(e[0],e[1]):null:e===n||null===e?e:'object'==typeof e&&'lat'in e?new t.LatLng(e.lat,'lng'in e?e.lng:e.lon,e.alt):i===n?null:new t.LatLng(e,i,o)},t.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])},t.LatLngBounds.prototype={extend:function(e){var i,n,o=this._southWest,s=this._northEast;if(e instanceof t.LatLng)i=e,n=e;else{if(!(e instanceof t.LatLngBounds))return e?this.extend(t.latLng(e)||t.latLngBounds(e)):this;if(i=e._southWest,n=e._northEast,!i||!n)return this};return o||s?(o.lat=Math.min(i.lat,o.lat),o.lng=Math.min(i.lng,o.lng),s.lat=Math.max(n.lat,s.lat),s.lng=Math.max(n.lng,s.lng)):(this._southWest=new t.LatLng(i.lat,i.lng),this._northEast=new t.LatLng(n.lat,n.lng)),this},pad:function(e){var i=this._southWest,n=this._northEast,o=Math.abs(i.lat-n.lat)*e,s=Math.abs(i.lng-n.lng)*e;return new t.LatLngBounds(new t.LatLng(i.lat-o,i.lng-s),new t.LatLng(n.lat+o,n.lng+s))},getCenter:function(){return new t.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new t.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new t.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e='number'==typeof e[0]||e instanceof t.LatLng||'lat'in e?t.latLng(e):t.latLngBounds(e);var i,n,o=this._southWest,s=this._northEast;return e instanceof t.LatLngBounds?(i=e.getSouthWest(),n=e.getNorthEast()):i=n=e,i.lat>=o.lat&&n.lat<=s.lat&&i.lng>=o.lng&&n.lng<=s.lng},intersects:function(e){e=t.latLngBounds(e);var i=this._southWest,n=this._northEast,o=e.getSouthWest(),s=e.getNorthEast(),r=s.lat>=i.lat&&o.lat<=n.lat,a=s.lng>=i.lng&&o.lng<=n.lng;return r&&a},overlaps:function(e){e=t.latLngBounds(e);var i=this._southWest,n=this._northEast,o=e.getSouthWest(),s=e.getNorthEast(),r=s.lat>i.lat&&o.lat<n.lat,a=s.lng>i.lng&&o.lng<n.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(',')},equals:function(e){return!!e&&(e=t.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},t.latLngBounds=function(e,i){return e instanceof t.LatLngBounds?e:new t.LatLngBounds(e,i)},t.Projection={},t.Projection.LonLat={project:function(e){return new t.Point(e.lng,e.lat)},unproject:function(e){return new t.LatLng(e.y,e.x)},bounds:t.bounds([-180,-90],[180,90])},t.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(e){var i=Math.PI/180,n=this.MAX_LATITUDE,s=Math.max(Math.min(n,e.lat),-n),o=Math.sin(s*i);return new t.Point(this.R*e.lng*i,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(e){var i=180/Math.PI;return new t.LatLng((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*i,e.x*i/this.R)},bounds:function(){var e=6378137*Math.PI;return t.bounds([-e,-e],[e,e])}()},t.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var i=this.projection.bounds,n=this.scale(e),o=this.transformation.transform(i.min,n),s=this.transformation.transform(i.max,n);return t.bounds(o,s)},infinite:!1,wrapLatLng:function(e){var i=this.wrapLng?t.Util.wrapNum(e.lng,this.wrapLng,!0):e.lng,n=this.wrapLat?t.Util.wrapNum(e.lat,this.wrapLat,!0):e.lat,o=e.alt;return t.latLng(n,i,o)},wrapLatLngBounds:function(e){var i=e.getCenter(),a=this.wrapLatLng(i),n=i.lat-a.lat,o=i.lng-a.lng;if(0===n&&0===o)return e;var s=e.getSouthWest(),r=e.getNorthEast(),h=t.latLng({lat:s.lat-n,lng:s.lng-o}),l=t.latLng({lat:r.lat-n,lng:r.lng-o});return new t.LatLngBounds(h,l)}},t.CRS.Simple=t.extend({},t.CRS,{projection:t.Projection.LonLat,transformation:new t.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),t.CRS.Earth=t.extend({},t.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,s=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(s,1))}}),t.CRS.EPSG3857=t.extend({},t.CRS.Earth,{code:'EPSG:3857',projection:t.Projection.SphericalMercator,transformation:function(){var e=.5/(Math.PI*t.Projection.SphericalMercator.R);return new t.Transformation(e,.5,-e,.5)}()}),t.CRS.EPSG900913=t.extend({},t.CRS.EPSG3857,{code:'EPSG:900913'}),t.CRS.EPSG4326=t.extend({},t.CRS.Earth,{code:'EPSG:4326',projection:t.Projection.LonLat,transformation:new t.Transformation(1/180,1,-1/180,.5)}),t.Map=t.Evented.extend({options:{crs:t.CRS.EPSG3857,center:n,zoom:n,minZoom:n,maxZoom:n,layers:[],maxBounds:n,renderer:n,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,i){i=t.setOptions(this,i),this._initContainer(e),this._initLayout(),this._onResize=t.bind(this._onResize,this),this._initEvents(),i.maxBounds&&this.setMaxBounds(i.maxBounds),i.zoom!==n&&(this._zoom=this._limitZoom(i.zoom)),i.center&&i.zoom!==n&&this.setView(t.latLng(i.center),i.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=t.DomUtil.TRANSITION&&t.Browser.any3d&&!t.Browser.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),t.DomEvent.on(this._proxy,t.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,i,o){if(i=i===n?this._zoom:this._limitZoom(i),e=this._limitCenter(t.latLng(e),i,this.options.maxBounds),o=o||{},this._stop(),this._loaded&&!o.reset&&o!==!0){o.animate!==n&&(o.zoom=t.extend({animate:o.animate},o.zoom),o.pan=t.extend({animate:o.animate,duration:o.duration},o.pan));var s=this._zoom!==i?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,i,o.zoom):this._tryAnimatedPan(e,o.pan);if(s)return clearTimeout(this._sizeTimer),this};return this._resetView(e,i),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(e,i){return e=e||(t.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,i)},zoomOut:function(e,i){return e=e||(t.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,i)},setZoomAround:function(e,i,n){var s=this.getZoomScale(i),o=this.getSize().divideBy(2),r=e instanceof t.Point?e:this.latLngToContainerPoint(e),a=r.subtract(o).multiplyBy(1-1/s),h=this.containerPointToLatLng(o.add(a));return this.setView(h,i,{zoom:n})},_getBoundsCenterZoom:function(e,i){i=i||{},e=e.getBounds?e.getBounds():t.latLngBounds(e);var o=t.point(i.paddingTopLeft||i.padding||[0,0]),s=t.point(i.paddingBottomRight||i.padding||[0,0]),n=this.getBoundsZoom(e,!1,o.add(s));n='number'==typeof i.maxZoom?Math.min(i.maxZoom,n):n;var r=s.subtract(o).divideBy(2),a=this.project(e.getSouthWest(),n),h=this.project(e.getNorthEast(),n),l=this.unproject(a.add(h).divideBy(2).add(r),n);return{center:l,zoom:n}},fitBounds:function(e,i){if(e=t.latLngBounds(e),!e.isValid())throw new Error('Bounds are not valid.');var n=this._getBoundsCenterZoom(e,i);return this.setView(n.center,n.zoom,i)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(e,i){if(e=t.point(e).round(),i=i||{},!e.x&&!e.y)return this.fire('moveend');if(i.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new t.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.noMoveStart||this.fire('movestart'),i.animate!==!1){t.DomUtil.addClass(this._mapPane,'leaflet-pan-anim');var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,i.duration||.25,i.easeLinearity)}
else this._rawPanBy(e),this.fire('move').fire('moveend');return this},flyTo:function(e,i,o){function v(t){var n=t?-1:1,o=t?d:s,r=d*d-s*s+n*l*l*h*h,a=2*o*l*h,e=r/a,i=Math.sqrt(e*e+1)-e,u=i<1e-9?-18:Math.log(i);return u};function y(t){return(Math.exp(t)-Math.exp(-t))/2};function c(t){return(Math.exp(t)+Math.exp(-t))/2};function w(t){return y(t)/c(t)};function b(t){return s*(c(r)/c(r+a*t))};function T(t){return s*(c(r)*w(r+a*t)-y(r))/l};function D(t){return 1-Math.pow(1-t,1.5)};function P(){var n=(Date.now()-L)/x,o=D(n)*p;n<=1?(this._flyToFrame=t.Util.requestAnimFrame(P,this),this._move(this.unproject(m.add(f.subtract(m).multiplyBy(T(o)/h)),u),this.getScaleZoom(s/b(o),u),{flyTo:!0})):this._move(e,i)._moveEnd(!0)};if(o=o||{},o.animate===!1||!t.Browser.any3d)return this.setView(e,i,o);this._stop();var m=this.project(this.getCenter()),f=this.project(e),g=this.getSize(),u=this._zoom;e=t.latLng(e),i=i===n?u:i;var s=Math.max(g.x,g.y),d=s*this.getZoomScale(u,i),h=f.distanceTo(m)||1,a=1.42,l=a*a,r=v(0),L=Date.now(),p=(v(1)-r)/a,x=o.duration?1e3*o.duration:1e3*p*.8;return this._moveStart(!0),P.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)},setMaxBounds:function(e){return e=t.latLngBounds(e),e.isValid()?(this.options.maxBounds&&this.off('moveend',this._panInsideMaxBounds),this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on('moveend',this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off('moveend',this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(e,i){this._enforcingBounds=!0;var n=this.getCenter(),o=this._limitCenter(n,this._zoom,t.latLngBounds(e));return n.equals(o)||this.panTo(o,i),this._enforcingBounds=!1,this},invalidateSize:function(e){if(!this._loaded)return this;e=t.extend({animate:!1,pan:!0},e===!0?{animate:!0}:e);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),s=o.divideBy(2).round(),r=n.divideBy(2).round(),i=s.subtract(r);return i.x||i.y?(e.animate&&e.pan?this.panBy(i):(e.pan&&this._rawPanBy(i),this.fire('move'),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(t.bind(this.fire,this,'moveend'),200)):this.fire('moveend')),this.fire('resize',{oldSize:o,newSize:n})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire('viewreset'),this._stop()},locate:function(e){if(e=this._locateOptions=t.extend({timeout:1e4,watch:!1},e),!('geolocation'in navigator))return this._handleGeolocationError({code:0,message:'Geolocation not supported.'}),this;var i=t.bind(this._handleGeolocationResponse,this),n=t.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(i,n,e):navigator.geolocation.getCurrentPosition(i,n,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?'permission denied':2===e?'position unavailable':'timeout');this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire('locationerror',{code:e,message:'Geolocation error: '+i+'.'})},_handleGeolocationResponse:function(e){var h=e.coords.latitude,l=e.coords.longitude,n=new t.LatLng(h,l),a=n.toBounds(e.coords.accuracy),o=this._locateOptions;if(o.setView){var r=this.getBoundsZoom(a);this.setView(n,o.maxZoom?Math.min(r,o.maxZoom):r)};var s={latlng:n,bounds:a,timestamp:e.timestamp};for(var i in e.coords)'number'==typeof e.coords[i]&&(s[i]=e.coords[i]);this.fire('locationfound',s)},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error('Map container is being reused by another instance');try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=n,this._containerId=n};t.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire('unload');for(var i in this._layers)this._layers[i].remove();return this},createPane:function(e,i){var o='leaflet-pane'+(e?' leaflet-'+e.replace('Pane','')+'-pane':''),n=t.DomUtil.create('div',o,i||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),i=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new t.LatLngBounds(i,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,i,n){e=t.latLngBounds(e),n=t.point(n||[0,0]);var o=this.getZoom()||0,h=this.getMinZoom(),l=this.getMaxZoom(),u=e.getNorthWest(),c=e.getSouthEast(),r=this.getSize().subtract(n),a=t.bounds(this.project(c,o),this.project(u,o)).getSize(),s=t.Browser.any3d?this.options.zoomSnap:1,d=Math.min(r.x/a.x,r.y/a.y);return o=this.getScaleZoom(d,o),s&&(o=Math.round(o/(s/100))*(s/100),o=i?Math.ceil(o/s)*s:Math.floor(o/s)*s),Math.max(h,Math.min(l,o))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new t.Point(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,i){var n=this._getTopLeftPoint(e,i);return new t.Bounds(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===n?this.getZoom():t)},getPane:function(t){return'string'==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var i=this.options.crs;return e=e===n?this._zoom:e,i.scale(t)/i.scale(e)},getScaleZoom:function(t,e){var o=this.options.crs;e=e===n?this._zoom:e;var i=o.zoom(t*o.scale(e));return isNaN(i)?1/0:i},project:function(e,i){return i=i===n?this._zoom:i,this.options.crs.latLngToPoint(t.latLng(e),i)},unproject:function(e,i){return i=i===n?this._zoom:i,this.options.crs.pointToLatLng(t.point(e),i)},layerPointToLatLng:function(e){var i=t.point(e).add(this.getPixelOrigin());return this.unproject(i)},latLngToLayerPoint:function(e){var i=this.project(t.latLng(e))._round();return i._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(t.latLng(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(t.latLngBounds(e))},distance:function(e,i){return this.options.crs.distance(t.latLng(e),t.latLng(i))},containerPointToLayerPoint:function(e){return t.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return t.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var i=this.containerPointToLayerPoint(t.point(e));return this.layerPointToLatLng(i)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(t.latLng(e)))},mouseEventToContainerPoint:function(e){return t.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(e){var i=this._container=t.DomUtil.get(e);if(!i)throw new Error('Map container not found.');if(i._leaflet_id)throw new Error('Map container is already initialized.');t.DomEvent.addListener(i,'scroll',this._onScroll,this),this._containerId=t.Util.stamp(i)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&t.Browser.any3d,t.DomUtil.addClass(i,'leaflet-container'+(t.Browser.touch?' leaflet-touch':'')+(t.Browser.retina?' leaflet-retina':'')+(t.Browser.ielt9?' leaflet-oldie':'')+(t.Browser.safari?' leaflet-safari':'')+(this._fadeAnimated?' leaflet-fade-anim':''));var e=t.DomUtil.getStyle(i,'position');'absolute'!==e&&'relative'!==e&&'fixed'!==e&&(i.style.position='relative'),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane('mapPane',this._container),t.DomUtil.setPosition(this._mapPane,new t.Point(0,0)),this.createPane('tilePane'),this.createPane('shadowPane'),this.createPane('overlayPane'),this.createPane('markerPane'),this.createPane('tooltipPane'),this.createPane('popupPane'),this.options.markerZoomAnimation||(t.DomUtil.addClass(e.markerPane,'leaflet-zoom-hide'),t.DomUtil.addClass(e.shadowPane,'leaflet-zoom-hide'))},_resetView:function(e,i){t.DomUtil.setPosition(this._mapPane,new t.Point(0,0));var o=!this._loaded;this._loaded=!0,i=this._limitZoom(i),this.fire('viewprereset');var n=this._zoom!==i;this._moveStart(n)._move(e,i)._moveEnd(n),this.fire('viewreset'),o&&this.fire('load')},_moveStart:function(t){return t&&this.fire('zoomstart'),this.fire('movestart')},_move:function(t,e,i){e===n&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||i&&i.pinch)&&this.fire('zoom',i),this.fire('move',i)},_moveEnd:function(t){return t&&this.fire('zoomend'),this.fire('moveend')},_stop:function(){return t.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){t.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error('Set map center and zoom first.')},_initEvents:function(i){if(t.DomEvent){this._targets={},this._targets[t.stamp(this._container)]=this;var n=i?'off':'on';t.DomEvent[n](this._container,'click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress',this._handleDOMEvent,this),this.options.trackResize&&t.DomEvent[n](e,'resize',this._onResize,this),t.Browser.any3d&&this.options.transform3DLimit&&this[n]('moveend',this._onMoveEnd)}},_onResize:function(){t.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=t.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,i){for(var o,s=[],r='mouseout'===i||'mouseover'===i,n=e.target||e.srcElement,a=!1;n;){if(o=this._targets[t.stamp(n)],o&&('click'===i||'preclick'===i)&&!e._simulated&&this._draggableMoved(o)){a=!0;break};if(o&&o.listens(i,!0)){if(r&&!t.DomEvent._isExternalTarget(n,e))break;if(s.push(o),r)break};if(n===this._container)break;n=n.parentNode};return s.length||a||r||!t.DomEvent._isExternalTarget(n,e)||(s=[this]),s},_handleDOMEvent:function(e){if(this._loaded&&!t.DomEvent._skipped(e)){var i='keypress'===e.type&&13===e.keyCode?'click':e.type;'mousedown'===i&&t.DomUtil.preventOutline(e.target||e.srcElement),this._fireDOMEvent(e,i)}},_fireDOMEvent:function(e,i,n){if('click'===e.type){var a=t.Util.extend({},e);a.type='preclick',this._fireDOMEvent(a,a.type,n)};if(!e._stopped&&(n=(n||[]).concat(this._findEventTargets(e,i)),n.length)){var r=n[0];'contextmenu'===i&&r.listens(i,!0)&&t.DomEvent.preventDefault(e);var o={originalEvent:e};if('keypress'!==e.type){var h=r instanceof t.Marker;o.containerPoint=h?this.latLngToContainerPoint(r.getLatLng()):this.mouseEventToContainerPoint(e),o.layerPoint=this.containerPointToLayerPoint(o.containerPoint),o.latlng=h?r.getLatLng():this.layerPointToLatLng(o.layerPoint)};for(var s=0;s<n.length;s++)if(n[s].fire(i,o,!0),o.originalEvent._stopped||n[s].options.nonBubblingEvents&&t.Util.indexOf(n[s].options.nonBubblingEvents,i)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on('load',t,e),this},_getMapPanePos:function(){return t.DomUtil.getPosition(this._mapPane)||new t.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var i=t&&e!==n?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return i.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_latLngBoundsToNewLayerBounds:function(e,i,n){var o=this._getNewPixelOrigin(n,i);return t.bounds([this.project(e.getSouthWest(),i)._subtract(o),this.project(e.getNorthWest(),i)._subtract(o),this.project(e.getSouthEast(),i)._subtract(o),this.project(e.getNorthEast(),i)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,i,n){if(!n)return e;var o=this.project(e,i),s=this.getSize().divideBy(2),a=new t.Bounds(o.subtract(s),o.add(s)),r=this._getBoundsOffset(a,n,i);return r.round().equals([0,0])?e:this.unproject(o.add(r),i)},_limitOffset:function(e,i){if(!i)return e;var n=this.getPixelBounds(),o=new t.Bounds(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(o,i))},_getBoundsOffset:function(e,i,n){var o=t.bounds(this.project(i.getNorthEast(),n),this.project(i.getSouthWest(),n)),s=o.min.subtract(e.min),r=o.max.subtract(e.max),a=this._rebound(s.x,-r.x),h=this._rebound(s.y,-r.y);return new t.Point(a,h)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(e){var n=this.getMinZoom(),o=this.getMaxZoom(),i=t.Browser.any3d?this.options.zoomSnap:1;return i&&(e=Math.round(e/i)*i),Math.max(n,Math.min(o,e))},_onPanTransitionStep:function(){this.fire('move')},_onPanTransitionEnd:function(){t.DomUtil.removeClass(this._mapPane,'leaflet-pan-anim'),this.fire('moveend')},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!((e&&e.animate)!==!0&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)},_createAnimProxy:function(){var e=this._proxy=t.DomUtil.create('div','leaflet-proxy leaflet-zoom-animated');this._panes.mapPane.appendChild(e),this.on('zoomanim',function(i){var n=t.DomUtil.TRANSFORM,o=e.style[n];t.DomUtil.setTransform(e,this.project(i.center,i.zoom),this.getZoomScale(i.zoom,1)),o===e.style[n]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on('load moveend',function(){var n=this.getCenter(),i=this.getZoom();t.DomUtil.setTransform(e,this.project(n,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf('transform')>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName('leaflet-zoom-animated').length},_tryAnimatedZoom:function(e,i,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(i-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(i),s=this._getCenterOffset(e)._divideBy(1-1/o);return!(n.animate!==!0&&!this.getSize().contains(s))&&(t.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(e,i,!0)},this),!0)},_animateZoom:function(e,i,n,o){n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=i,t.DomUtil.addClass(this._mapPane,'leaflet-zoom-anim')),this.fire('zoomanim',{center:e,zoom:i,noUpdate:o}),setTimeout(t.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(t.DomUtil.removeClass(this._mapPane,'leaflet-zoom-anim'),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),t.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}),t.map=function(e,i){return new t.Map(e,i)},t.Layer=t.Evented.extend({options:{pane:'overlayPane',nonBubblingEvents:[],attribution:null},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[t.stamp(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[t.stamp(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once('remove',function(){e.off(i,this)},this)};this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire('add'),e.fire('layeradd',{layer:this})}}}),t.Map.include({addLayer:function(e){var i=t.stamp(e);return this._layers[i]?this:(this._layers[i]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var i=t.stamp(e);return this._layers[i]?(this._loaded&&e.onRemove(this),e.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(e.getAttribution()),delete this._layers[i],this._loaded&&(this.fire('layerremove',{layer:e}),e.fire('remove')),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return!!e&&t.stamp(e)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(e){e=e?t.Util.isArray(e)?e:[e]:[];for(var i=0,n=e.length;i<n;i++)this.addLayer(e[i])},_addZoomLimit:function(e){!isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[t.stamp(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var i=t.stamp(e);this._zoomBoundLayers[i]&&(delete this._zoomBoundLayers[i],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),s=this._getZoomSpan();for(var o in this._zoomBoundLayers){var i=this._zoomBoundLayers[o].options;t=i.minZoom===n?t:Math.min(t,i.minZoom),e=i.maxZoom===n?e:Math.max(e,i.maxZoom)};this._layersMaxZoom=e===-(1/0)?n:e,this._layersMinZoom=t===1/0?n:t,s!==this._getZoomSpan()&&this.fire('zoomlevelschange'),this.options.maxZoom===n&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===n&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var s='_leaflet_events';t.DomEvent={on:function(e,i,n,o){if('object'==typeof i)for(var r in i)this._on(e,r,i[r],n);else{i=t.Util.splitWords(i);for(var s=0,a=i.length;s<a;s++)this._on(e,i[s],n,o)};return this},off:function(e,i,n,o){if('object'==typeof i)for(var r in i)this._off(e,r,i[r],n);else{i=t.Util.splitWords(i);for(var s=0,a=i.length;s<a;s++)this._off(e,i[s],n,o)};return this},_on:function(i,n,o,r){var h=n+t.stamp(o)+(r?'_'+t.stamp(r):'');if(i[s]&&i[s][h])return this;var a=function(t){return o.call(r||i,t||e.event)},l=a;return t.Browser.pointer&&0===n.indexOf('touch')?this.addPointerListener(i,n,a,h):!t.Browser.touch||'dblclick'!==n||!this.addDoubleTapListener||t.Browser.pointer&&t.Browser.chrome?'addEventListener'in i?'mousewheel'===n?i.addEventListener('onwheel'in i?'wheel':'mousewheel',a,!1):'mouseenter'===n||'mouseleave'===n?(a=function(n){n=n||e.event,t.DomEvent._isExternalTarget(i,n)&&l(n)},i.addEventListener('mouseenter'===n?'mouseover':'mouseout',a,!1)):('click'===n&&t.Browser.android&&(a=function(e){return t.DomEvent._filterClick(e,l)}),i.addEventListener(n,a,!1)):'attachEvent'in i&&i.attachEvent('on'+n,a):this.addDoubleTapListener(i,a,h),i[s]=i[s]||{},i[s][h]=a,this},_off:function(e,i,n,o){var r=i+t.stamp(n)+(o?'_'+t.stamp(o):''),a=e[s]&&e[s][r];return a?(t.Browser.pointer&&0===i.indexOf('touch')?this.removePointerListener(e,i,r):t.Browser.touch&&'dblclick'===i&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,r):'removeEventListener'in e?'mousewheel'===i?e.removeEventListener('onwheel'in e?'wheel':'mousewheel',a,!1):e.removeEventListener('mouseenter'===i?'mouseover':'mouseleave'===i?'mouseout':i,a,!1):'detachEvent'in e&&e.detachEvent('on'+i,a),e[s][r]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,t.DomEvent._skipped(e),this},disableScrollPropagation:function(e){return t.DomEvent.on(e,'mousewheel',t.DomEvent.stopPropagation)},disableClickPropagation:function(e){var i=t.DomEvent.stopPropagation;return t.DomEvent.on(e,t.Draggable.START.join(' '),i),t.DomEvent.on(e,{click:t.DomEvent._fakeStop,dblclick:i})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(e){return t.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,i){if(!i)return new t.Point(e.clientX,e.clientY);var n=i.getBoundingClientRect();return new t.Point(e.clientX-n.left-i.clientLeft,e.clientY-n.top-i.clientTop)},_wheelPxFactor:t.Browser.win&&t.Browser.chrome?2:t.Browser.gecko?e.devicePixelRatio:1,getWheelDelta:function(e){return t.Browser.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/t.DomEvent._wheelPxFactor:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(e){t.DomEvent._skipEvents[e.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1};return i!==t},_filterClick:function(e,i){var o=e.timeStamp||e.originalEvent&&e.originalEvent.timeStamp,n=t.DomEvent._lastClick&&o-t.DomEvent._lastClick;return n&&n>100&&n<500||e.target._simulatedClick&&!e._simulated?void t.DomEvent.stop(e):(t.DomEvent._lastClick=o,void i(e))}},t.DomEvent.addListener=t.DomEvent.on,t.DomEvent.removeListener=t.DomEvent.off,t.PosAnimation=t.Evented.extend({run:function(e,i,n,o){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=t.DomUtil.getPosition(e),this._offset=i.subtract(this._startPos),this._startTime=+new Date,this.fire('start'),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=t.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(e,i){var n=this._startPos.add(this._offset.multiplyBy(e));i&&n._round(),t.DomUtil.setPosition(this._el,n),this.fire('step')},_complete:function(){t.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire('end')},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),t.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:t.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var o=Math.PI/180,n=this.R,i=e.lat*o,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),a=r*Math.sin(i),h=Math.tan(Math.PI/4-i/2)/Math.pow((1-a)/(1+a),r/2);return i=-n*Math.log(Math.max(h,1e-10)),new t.Point(e.lng*o*n,i)},unproject:function(e){for(var i,r=180/Math.PI,o=this.R,a=this.R_MINOR/o,h=Math.sqrt(1-a*a),l=Math.exp(-e.y/o),n=Math.PI/2-2*Math.atan(l),u=0,s=.1;u<15&&Math.abs(s)>1e-7;u++)i=h*Math.sin(n),i=Math.pow((1-i)/(1+i),h/2),s=Math.PI/2-2*Math.atan(l*i)-n,n+=s;return new t.LatLng(n*r,e.x*r/o)}},t.CRS.EPSG3395=t.extend({},t.CRS.Earth,{code:'EPSG:3395',projection:t.Projection.Mercator,transformation:function(){var e=.5/(Math.PI*t.Projection.Mercator.R);return new t.Transformation(e,.5,-e,.5)}()}),t.GridLayer=t.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:t.Browser.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:n,noWrap:!1,pane:'tilePane',className:'',keepBuffer:2},initialize:function(e){t.setOptions(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),t.DomUtil.remove(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(t.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(t.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=t.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return i.createElement('div')},getTileSize:function(){var e=this.options.tileSize;return e instanceof t.Point?e:new t.Point(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==n&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var n,o=this.getPane().children,e=-t(-(1/0),1/0),i=0,s=o.length;i<s;i++)n=o[i].style.zIndex,o[i]!==this._container&&n&&(e=t(e,+n));isFinite(e)&&(this.options.zIndex=e+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!t.Browser.ielt9){t.DomUtil.setOpacity(this._container,this.options.opacity);var r=+new Date,n=!1,o=!1;for(var s in this._tiles){var e=this._tiles[s];if(e.current&&e.loaded){var i=Math.min(1,(r-e.loaded)/200);t.DomUtil.setOpacity(e.el,i),i<1?n=!0:(e.active&&(o=!0),e.active=!0)}};o&&!this._noPrune&&this._pruneTiles(),n&&(t.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=t.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=t.DomUtil.create('div','leaflet-layer '+(this.options.className||'')),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,r=this.options.maxZoom;if(o===n)return n;for(var i in this._levels)this._levels[i].el.children.length||i===o?this._levels[i].el.style.zIndex=r-Math.abs(o-i):(t.DomUtil.remove(this._levels[i].el),this._removeTilesAtZoom(i),delete this._levels[i]);var e=this._levels[o],s=this._map;return e||(e=this._levels[o]={},e.el=t.DomUtil.create('div','leaflet-tile-container leaflet-zoom-animated',this._container),e.el.style.zIndex=r,e.origin=s.project(s.unproject(s.getPixelOrigin()),o).round(),e.zoom=o,this._setZoomTransform(e,s.getCenter(),s.getZoom()),t.Util.falseFn(e.el.offsetWidth)),this._level=e,e},_pruneTiles:function(){if(this._map){var e,i,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)return void this._removeAllTiles();for(e in this._tiles)i=this._tiles[e],i.retain=i.current;for(e in this._tiles)if(i=this._tiles[e],i.current&&!i.active){var t=i.coords;this._retainParent(t.x,t.y,t.z,t.z-5)||this._retainChildren(t.x,t.y,t.z,t.z+2)};for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var e in this._levels)t.DomUtil.remove(this._levels[e].el),delete this._levels[e];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(e,i,n,o){var a=Math.floor(e/2),h=Math.floor(i/2),r=n-1,l=new t.Point(+a,+h);l.z=+r;var u=this._tileCoordsToKey(l),s=this._tiles[u];return s&&s.active?(s.retain=!0,!0):(s&&s.loaded&&(s.retain=!0),r>o&&this._retainParent(a,h,r,o))},_retainChildren:function(e,i,n,o){for(var a=2*e;a<2*e+2;a++)for(var r=2*i;r<2*i+2;r++){var h=new t.Point(a,r);h.z=n+1;var l=this._tileCoordsToKey(h),s=this._tiles[l];s&&s.active?s.retain=!0:(s&&s.loaded&&(s.retain=!0),n+1<o&&this._retainChildren(a,r,n+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,i,o){var s=Math.round(e);(this.options.maxZoom!==n&&s>this.options.maxZoom||this.options.minZoom!==n&&s<this.options.minZoom)&&(s=n);var r=this.options.updateWhenZooming&&s!==this._tileZoom;o&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),s!==n&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(e,i,n){var o=this._map.getZoomScale(n,e.zoom),s=e.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(i,n)).round();t.Browser.any3d?t.DomUtil.setTransform(e.el,s,o):t.DomUtil.setPosition(e.el,s)},_resetGrid:function(){var e=this._map,t=e.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],n).x/i.x),Math.ceil(e.project([0,t.wrapLng[1]],n).x/i.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],n).y/i.x),Math.ceil(e.project([t.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var i=this._map,s=i._animatingZoom?Math.max(i._animateToZoom,i.getZoom()):i.getZoom(),r=i.getZoomScale(s,this._tileZoom),n=i.project(e,this._tileZoom).floor(),o=i.getSize().divideBy(2*r);return new t.Bounds(n.subtract(o),n.add(o))},_update:function(e){var c=this._map;if(c){var g=c.getZoom();if(e===n&&(e=c.getCenter()),this._tileZoom!==n){var v=this._getTiledPixelBounds(e),s=this._pxBoundsToTileRange(v),f=s.getCenter(),r=[],h=this.options.keepBuffer,y=new t.Bounds(s.getBottomLeft().subtract([h,-h]),s.getTopRight().add([h,-h]));for(var p in this._tiles){var u=this._tiles[p].coords;u.z===this._tileZoom&&y.contains(t.point(u.x,u.y))||(this._tiles[p].current=!1)};if(Math.abs(g-this._tileZoom)>1)return void this._setView(e,g);for(var l=s.min.y;l<=s.max.y;l++)for(var o=s.min.x;o<=s.max.x;o++){var a=new t.Point(o,l);if(a.z=this._tileZoom,this._isValidTile(a)){var m=this._tiles[this._tileCoordsToKey(a)];m?m.current=!0:r.push(a)}};if(r.sort(function(t,e){return t.distanceTo(f)-e.distanceTo(f)}),0!==r.length){this._loading||(this._loading=!0,this.fire('loading'));var d=i.createDocumentFragment();for(o=0;o<r.length;o++)this._addTile(r[o],d);this._level.el.appendChild(d)}}}},_isValidTile:function(e){var n=this._map.options.crs;if(!n.infinite){var i=this._globalTileRange;if(!n.wrapLng&&(e.x<i.min.x||e.x>i.max.x)||!n.wrapLat&&(e.y<i.min.y||e.y>i.max.y))return!1};if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(e);return t.latLngBounds(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(e){var i=this._map,n=this.getTileSize(),o=e.scaleBy(n),r=o.add(n),a=i.unproject(o,e.z),h=i.unproject(r,e.z),s=new t.LatLngBounds(a,h);return this.options.noWrap||i.wrapLatLngBounds(s),s},_tileCoordsToKey:function(t){return t.x+':'+t.y+':'+t.z},_keyToTileCoords:function(e){var i=e.split(':'),n=new t.Point(+i[0],+i[1]);return n.z=+i[2],n},_removeTile:function(e){var i=this._tiles[e];i&&(t.DomUtil.remove(i.el),delete this._tiles[e],this.fire('tileunload',{tile:i.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){t.DomUtil.addClass(e,'leaflet-tile');var i=this.getTileSize();e.style.width=i.x+'px',e.style.height=i.y+'px',e.onselectstart=t.Util.falseFn,e.onmousemove=t.Util.falseFn,t.Browser.ielt9&&this.options.opacity<1&&t.DomUtil.setOpacity(e,this.options.opacity),t.Browser.android&&!t.Browser.android23&&(e.style.WebkitBackfaceVisibility='hidden')},_addTile:function(e,i){var o=this._getTilePos(e),s=this._tileCoordsToKey(e),n=this.createTile(this._wrapCoords(e),t.bind(this._tileReady,this,e));this._initTile(n),this.createTile.length<2&&t.Util.requestAnimFrame(t.bind(this._tileReady,this,e,null,n)),t.DomUtil.setPosition(n,o),this._tiles[s]={el:n,coords:e,current:!0},i.appendChild(n),this.fire('tileloadstart',{tile:n,coords:e})},_tileReady:function(e,i,n){if(this._map){i&&this.fire('tileerror',{error:i,tile:n,coords:e});var o=this._tileCoordsToKey(e);n=this._tiles[o],n&&(n.loaded=+new Date,this._map._fadeAnimated?(t.DomUtil.setOpacity(n.el,0),t.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=t.Util.requestAnimFrame(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),i||(t.DomUtil.addClass(n.el,'leaflet-tile-loaded'),this.fire('tileload',{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire('load'),t.Browser.ielt9||!this._map._fadeAnimated?t.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(t.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var i=new t.Point(this._wrapX?t.Util.wrapNum(e.x,this._wrapX):e.x,this._wrapY?t.Util.wrapNum(e.y,this._wrapY):e.y);return i.z=e.z,i},_pxBoundsToTileRange:function(e){var i=this.getTileSize();return new t.Bounds(e.min.unscaleBy(i).floor(),e.max.unscaleBy(i).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),t.gridLayer=function(e){return new t.GridLayer(e)},t.TileLayer=t.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,minNativeZoom:null,subdomains:'abc',errorTileUrl:'',zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(e,i){this._url=e,i=t.setOptions(this,i),i.detectRetina&&t.Browser.retina&&i.maxZoom>0&&(i.tileSize=Math.floor(i.tileSize/2),i.zoomReverse?(i.zoomOffset--,i.minZoom++):(i.zoomOffset++,i.maxZoom--),i.minZoom=Math.max(0,i.minZoom)),'string'==typeof i.subdomains&&(i.subdomains=i.subdomains.split('')),t.Browser.android||this.on('tileunload',this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(e,n){var o=i.createElement('img');return t.DomEvent.on(o,'load',t.bind(this._tileOnLoad,this,n,o)),t.DomEvent.on(o,'error',t.bind(this._tileOnError,this,n,o)),this.options.crossOrigin&&(o.crossOrigin=''),o.alt='',o.setAttribute('role','presentation'),o.src=this.getTileUrl(e),o},getTileUrl:function(e){var i={r:t.Browser.retina?'@2x':'',s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-e.y;this.options.tms&&(i.y=n),i['-y']=n};return t.Util.template(this._url,t.extend(i,this.options))},_tileOnLoad:function(e,i){t.Browser.ielt9?setTimeout(t.bind(e,this,null,i),0):e(null,i)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&e.src!==n&&(e.src=n),t(i,e)},getTileSize:function(){var s=this._map,i=t.GridLayer.prototype.getTileSize.call(this),e=this._tileZoom+this.options.zoomOffset,n=this.options.minNativeZoom,o=this.options.maxNativeZoom;return null!==n&&e<n?i.divideBy(s.getZoomScale(n,e)).round():null!==o&&e>o?i.divideBy(s.getZoomScale(o,e)).round():i},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,n=this.options.maxZoom,o=this.options.zoomReverse,s=this.options.zoomOffset,e=this.options.minNativeZoom,i=this.options.maxNativeZoom;return o&&(t=n-t),t+=s,null!==e&&t<e?e:null!==i&&t>i?i:t},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var i,e;for(i in this._tiles)this._tiles[i].coords.z!==this._tileZoom&&(e=this._tiles[i].el,e.onload=t.Util.falseFn,e.onerror=t.Util.falseFn,e.complete||(e.src=t.Util.emptyImageUrl,t.DomUtil.remove(e)))}}),t.tileLayer=function(e,i){return new t.TileLayer(e,i)},t.TileLayer.WMS=t.TileLayer.extend({defaultWmsParams:{service:'WMS',request:'GetMap',layers:'',styles:'',format:'image/jpeg',transparent:!1,version:'1.1.1'},options:{crs:null,uppercase:!1},initialize:function(e,i){this._url=e;var n=t.extend({},this.defaultWmsParams);for(var o in i)o in this.options||(n[o]=i[o]);i=t.setOptions(this,i),n.width=n.height=i.tileSize*(i.detectRetina&&t.Browser.retina?2:1),this.wmsParams=n},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var i=this._wmsVersion>=1.3?'crs':'srs';this.wmsParams[i]=this._crs.code,t.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var o=this._tileCoordsToBounds(e),i=this._crs.project(o.getNorthWest()),n=this._crs.project(o.getSouthEast()),r=(this._wmsVersion>=1.3&&this._crs===t.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(','),s=t.TileLayer.prototype.getTileUrl.call(this,e);return s+t.Util.getParamString(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?'&BBOX=':'&bbox=')+r},setParams:function(e,i){return t.extend(this.wmsParams,e),i||this.redraw(),this}}),t.tileLayer.wms=function(e,i){return new t.TileLayer.WMS(e,i)},t.ImageOverlay=t.Layer.extend({options:{opacity:1,alt:'',interactive:!1,crossOrigin:!1},initialize:function(e,i,n){this._url=e,this._bounds=t.latLngBounds(i),t.setOptions(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(t.DomUtil.addClass(this._image,'leaflet-interactive'),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){t.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&t.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&t.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._image=t.DomUtil.create('img','leaflet-image-layer '+(this._zoomAnimated?'leaflet-zoom-animated':''));e.onselectstart=t.Util.falseFn,e.onmousemove=t.Util.falseFn,e.onload=t.bind(this.fire,this,'load'),this.options.crossOrigin&&(e.crossOrigin=''),e.src=this._url,e.alt=this.options.alt},_animateZoom:function(e){var i=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;t.DomUtil.setTransform(this._image,n,i)},_reset:function(){var e=this._image,i=new t.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=i.getSize();t.DomUtil.setPosition(e,i.min),e.style.width=n.x+'px',e.style.height=n.y+'px'},_updateOpacity:function(){t.DomUtil.setOpacity(this._image,this.options.opacity)}}),t.imageOverlay=function(e,i,n){return new t.ImageOverlay(e,i,n)},t.Icon=t.Class.extend({initialize:function(e){t.setOptions(this,e)},createIcon:function(t){return this._createIcon('icon',t)},createShadow:function(t){return this._createIcon('shadow',t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if('icon'===t)throw new Error('iconUrl not set in Icon options (see the docs).');return null};var i=this._createImg(n,e&&'IMG'===e.tagName?e:null);return this._setIconStyles(i,t),i},_setIconStyles:function(e,i){var s=this.options,o=s[i+'Size'];'number'==typeof o&&(o=[o,o]);var n=t.point(o),r=t.point('shadow'===i&&s.shadowAnchor||s.iconAnchor||n&&n.divideBy(2,!0));e.className='leaflet-marker-'+i+' '+(s.className||''),r&&(e.style.marginLeft=-r.x+'px',e.style.marginTop=-r.y+'px'),n&&(e.style.width=n.x+'px',e.style.height=n.y+'px')},_createImg:function(t,e){return e=e||i.createElement('img'),e.src=t,e},_getIconUrl:function(e){return t.Browser.retina&&this.options[e+'RetinaUrl']||this.options[e+'Url']}}),t.icon=function(e){return new t.Icon(e)},t.Icon.Default=t.Icon.extend({options:{iconUrl:'marker-icon.png',iconRetinaUrl:'marker-icon-2x.png',shadowUrl:'marker-shadow.png',iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return t.Icon.Default.imagePath||(t.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||t.Icon.Default.imagePath)+t.Icon.prototype._getIconUrl.call(this,e)},_detectIconPath:function(){var e=t.DomUtil.create('div','leaflet-default-icon-path',i.body),n=t.DomUtil.getStyle(e,'background-image')||t.DomUtil.getStyle(e,'backgroundImage');return i.body.removeChild(e),0===n.indexOf('url')?n.replace(/^url\(["']?/,'').replace(/marker-icon\.png["']?\)$/,''):''}}),t.Marker=t.Layer.extend({options:{icon:new t.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:'',alt:'',zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:'markerPane',nonBubblingEvents:['click','dblclick','mouseover','mouseout','contextmenu']},initialize:function(e,i){t.setOptions(this,i),this._latlng=t.latLng(e)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on('zoomanim',this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off('zoomanim',this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var i=this._latlng;return this._latlng=t.latLng(e),this.update(),this.fire('move',{oldLatLng:i,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)};return this},_initIcon:function(){var e=this.options,s='leaflet-zoom-'+(this._zoomAnimated?'animated':'hide'),n=e.icon.createIcon(this._icon),r=!1;n!==this._icon&&(this._icon&&this._removeIcon(),r=!0,e.title&&(n.title=e.title),e.alt&&(n.alt=e.alt)),t.DomUtil.addClass(n,s),e.keyboard&&(n.tabIndex='0'),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var i=e.icon.createShadow(this._shadow),o=!1;i!==this._shadow&&(this._removeShadow(),o=!0),i&&(t.DomUtil.addClass(i,s),i.alt=''),this._shadow=i,e.opacity<1&&this._updateOpacity(),r&&this.getPane().appendChild(this._icon),this._initInteraction(),i&&o&&this.getPane('shadowPane').appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),t.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&t.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(e){t.DomUtil.setPosition(this._icon,e),this._shadow&&t.DomUtil.setPosition(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(t.DomUtil.addClass(this._icon,'leaflet-interactive'),this.addInteractiveTarget(this._icon),t.Handler.MarkerDrag)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new t.Handler.MarkerDrag(this),e&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;t.DomUtil.setOpacity(this._icon,e),this._shadow&&t.DomUtil.setOpacity(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),t.marker=function(e,i){return new t.Marker(e,i)},t.DivIcon=t.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:'leaflet-div-icon'},createIcon:function(e){var n=e&&'DIV'===e.tagName?e:i.createElement('div'),o=this.options;if(n.innerHTML=o.html!==!1?o.html:'',o.bgPos){var s=t.point(o.bgPos);n.style.backgroundPosition=-s.x+'px '+-s.y+'px'};return this._setIconStyles(n,'icon'),n},createShadow:function(){return null}}),t.divIcon=function(e){return new t.DivIcon(e)},t.DivOverlay=t.Layer.extend({options:{offset:[0,7],className:'',pane:'popupPane'},initialize:function(e,i){t.setOptions(this,e),this._source=i},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&t.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&t.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(e){e._fadeAnimated?(t.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(t.bind(t.DomUtil.remove,t.DomUtil,this._container),200)):t.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=t.latLng(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility='hidden',this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility='',this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&t.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&t.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e='function'==typeof this._content?this._content(this._source||this):this._content;if('string'==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)};this.fire('contentupdate')}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),e=t.point(this.options.offset),n=this._getAnchor();this._zoomAnimated?t.DomUtil.setPosition(this._container,i.add(n)):e=e.add(i).add(n);var o=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+'px',this._container.style.left=s+'px'}},_getAnchor:function(){return[0,0]}}),t.Popup=t.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:''},openOn:function(t){return t.openPopup(this),this},onAdd:function(e){t.DivOverlay.prototype.onAdd.call(this,e),e.fire('popupopen',{popup:this}),this._source&&(this._source.fire('popupopen',{popup:this},!0),this._source instanceof t.Path||this._source.on('preclick',t.DomEvent.stopPropagation))},onRemove:function(e){t.DivOverlay.prototype.onRemove.call(this,e),e.fire('popupclose',{popup:this}),this._source&&(this._source.fire('popupclose',{popup:this},!0),this._source instanceof t.Path||this._source.off('preclick',t.DomEvent.stopPropagation))},getEvents:function(){var e=t.DivOverlay.prototype.getEvents.call(this);return('closeOnClick'in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this._close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e='leaflet-popup',o=this._container=t.DomUtil.create('div',e+' '+(this.options.className||'')+' leaflet-zoom-animated');if(this.options.closeButton){var n=this._closeButton=t.DomUtil.create('a',e+'-close-button',o);n.href='#close',n.innerHTML='&#215;',t.DomEvent.on(n,'click',this._onCloseButtonClick,this)};var i=this._wrapper=t.DomUtil.create('div',e+'-content-wrapper',o);this._contentNode=t.DomUtil.create('div',e+'-content',i),t.DomEvent.disableClickPropagation(i).disableScrollPropagation(this._contentNode).on(i,'contextmenu',t.DomEvent.stopPropagation),this._tipContainer=t.DomUtil.create('div',e+'-tip-container',o),this._tip=t.DomUtil.create('div',e+'-tip',this._tipContainer)},_updateLayout:function(){var n=this._contentNode,e=n.style;e.width='',e.whiteSpace='nowrap';var i=n.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+'px',e.whiteSpace='',e.height='';var r=n.offsetHeight,o=this.options.maxHeight,s='leaflet-popup-scrolled';o&&r>o?(e.height=o+'px',t.DomUtil.addClass(n,s)):t.DomUtil.removeClass(n,s),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var i=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();t.DomUtil.setPosition(this._container,i.add(n))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var a=this._map,d=parseInt(t.DomUtil.getStyle(this._container,'marginBottom'),10)||0,h=this._container.offsetHeight+d,u=this._containerWidth,c=new t.Point(this._containerLeft,-h-this._containerBottom);c._add(t.DomUtil.getPosition(this._container));var e=a.layerPointToContainerPoint(c),l=t.point(this.options.autoPanPadding),o=t.point(this.options.autoPanPaddingTopLeft||l),s=t.point(this.options.autoPanPaddingBottomRight||l),r=a.getSize(),i=0,n=0;e.x+u+s.x>r.x&&(i=e.x+u-r.x+s.x),e.x-i-o.x<0&&(i=e.x-o.x),e.y+h+s.y>r.y&&(n=e.y+h-r.y+s.y),e.y-n-o.y<0&&(n=e.y-o.y),(i||n)&&a.fire('autopanstart').panBy([i,n])}},_onCloseButtonClick:function(e){this._close(),t.DomEvent.stop(e)},_getAnchor:function(){return t.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),t.popup=function(e,i){return new t.Popup(e,i)},t.Map.mergeOptions({closePopupOnClick:!0}),t.Map.include({openPopup:function(e,i,n){return e instanceof t.Popup||(e=new t.Popup(n).setContent(e)),i&&e.setLatLng(i),this.hasLayer(e)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=e,this.addLayer(e))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),t.Layer.include({bindPopup:function(e,i){return e instanceof t.Popup?(t.setOptions(e,i),this._popup=e,e._source=this):(this._popup&&!i||(this._popup=new t.Popup(i,this)),this._popup.setContent(e)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e,i){if(e instanceof t.Layer||(i=e,e=this),e instanceof t.FeatureGroup)for(var n in this._layers){e=this._layers[n];break};return i||(i=e.getCenter?e.getCenter():e.getLatLng()),this._popup&&this._map&&(this._popup._source=e,this._popup.update(),this._map.openPopup(this._popup,i)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(e){var i=e.layer||e.target;if(this._popup&&this._map)return t.DomEvent.stop(e),i instanceof t.Path?void this.openPopup(e.layer||e.target,e.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===i?this.closePopup():this.openPopup(i,e.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),t.Tooltip=t.DivOverlay.extend({options:{pane:'tooltipPane',offset:[0,0],direction:'auto',permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(e){t.DivOverlay.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire('tooltipopen',{tooltip:this}),this._source&&this._source.fire('tooltipopen',{tooltip:this},!0)},onRemove:function(e){t.DivOverlay.prototype.onRemove.call(this,e),e.fire('tooltipclose',{tooltip:this}),this._source&&this._source.fire('tooltipclose',{tooltip:this},!0)},getEvents:function(){var e=t.DivOverlay.prototype.getEvents.call(this);return t.Browser.touch&&!this.options.permanent&&(e.preclick=this._close),e},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var e='leaflet-tooltip',i=e+' '+(this.options.className||'')+' leaflet-zoom-'+(this._zoomAnimated?'animated':'hide');this._contentNode=this._container=t.DomUtil.create('div',i)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var h=this._map,n=this._container,l=h.latLngToContainerPoint(h.getCenter()),u=h.layerPointToContainerPoint(e),o=this.options.direction,r=n.offsetWidth,a=n.offsetHeight,i=t.point(this.options.offset),s=this._getAnchor();'top'===o?e=e.add(t.point(-r/2+i.x,-a+i.y+s.y,!0)):'bottom'===o?e=e.subtract(t.point(r/2-i.x,-i.y,!0)):'center'===o?e=e.subtract(t.point(r/2+i.x,a/2-s.y+i.y,!0)):'right'===o||'auto'===o&&u.x<l.x?(o='right',e=e.add(t.point(i.x+s.x,s.y-a/2+i.y,!0))):(o='left',e=e.subtract(t.point(r+s.x-i.x,a/2-s.y-i.y,!0))),t.DomUtil.removeClass(n,'leaflet-tooltip-right'),t.DomUtil.removeClass(n,'leaflet-tooltip-left'),t.DomUtil.removeClass(n,'leaflet-tooltip-top'),t.DomUtil.removeClass(n,'leaflet-tooltip-bottom'),t.DomUtil.addClass(n,'leaflet-tooltip-'+o),t.DomUtil.setPosition(n,e)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(e){this.options.opacity=e,this._container&&t.DomUtil.setOpacity(this._container,e)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return t.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),t.tooltip=function(e,i){return new t.Tooltip(e,i)},t.Map.include({openTooltip:function(e,i,n){return e instanceof t.Tooltip||(e=new t.Tooltip(n).setContent(e)),i&&e.setLatLng(i),this.hasLayer(e)?this:this.addLayer(e)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),t.Layer.include({bindTooltip:function(e,i){return e instanceof t.Tooltip?(t.setOptions(e,i),this._tooltip=e,e._source=this):(this._tooltip&&!i||(this._tooltip=t.tooltip(i,this)),this._tooltip.setContent(e)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var n=e?'off':'on',i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),t.Browser.touch&&(i.click=this._openTooltip)),this[n](i),this._tooltipHandlersAdded=!e}},openTooltip:function(e,i){if(e instanceof t.Layer||(i=e,e=this),e instanceof t.FeatureGroup)for(var n in this._layers){e=this._layers[n];break};return i||(i=e.getCenter?e.getCenter():e.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=e,this._tooltip.update(),this._map.openTooltip(this._tooltip,i),this._tooltip.options.interactive&&this._tooltip._container&&(t.DomUtil.addClass(this._tooltip._container,'leaflet-clickable'),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(t.DomUtil.removeClass(this._tooltip._container,'leaflet-clickable'),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:n)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),t.LayerGroup=t.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var i,e,n=Array.prototype.slice.call(arguments,1);for(i in this._layers)e=this._layers[i],e[t]&&e[t].apply(e,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke('setZIndex',t)},getLayerId:function(e){return t.stamp(e)}}),t.layerGroup=function(e){return new t.LayerGroup(e)},t.FeatureGroup=t.LayerGroup.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),t.LayerGroup.prototype.addLayer.call(this,e),this.fire('layeradd',{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),t.LayerGroup.prototype.removeLayer.call(this,e),this.fire('layerremove',{layer:e})):this},setStyle:function(t){return this.invoke('setStyle',t)},bringToFront:function(){return this.invoke('bringToFront')},bringToBack:function(){return this.invoke('bringToBack')},getBounds:function(){var i=new t.LatLngBounds;for(var n in this._layers){var e=this._layers[n];i.extend(e.getBounds?e.getBounds():e.getLatLng())};return i}}),t.featureGroup=function(e){return new t.FeatureGroup(e)},t.Renderer=t.Layer.extend({options:{padding:.1},initialize:function(e){t.setOptions(this,e),t.stamp(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&t.DomUtil.addClass(this._container,'leaflet-zoom-animated')),this.getPane().appendChild(this._container),this._update(),this.on('update',this._updatePaths,this)},onRemove:function(){t.DomUtil.remove(this._container),this.off('update',this._updatePaths,this)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,i){var n=this._map.getZoomScale(i,this._zoom),r=t.DomUtil.getPosition(this._container),o=this._map.getSize().multiplyBy(.5+this.options.padding),a=this._map.project(this._center,i),h=this._map.project(e,i),l=h.subtract(a),s=o.multiplyBy(-n).add(r).add(o).subtract(l);t.Browser.any3d?t.DomUtil.setTransform(this._container,s,n):t.DomUtil.setPosition(this._container,s)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var e=this.options.padding,i=this._map.getSize(),n=this._map.containerPointToLayerPoint(i.multiplyBy(-e)).round();this._bounds=new t.Bounds(n,n.add(i.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),t.Map.include({getRenderer:function(e){var i=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return i||(i=this._renderer=this.options.preferCanvas&&t.canvas()||t.svg()),this.hasLayer(i)||this.addLayer(i),i},_getPaneRenderer:function(e){if('overlayPane'===e||e===n)return!1;var i=this._paneRenderers[e];return i===n&&(i=t.SVG&&t.svg({pane:e})||t.Canvas&&t.canvas({pane:e}),this._paneRenderers[e]=i),i}}),t.Path=t.Layer.extend({options:{stroke:!0,color:'#3388ff',weight:3,opacity:1,lineCap:'round',lineJoin:'round',dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:'evenodd',interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return t.setOptions(this,e),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(t.Browser.touch?10:0)}}),t.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var o=t.length,a=typeof Uint8Array!=n+''?Uint8Array:Array,s=new a(o);s[0]=s[o-1]=1,this._simplifyDPStep(t,s,e,0,o-1);var i,r=[];for(i=0;i<o;i++)s[i]&&r.push(t[i]);return r},_simplifyDPStep:function(t,e,i,n,o){var r,s,a,h=0;for(s=n+1;s<=o-1;s++)a=this._sqClosestPointOnSegment(t[s],t[n],t[o],!0),a>h&&(r=s,h=a);h>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,s=t.length;i<s;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return o<s-1&&n.push(t[s-1]),n},clipSegment:function(t,e,i,n,r){var h,a,l,o=n?this._lastCode:this._getBitCode(t,i),s=this._getBitCode(e,i);for(this._lastCode=s;;){if(!(o|s))return[t,e];if(o&s)return!1;h=o||s,a=this._getEdgeIntersection(t,e,h,i,r),l=this._getBitCode(a,i),h===o?(t=a,o=l):(e=a,s=l)}},_getEdgeIntersection:function(e,i,n,o,a){var s,r,h=i.x-e.x,l=i.y-e.y,u=o.min,c=o.max;return 8&n?(s=e.x+h*(c.y-e.y)/l,r=c.y):4&n?(s=e.x+h*(u.y-e.y)/l,r=u.y):2&n?(s=c.x,r=e.y+l*(c.x-e.x)/h):1&n&&(s=u.x,r=e.y+l*(u.x-e.x)/h),new t.Point(s,r,a)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(e,i,n,o){var l,a=i.x,h=i.y,s=n.x-a,r=n.y-h,u=s*s+r*r;return u>0&&(l=((e.x-a)*s+(e.y-h)*r)/u,l>1?(a=n.x,h=n.y):l>0&&(a+=s*l,h+=r*l)),s=e.x-a,r=e.y-h,o?s*s+r*r:new t.Point(a,h)}},t.Polyline=t.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,i){t.setOptions(this,i),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var s,r,a=1/0,n=null,u=t.LineUtil._sqClosestPointOnSegment,h=0,d=this._parts.length;h<d;h++)for(var o=this._parts[h],i=1,c=o.length;i<c;i++){s=o[i-1],r=o[i];var l=u(e,s,r,!0);l<a&&(a=l,n=u(e,s,r))};return n&&(n.distance=Math.sqrt(a)),n},getCenter:function(){if(!this._map)throw new Error('Must add layer to map before using getCenter()');var t,n,r,o,s,e,a,i=this._rings[0],h=i.length;if(!h)return null;for(t=0,n=0;t<h-1;t++)n+=i[t].distanceTo(i[t+1])/2;if(0===n)return this._map.layerPointToLatLng(i[0]);for(t=0,o=0;t<h-1;t++)if(s=i[t],e=i[t+1],r=s.distanceTo(e),o+=r,o>n)return a=(o-n)/r,this._map.layerPointToLatLng([e.x-a*(e.x-s.x),e.y-a*(e.y-s.y)])},getBounds:function(){return this._bounds},addLatLng:function(e,i){return i=i||this._defaultShape(),e=t.latLng(e),i.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new t.LatLngBounds,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return t.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var n=[],o=t.Polyline._flat(e),i=0,s=e.length;i<s;i++)o?(n[i]=t.latLng(e[i]),this._bounds.extend(n[i])):n[i]=this._convertLatLngs(e[i]);return n},_project:function(){var e=new t.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e);var i=this._clickTolerance(),n=new t.Point(i,i);this._bounds.isValid()&&e.isValid()&&(e.min._subtract(n),e.max._add(n),this._pxBounds=e)},_projectLatlngs:function(e,i,n){var o,s,a=e[0]instanceof t.LatLng,r=e.length;if(a){for(s=[],o=0;o<r;o++)s[o]=this._map.latLngToLayerPoint(e[o]),n.extend(s[o]);i.push(s)}
else for(o=0;o<r;o++)this._projectLatlngs(e[o],i,n)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(l)){if(this.options.noClip)return void(this._parts=this._rings);var s,e,i,h,a,n,o,r=this._parts;for(s=0,i=0,h=this._rings.length;s<h;s++)for(o=this._rings[s],e=0,a=o.length;e<a-1;e++)n=t.LineUtil.clipSegment(o[e],o[e+1],l,e,!0),n&&(r[i]=r[i]||[],r[i].push(n[0]),n[1]===o[e+1]&&e!==a-2||(r[i].push(n[1]),i++))}},_simplifyPoints:function(){for(var i=this._parts,n=this.options.smoothFactor,e=0,o=i.length;e<o;e++)i[e]=t.LineUtil.simplify(i[e],n)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),t.polyline=function(e,i){return new t.Polyline(e,i)},t.Polyline._flat=function(e){return!t.Util.isArray(e[0])||'object'!=typeof e[0][0]&&'undefined'!=typeof e[0][0]},t.PolyUtil={},t.PolyUtil.clipPolygon=function(e,i,n){var a,o,m,d,h,l,u,r,s,p=[1,4,2,8],c=t.LineUtil;for(o=0,u=e.length;o<u;o++)e[o]._code=c._getBitCode(e[o],i);for(d=0;d<4;d++){for(r=p[d],a=[],o=0,u=e.length,m=u-1;o<u;m=o++)h=e[o],l=e[m],h._code&r?l._code&r||(s=c._getEdgeIntersection(l,h,r,i,n),s._code=c._getBitCode(s,i),a.push(s)):(l._code&r&&(s=c._getEdgeIntersection(l,h,r,i,n),s._code=c._getBitCode(s,i),a.push(s)),a.push(h));e=a};return e},t.Polygon=t.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error('Must add layer to map before using getCenter()');var n,r,t,e,o,i,a,h,u,s=this._rings[0],l=s.length;if(!l)return null;for(i=a=h=0,n=0,r=l-1;n<l;r=n++)t=s[n],e=s[r],o=t.y*e.x-e.y*t.x,a+=(t.x+e.x)*o,h+=(t.y+e.y)*o,i+=3*o;return u=0===i?s[0]:[a/i,h/i],this._map.layerPointToLatLng(u)},_convertLatLngs:function(e){var i=t.Polyline.prototype._convertLatLngs.call(this,e),n=i.length;return n>=2&&i[0]instanceof t.LatLng&&i[0].equals(i[n-1])&&i.pop(),i},_setLatLngs:function(e){t.Polyline.prototype._setLatLngs.call(this,e),t.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return t.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,o=this.options.weight,s=new t.Point(o,o);if(e=new t.Bounds(e.min.subtract(s),e.max.add(s)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e)){if(this.options.noClip)return void(this._parts=this._rings);for(var i,n=0,r=this._rings.length;n<r;n++)i=t.PolyUtil.clipPolygon(this._rings[n],e,!0),i.length&&this._parts.push(i)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),t.polygon=function(e,i){return new t.Polygon(e,i)},t.Rectangle=t.Polygon.extend({initialize:function(e,i){t.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),i)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(e){return e=t.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}}),t.rectangle=function(e,i){return new t.Rectangle(e,i)},t.CircleMarker=t.Path.extend({options:{fill:!0,radius:10},initialize:function(e,i){t.setOptions(this,i),this._latlng=t.latLng(e),this._radius=this.options.radius},setLatLng:function(e){return this._latlng=t.latLng(e),this.redraw(),this.fire('move',{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var i=e&&e.radius||this._radius;return t.Path.prototype.setStyle.call(this,e),this.setRadius(i),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,o=this._radiusY||e,i=this._clickTolerance(),n=[e+i,o+i];this._pxBounds=new t.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),t.circleMarker=function(e,i){return new t.CircleMarker(e,i)},t.Circle=t.CircleMarker.extend({initialize:function(e,i,n){if('number'==typeof i&&(i=t.extend({},n,{radius:i})),t.setOptions(this,i),this._latlng=t.latLng(e),isNaN(this.options.radius))throw new Error('Circle radius cannot be NaN');this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new t.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:t.Path.prototype.setStyle,_project:function(){var h=this._latlng.lng,o=this._latlng.lat,e=this._map,l=e.options.crs;if(l.distance===t.CRS.Earth.distance){var i=Math.PI/180,s=this._mRadius/t.CRS.Earth.R/i,u=e.project([o+s,h]),d=e.project([o-s,h]),r=u.add(d).divideBy(2),a=e.unproject(r).lat,n=Math.acos((Math.cos(s*i)-Math.sin(o*i)*Math.sin(a*i))/(Math.cos(o*i)*Math.cos(a*i)))/i;(isNaN(n)||0===n)&&(n=s/Math.cos(Math.PI/180*o)),this._point=r.subtract(e.getPixelOrigin()),this._radius=isNaN(n)?0:Math.max(Math.round(r.x-e.project([a,h-n]).x),1),this._radiusY=Math.max(Math.round(r.y-u.y),1)}
else{var c=l.unproject(l.project(this._latlng).subtract([this._mRadius,0]));this._point=e.latLngToLayerPoint(this._latlng),this._radius=this._point.x-e.latLngToLayerPoint(c).x};this._updateBounds()}}),t.circle=function(e,i,n){return new t.Circle(e,i,n)},t.SVG=t.Renderer.extend({getEvents:function(){var e=t.Renderer.prototype.getEvents.call(this);return e.zoomstart=this._onZoomStart,e},_initContainer:function(){this._container=t.SVG.create('svg'),this._container.setAttribute('pointer-events','none'),this._rootGroup=t.SVG.create('g'),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){t.Renderer.prototype._update.call(this);var i=this._bounds,e=i.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute('width',e.x),n.setAttribute('height',e.y)),t.DomUtil.setPosition(n,i.min),n.setAttribute('viewBox',[i.min.x,i.min.y,e.x,e.y].join(' ')),this.fire('update')}},_initPath:function(e){var i=e._path=t.SVG.create('path');e.options.className&&t.DomUtil.addClass(i,e.options.className),e.options.interactive&&t.DomUtil.addClass(i,'leaflet-interactive'),this._updateStyle(e),this._layers[t.stamp(e)]=e},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(e){t.DomUtil.remove(e._path),e.removeInteractiveTarget(e._path),delete this._layers[t.stamp(e)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute('stroke',i.color),e.setAttribute('stroke-opacity',i.opacity),e.setAttribute('stroke-width',i.weight),e.setAttribute('stroke-linecap',i.lineCap),e.setAttribute('stroke-linejoin',i.lineJoin),i.dashArray?e.setAttribute('stroke-dasharray',i.dashArray):e.removeAttribute('stroke-dasharray'),i.dashOffset?e.setAttribute('stroke-dashoffset',i.dashOffset):e.removeAttribute('stroke-dashoffset')):e.setAttribute('stroke','none'),i.fill?(e.setAttribute('fill',i.fillColor||i.color),e.setAttribute('fill-opacity',i.fillOpacity),e.setAttribute('fill-rule',i.fillRule||'evenodd')):e.setAttribute('fill','none'))},_updatePoly:function(e,i){this._setPath(e,t.SVG.pointsToPath(e._parts,i))},_updateCircle:function(t){var i=t._point,e=t._radius,o=t._radiusY||e,n='a'+e+','+o+' 0 1,0 ',s=t._empty()?'M0 0':'M'+(i.x-e)+','+i.y+n+2*e+',0 '+n+2*-e+',0 ';this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute('d',e)},_bringToFront:function(e){t.DomUtil.toFront(e._path)},_bringToBack:function(e){t.DomUtil.toBack(e._path)}}),t.extend(t.SVG,{create:function(t){return i.createElementNS('http://www.w3.org/2000/svg',t)},pointsToPath:function(e,i){var o,n,h,l,s,r,a='';for(o=0,h=e.length;o<h;o++){for(s=e[o],n=0,l=s.length;n<l;n++)r=s[n],a+=(n?'L':'M')+r.x+' '+r.y;a+=i?t.Browser.svg?'z':'x':''};return a||'M0 0'}}),t.Browser.svg=!(!i.createElementNS||!t.SVG.create('svg').createSVGRect),t.svg=function(e){return t.Browser.svg||t.Browser.vml?new t.SVG(e):null},t.Browser.vml=!t.Browser.svg&&function(){try{var n=i.createElement('div');n.innerHTML='<v:shape adj="1"/>';var e=n.firstChild;return e.style.behavior='url(#default#VML)',e&&'object'==typeof e.adj}catch(t){return!1}}(),t.SVG.include(t.Browser.vml?{_initContainer:function(){this._container=t.DomUtil.create('div','leaflet-vml-container')},_update:function(){this._map._animatingZoom||(t.Renderer.prototype._update.call(this),this.fire('update'))},_initPath:function(e){var i=e._container=t.SVG.create('shape');t.DomUtil.addClass(i,'leaflet-vml-shape '+(this.options.className||'')),i.coordsize='1 1',e._path=t.SVG.create('path'),i.appendChild(e._path),this._updateStyle(e),this._layers[t.stamp(e)]=e},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(e){var i=e._container;t.DomUtil.remove(i),e.removeInteractiveTarget(i),delete this._layers[t.stamp(e)]},_updateStyle:function(e){var n=e._stroke,o=e._fill,i=e.options,s=e._container;s.stroked=!!i.stroke,s.filled=!!i.fill,i.stroke?(n||(n=e._stroke=t.SVG.create('stroke')),s.appendChild(n),n.weight=i.weight+'px',n.color=i.color,n.opacity=i.opacity,i.dashArray?n.dashStyle=t.Util.isArray(i.dashArray)?i.dashArray.join(' '):i.dashArray.replace(/( *, *)/g,' '):n.dashStyle='',n.endcap=i.lineCap.replace('butt','flat'),n.joinstyle=i.lineJoin):n&&(s.removeChild(n),e._stroke=null),i.fill?(o||(o=e._fill=t.SVG.create('fill')),s.appendChild(o),o.color=i.fillColor||i.color,o.opacity=i.fillOpacity):o&&(s.removeChild(o),e._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?'M0 0':'AL '+e.x+','+e.y+' '+i+','+n+' 0,23592600')},_setPath:function(t,e){t._path.v=e},_bringToFront:function(e){t.DomUtil.toFront(e._container)},_bringToBack:function(e){t.DomUtil.toBack(e._container)}}:{}),t.Browser.vml&&(t.SVG.create=function(){try{return i.namespaces.add('lvml','urn:schemas-microsoft-com:vml'),function(t){return i.createElement('<lvml:'+t+' class="lvml">')}}catch(t){return function(t){return i.createElement('<'+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),t.Canvas=t.Renderer.extend({getEvents:function(){var e=t.Renderer.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){t.Renderer.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=i.createElement('canvas');t.DomEvent.on(e,'mousemove',t.Util.throttle(this._onMouseMove,32,this),this).on(e,'click dblclick mousedown mouseup contextmenu',this._onClick,this).on(e,'mouseout',this._handleMouseOut,this),this._ctx=e.getContext('2d')},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},t.Renderer.prototype._update.call(this);var i=this._bounds,e=this._container,n=i.getSize(),o=t.Browser.retina?2:1;t.DomUtil.setPosition(e,i.min),e.width=o*n.x,e.height=o*n.y,e.style.width=n.x+'px',e.style.height=n.y+'px',t.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire('update')}},_reset:function(){t.Renderer.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[t.stamp(e)]=e;var i=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=i),this._drawLast=i,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(e){var o=e._order,i=o.next,n=o.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete e._order,delete this._layers[t.stamp(e)],this._requestRedraw(e)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(','),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||t.Util.requestAnimFrame(this._redraw,this))},_extendRedrawBounds:function(e){var i=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new t.Bounds,this._redrawBounds.extend(e._pxBounds.min.subtract([i,i])),this._redrawBounds.extend(e._pxBounds.max.add([i,i]))},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}
else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var i,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()};this._drawing=!0;for(var e=this._drawFirst;e;e=e.next)i=e.layer,(!t||i._pxBounds&&i._pxBounds.intersects(t))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,o,a,s,r=t._parts,h=r.length,i=this._ctx;if(h){for(this._drawnLayers[t._leaflet_id]=t,i.beginPath(),i.setLineDash&&i.setLineDash(t.options&&t.options._dashArray||[]),n=0;n<h;n++){for(o=0,a=r[n].length;o<a;o++)s=r[n][o],i[o?'lineTo':'moveTo'](s.x,s.y);e&&i.closePath()};this._fillStroke(i,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var o=t._point,e=this._ctx,n=t._radius,i=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==i&&(e.save(),e.scale(1,i)),e.beginPath(),e.arc(o.x,o.y/i,n,0,2*Math.PI,!1),1!==i&&e.restore(),this._fillStroke(e,t)}},_fillStroke:function(t,e){var i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||'evenodd')),i.stroke&&0!==i.weight&&(t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())},_onClick:function(e){for(var i,o,s=this._map.mouseEventToLayerPoint(e),n=this._drawFirst;n;n=n.next)i=n.layer,i.options.interactive&&i._containsPoint(s)&&!this._map._draggableMoved(i)&&(o=i);o&&(t.DomEvent._fakeStop(e),this._fireEvent([o],e))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(e){var i=this._hoveredLayer;i&&(t.DomUtil.removeClass(this._container,'leaflet-interactive'),this._fireEvent([i],e,'mouseout'),this._hoveredLayer=null)},_handleMouseHover:function(e,i){for(var o,n,s=this._drawFirst;s;s=s.next)o=s.layer,o.options.interactive&&o._containsPoint(i)&&(n=o);n!==this._hoveredLayer&&(this._handleMouseOut(e),n&&(t.DomUtil.addClass(this._container,'leaflet-interactive'),this._fireEvent([n],e,'mouseover'),this._hoveredLayer=n)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],e)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:function(t){var e=t._order,i=e.next,n=e.prev;i&&(i.prev=n,n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}),t.Browser.canvas=function(){return!!i.createElement('canvas').getContext}(),t.canvas=function(e){return t.Browser.canvas?new t.Canvas(e):null},t.Polyline.prototype._containsPoint=function(e,i){var o,n,r,h,a,s,l=this._clickTolerance();if(!this._pxBounds.contains(e))return!1;for(o=0,h=this._parts.length;o<h;o++)for(s=this._parts[o],n=0,a=s.length,r=a-1;n<a;r=n++)if((i||0!==n)&&t.LineUtil.pointToSegmentDistance(e,s[r],s[n])<=l)return!0;return!1},t.Polygon.prototype._containsPoint=function(e){var n,i,o,s,r,a,u,h,l=!1;if(!this._pxBounds.contains(e))return!1;for(s=0,u=this._parts.length;s<u;s++)for(n=this._parts[s],r=0,h=n.length,a=h-1;r<h;a=r++)i=n[r],o=n[a],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(l=!l);return l||t.Polyline.prototype._containsPoint.call(this,e,!0)},t.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},t.GeoJSON=t.FeatureGroup.extend({initialize:function(e,i){t.setOptions(this,i),this._layers={},e&&this.addData(e)},addData:function(e){var s,a,n,r=t.Util.isArray(e)?e:e.features;if(r){for(s=0,a=r.length;s<a;s++)n=r[s],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this};var o=this.options;if(o.filter&&!o.filter(e))return this;var i=t.GeoJSON.geometryToLayer(e,o);return i?(i.feature=t.GeoJSON.asFeature(e),i.defaultOptions=i.options,this.resetStyle(i),o.onEachFeature&&o.onEachFeature(e,i),this.addLayer(i)):this},resetStyle:function(e){return e.options=t.Util.extend({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){'function'==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),t.extend(t.GeoJSON,{geometryToLayer:function(e,i){var s,a,n,h,o='Feature'===e.type?e.geometry:e,r=o?o.coordinates:null,l=[],u=i&&i.pointToLayer,c=i&&i.coordsToLatLng||this.coordsToLatLng;if(!r&&!o)return null;switch(o.type){case'Point':return s=c(r),u?u(e,s):new t.Marker(s);case'MultiPoint':for(n=0,h=r.length;n<h;n++)s=c(r[n]),l.push(u?u(e,s):new t.Marker(s));return new t.FeatureGroup(l);case'LineString':case'MultiLineString':return a=this.coordsToLatLngs(r,'LineString'===o.type?0:1,c),new t.Polyline(a,i);case'Polygon':case'MultiPolygon':return a=this.coordsToLatLngs(r,'Polygon'===o.type?1:2,c),new t.Polygon(a,i);case'GeometryCollection':for(n=0,h=o.geometries.length;n<h;n++){var d=this.geometryToLayer({geometry:o.geometries[n],type:'Feature',properties:e.properties},i);d&&l.push(d)};return new t.FeatureGroup(l);default:throw new Error('Invalid GeoJSON object.')}},coordsToLatLng:function(e){return new t.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(t,e,i){for(var o,s=[],n=0,r=t.length;n<r;n++)o=e?this.coordsToLatLngs(t[n],e-1,i):(i||this.coordsToLatLng)(t[n]),s.push(o);return s},latLngToCoords:function(t){return t.alt!==n?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(e,i,n){for(var o=[],s=0,r=e.length;s<r;s++)o.push(i?t.GeoJSON.latLngsToCoords(e[s],i-1,n):t.GeoJSON.latLngToCoords(e[s]));return!i&&n&&o.push(o[0]),o},getFeature:function(e,i){return e.feature?t.extend({},e.feature,{geometry:i}):t.GeoJSON.asFeature(i)},asFeature:function(t){return'Feature'===t.type||'FeatureCollection'===t.type?t:{type:'Feature',properties:{},geometry:t}}});var r={toGeoJSON:function(){return t.GeoJSON.getFeature(this,{type:'Point',coordinates:t.GeoJSON.latLngToCoords(this.getLatLng())})}};t.Marker.include(r),t.Circle.include(r),t.CircleMarker.include(r),t.Polyline.prototype.toGeoJSON=function(){var e=!t.Polyline._flat(this._latlngs),i=t.GeoJSON.latLngsToCoords(this._latlngs,e?1:0);return t.GeoJSON.getFeature(this,{type:(e?'Multi':'')+'LineString',coordinates:i})},t.Polygon.prototype.toGeoJSON=function(){var e=!t.Polyline._flat(this._latlngs),n=e&&!t.Polyline._flat(this._latlngs[0]),i=t.GeoJSON.latLngsToCoords(this._latlngs,n?2:e?1:0,!0);return e||(i=[i]),t.GeoJSON.getFeature(this,{type:(n?'Multi':'')+'Polygon',coordinates:i})},t.LayerGroup.include({toMultiPoint:function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),t.GeoJSON.getFeature(this,{type:'MultiPoint',coordinates:e})},toGeoJSON:function(){var n=this.feature&&this.feature.geometry&&this.feature.geometry.type;if('MultiPoint'===n)return this.toMultiPoint();var i='GeometryCollection'===n,e=[];return this.eachLayer(function(n){if(n.toGeoJSON){var o=n.toGeoJSON();e.push(i?o.geometry:t.GeoJSON.asFeature(o))}}),i?t.GeoJSON.getFeature(this,{geometries:e,type:'GeometryCollection'}):{type:'FeatureCollection',features:e}}}),t.geoJSON=function(e,i){return new t.GeoJSON(e,i)},t.geoJson=t.geoJSON,t.Draggable=t.Evented.extend({options:{clickTolerance:3},statics:{START:t.Browser.touch?['touchstart','mousedown']:['mousedown'],END:{mousedown:'mouseup',touchstart:'touchend',pointerdown:'touchend',MSPointerDown:'touchend'},MOVE:{mousedown:'mousemove',touchstart:'touchmove',pointerdown:'touchmove',MSPointerDown:'touchmove'}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(t.DomEvent.on(this._dragStartTarget,t.Draggable.START.join(' '),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(t.Draggable._dragging===this&&this.finishDrag(),t.DomEvent.off(this._dragStartTarget,t.Draggable.START.join(' '),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(!e._simulated&&this._enabled&&(this._moved=!1,!t.DomUtil.hasClass(this._element,'leaflet-zoom-anim')&&!(t.Draggable._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches||(t.Draggable._dragging=this,this._preventOutline&&t.DomUtil.preventOutline(this._element),t.DomUtil.disableImageDrag(),t.DomUtil.disableTextSelection(),this._moving)))){this.fire('down');var n=e.touches?e.touches[0]:e;this._startPoint=new t.Point(n.clientX,n.clientY),t.DomEvent.on(i,t.Draggable.MOVE[e.type],this._onMove,this).on(i,t.Draggable.END[e.type],this._onUp,this)}},_onMove:function(n){if(!n._simulated&&this._enabled){if(n.touches&&n.touches.length>1)return void(this._moved=!0);var s=n.touches&&1===n.touches.length?n.touches[0]:n,r=new t.Point(s.clientX,s.clientY),o=r.subtract(this._startPoint);(o.x||o.y)&&(Math.abs(o.x)+Math.abs(o.y)<this.options.clickTolerance||(t.DomEvent.preventDefault(n),this._moved||(this.fire('dragstart'),this._moved=!0,this._startPos=t.DomUtil.getPosition(this._element).subtract(o),t.DomUtil.addClass(i.body,'leaflet-dragging'),this._lastTarget=n.target||n.srcElement,e.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),t.DomUtil.addClass(this._lastTarget,'leaflet-drag-target')),this._newPos=this._startPos.add(o),this._moving=!0,t.Util.cancelAnimFrame(this._animRequest),this._lastEvent=n,this._animRequest=t.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire('predrag',e),t.DomUtil.setPosition(this._element,this._newPos),this.fire('drag',e)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){t.DomUtil.removeClass(i.body,'leaflet-dragging'),this._lastTarget&&(t.DomUtil.removeClass(this._lastTarget,'leaflet-drag-target'),this._lastTarget=null);for(var e in t.Draggable.MOVE)t.DomEvent.off(i,t.Draggable.MOVE[e],this._onMove,this).off(i,t.Draggable.END[e],this._onUp,this);t.DomUtil.enableImageDrag(),t.DomUtil.enableTextSelection(),this._moved&&this._moving&&(t.Util.cancelAnimFrame(this._animRequest),this.fire('dragend',{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,t.Draggable._dragging=!1}}),t.Handler=t.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),t.Map.mergeOptions({dragging:!0,inertia:!t.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),t.Map.Drag=t.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new t.Draggable(e._mapPane,e._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on('predrag',this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on('predrag',this._onPreDragWrap,this),e.on('zoomend',this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))};t.DomUtil.addClass(this._map._container,'leaflet-grab leaflet-touch-drag'),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){t.DomUtil.removeClass(this._map._container,'leaflet-grab'),t.DomUtil.removeClass(this._map._container,'leaflet-touch-drag'),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var i=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=t.latLngBounds(this._map.options.maxBounds);this._offsetLimit=t.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}
else this._offsetLimit=null;i.fire('movestart').fire('dragstart'),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())};this._map.fire('move',t).fire('drag',t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var i=this._worldWidth,e=Math.round(i/2),t=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+t)%i+e-t,s=(n+e+t)%i-e-t,r=Math.abs(o+t)<Math.abs(s+t)?o:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(e){var i=this._map,o=i.options,m=!o.inertia||this._times.length<2;if(i.fire('dragend',e),m)i.fire('moveend');else{var u=this._lastPos.subtract(this._positions[0]),c=(this._lastTime-this._times[0])/1e3,s=o.easeLinearity,r=u.multiplyBy(s/c),a=r.distanceTo([0,0]),h=Math.min(o.inertiaMaxSpeed,a),d=r.multiplyBy(h/a),l=h/(o.inertiaDeceleration*s),n=d.multiplyBy(-l/2).round();n.x||n.y?(n=i._limitOffset(n,i.options.maxBounds),t.Util.requestAnimFrame(function(){i.panBy(n,{duration:l,easeLinearity:s,noMoveStart:!0,animate:!0})})):i.fire('moveend')}}}),t.Map.addInitHook('addHandler','dragging',t.Map.Drag),t.Map.mergeOptions({doubleClickZoom:!0}),t.Map.DoubleClickZoom=t.Handler.extend({addHooks:function(){this._map.on('dblclick',this._onDoubleClick,this)},removeHooks:function(){this._map.off('dblclick',this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;'center'===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),t.Map.addInitHook('addHandler','doubleClickZoom',t.Map.DoubleClickZoom),t.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),t.Map.ScrollWheelZoom=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,'mousewheel',this._onWheelScroll,this),this._delta=0},removeHooks:function(){t.DomEvent.off(this._map._container,'mousewheel',this._onWheelScroll,this)},_onWheelScroll:function(e){var n=t.DomEvent.getWheelDelta(e),o=this._map.options.wheelDebounceTime;this._delta+=n,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var i=Math.max(o-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(t.bind(this._performZoom,this),i),t.DomEvent.stop(e)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var r=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,s=n?Math.ceil(o/n)*n:o,i=t._limitZoom(e+(this._delta>0?s:-s))-e;this._delta=0,this._startTime=null,i&&('center'===t.options.scrollWheelZoom?t.setZoom(e+i):t.setZoomAround(this._lastMousePos,e+i))}}),t.Map.addInitHook('addHandler','scrollWheelZoom',t.Map.ScrollWheelZoom),t.extend(t.DomEvent,{_touchstart:t.Browser.msPointer?'MSPointerDown':t.Browser.pointer?'pointerdown':'touchstart',_touchend:t.Browser.msPointer?'MSPointerUp':t.Browser.pointer?'pointerup':'touchend',addDoubleTapListener:function(e,i,n){function u(e){var n;if(t.Browser.pointer){if(!t.Browser.edge||'mouse'===e.pointerType)return;n=t.DomEvent._pointersCount}
else n=e.touches.length;if(!(n>1)){var i=Date.now(),r=i-(s||i);o=e.touches?e.touches[0]:e,a=r>0&&r<=d,s=i}};function c(e){if(a&&!o.cancelBubble){if(t.Browser.pointer){if(!t.Browser.edge||'mouse'===e.pointerType)return;var n,r,h={};for(r in o)n=o[r],h[r]=n&&n.bind?n.bind(o):n;o=h};o.type='dblclick',i(o),s=null}};var s,o,a=!1,d=250,r='_leaflet_',h=this._touchstart,l=this._touchend;return e[r+h+n]=u,e[r+l+n]=c,e[r+'dblclick'+n]=i,e.addEventListener(h,u,!1),e.addEventListener(l,c,!1),e.addEventListener('dblclick',i,!1),this},removeDoubleTapListener:function(e,i){var n='_leaflet_',o=e[n+this._touchstart+i],s=e[n+this._touchend+i],r=e[n+'dblclick'+i];return e.removeEventListener(this._touchstart,o,!1),e.removeEventListener(this._touchend,s,!1),t.Browser.edge||e.removeEventListener('dblclick',r,!1),this}}),t.extend(t.DomEvent,{POINTER_DOWN:t.Browser.msPointer?'MSPointerDown':'pointerdown',POINTER_MOVE:t.Browser.msPointer?'MSPointerMove':'pointermove',POINTER_UP:t.Browser.msPointer?'MSPointerUp':'pointerup',POINTER_CANCEL:t.Browser.msPointer?'MSPointerCancel':'pointercancel',TAG_WHITE_LIST:['INPUT','SELECT','OPTION'],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return'touchstart'===e?this._addPointerStart(t,i,n):'touchmove'===e?this._addPointerMove(t,i,n):'touchend'===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t['_leaflet_'+e+i];return'touchstart'===e?t.removeEventListener(this.POINTER_DOWN,n,!1):'touchmove'===e?t.removeEventListener(this.POINTER_MOVE,n,!1):'touchend'===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(e,n,o){var r=t.bind(function(e){if('mouse'!==e.pointerType&&e.MSPOINTER_TYPE_MOUSE&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(e.target.tagName)<0))return;t.DomEvent.preventDefault(e)};this._handlePointer(e,n)},this);if(e['_leaflet_touchstart'+o]=r,e.addEventListener(this.POINTER_DOWN,r,!1),!this._pointerDocListener){var s=t.bind(this._globalPointerUp,this);i.documentElement.addEventListener(this.POINTER_DOWN,t.bind(this._globalPointerDown,this),!0),i.documentElement.addEventListener(this.POINTER_MOVE,t.bind(this._globalPointerMove,this),!0),i.documentElement.addEventListener(this.POINTER_UP,s,!0),i.documentElement.addEventListener(this.POINTER_CANCEL,s,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(e,i,n){var o=t.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&'mouse'!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,i)},this);e['_leaflet_touchmove'+n]=o,e.addEventListener(this.POINTER_MOVE,o,!1)},_addPointerEnd:function(e,i,n){var o=t.bind(function(t){this._handlePointer(t,i)},this);e['_leaflet_touchend'+n]=o,e.addEventListener(this.POINTER_UP,o,!1),e.addEventListener(this.POINTER_CANCEL,o,!1)}}),t.Map.mergeOptions({touchZoom:t.Browser.touch&&!t.Browser.android23,bounceAtZoomLimits:!0}),t.Map.TouchZoom=t.Handler.extend({addHooks:function(){t.DomUtil.addClass(this._map._container,'leaflet-touch-zoom'),t.DomEvent.on(this._map._container,'touchstart',this._onTouchStart,this)},removeHooks:function(){t.DomUtil.removeClass(this._map._container,'leaflet-touch-zoom'),t.DomEvent.off(this._map._container,'touchstart',this._onTouchStart,this)},_onTouchStart:function(e){var n=this._map;if(e.touches&&2===e.touches.length&&!n._animatingZoom&&!this._zooming){var o=n.mouseEventToContainerPoint(e.touches[0]),s=n.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=n.getSize()._divideBy(2),this._startLatLng=n.containerPointToLatLng(this._centerPoint),'center'!==n.options.touchZoom&&(this._pinchStartLatLng=n.containerPointToLatLng(o.add(s)._divideBy(2))),this._startDist=o.distanceTo(s),this._startZoom=n.getZoom(),this._moved=!1,this._zooming=!0,n._stop(),t.DomEvent.on(i,'touchmove',this._onTouchMove,this).on(i,'touchend',this._onTouchEnd,this),t.DomEvent.preventDefault(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var i=this._map,s=i.mouseEventToContainerPoint(e.touches[0]),r=i.mouseEventToContainerPoint(e.touches[1]),n=s.distanceTo(r)/this._startDist;if(this._zoom=i.getScaleZoom(n,this._startZoom),!i.options.bounceAtZoomLimits&&(this._zoom<i.getMinZoom()&&n<1||this._zoom>i.getMaxZoom()&&n>1)&&(this._zoom=i._limitZoom(this._zoom)),'center'===i.options.touchZoom){if(this._center=this._startLatLng,1===n)return}
else{var o=s._add(r)._divideBy(2)._subtract(this._centerPoint);if(1===n&&0===o.x&&0===o.y)return;this._center=i.unproject(i.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)};this._moved||(i._moveStart(!0),this._moved=!0),t.Util.cancelAnimFrame(this._animRequest);var a=t.bind(i._move,i,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=t.Util.requestAnimFrame(a,this,!0),t.DomEvent.preventDefault(e)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,t.Util.cancelAnimFrame(this._animRequest),t.DomEvent.off(i,'touchmove',this._onTouchMove).off(i,'touchend',this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),t.Map.addInitHook('addHandler','touchZoom',t.Map.TouchZoom),t.Map.mergeOptions({tap:!0,tapTolerance:15}),t.Map.Tap=t.Handler.extend({addHooks:function(){t.DomEvent.on(this._map._container,'touchstart',this._onDown,this)},removeHooks:function(){t.DomEvent.off(this._map._container,'touchstart',this._onDown,this)},_onDown:function(e){if(e.touches){if(t.DomEvent.preventDefault(e),this._fireClick=!0,e.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var n=e.touches[0],o=n.target;this._startPos=this._newPos=new t.Point(n.clientX,n.clientY),o.tagName&&'a'===o.tagName.toLowerCase()&&t.DomUtil.addClass(o,'leaflet-active'),this._holdTimeout=setTimeout(t.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent('contextmenu',n))},this),1e3),this._simulateEvent('mousedown',n),t.DomEvent.on(i,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(e){if(clearTimeout(this._holdTimeout),t.DomEvent.off(i,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&e&&e.changedTouches){var o=e.changedTouches[0],n=o.target;n&&n.tagName&&'a'===n.tagName.toLowerCase()&&t.DomUtil.removeClass(n,'leaflet-active'),this._simulateEvent('mouseup',o),this._isTapValid()&&this._simulateEvent('click',o)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var i=e.touches[0];this._newPos=new t.Point(i.clientX,i.clientY),this._simulateEvent('mousemove',i)},_simulateEvent:function(t,n){var o=i.createEvent('MouseEvents');o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(t,!0,!0,e,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),t.Browser.touch&&!t.Browser.pointer&&t.Map.addInitHook('addHandler','tap',t.Map.Tap),t.Map.mergeOptions({boxZoom:!0}),t.Map.BoxZoom=t.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){t.DomEvent.on(this._container,'mousedown',this._onMouseDown,this)},removeHooks:function(){t.DomEvent.off(this._container,'mousedown',this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(e){return!(!e.shiftKey||1!==e.which&&1!==e.button)&&(this._resetState(),t.DomUtil.disableTextSelection(),t.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(e),void t.DomEvent.on(i,{contextmenu:t.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=t.DomUtil.create('div','leaflet-zoom-box',this._container),t.DomUtil.addClass(this._container,'leaflet-crosshair'),this._map.fire('boxzoomstart')),this._point=this._map.mouseEventToContainerPoint(e);var i=new t.Bounds(this._point,this._startPoint),n=i.getSize();t.DomUtil.setPosition(this._box,i.min),this._box.style.width=n.x+'px',this._box.style.height=n.y+'px'},_finish:function(){this._moved&&(t.DomUtil.remove(this._box),t.DomUtil.removeClass(this._container,'leaflet-crosshair')),t.DomUtil.enableTextSelection(),t.DomUtil.enableImageDrag(),t.DomEvent.off(i,{contextmenu:t.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){setTimeout(t.bind(this._resetState,this),0);var i=new t.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(i).fire('boxzoomend',{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),t.Map.addInitHook('addHandler','boxZoom',t.Map.BoxZoom),t.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),t.Map.Keyboard=t.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex='0'),t.DomEvent.on(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),t.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=i.body,n=i.documentElement,o=t.scrollTop||n.scrollTop,s=t.scrollLeft||n.scrollLeft;this._map._container.focus(),e.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire('focus')},_onBlur:function(){this._focused=!1,this._map.fire('blur')},_setPanDelta:function(t){var e,i,o=this._panKeys={},n=this.keyCodes;for(e=0,i=n.left.length;e<i;e++)o[n.left[e]]=[-1*t,0];for(e=0,i=n.right.length;e<i;e++)o[n.right[e]]=[t,0];for(e=0,i=n.down.length;e<i;e++)o[n.down[e]]=[0,t];for(e=0,i=n.up.length;e<i;e++)o[n.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,o=this._zoomKeys={},n=this.keyCodes;for(e=0,i=n.zoomIn.length;e<i;e++)o[n.zoomIn[e]]=t;for(e=0,i=n.zoomOut.length;e<i;e++)o[n.zoomOut[e]]=-t},_addHooks:function(){t.DomEvent.on(i,'keydown',this._onKeyDown,this)},_removeHooks:function(){t.DomEvent.off(i,'keydown',this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var o,n=e.keyCode,i=this._map;if(n in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;o=this._panKeys[n],e.shiftKey&&(o=t.point(o).multiplyBy(3)),i.panBy(o),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}
else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n)return;i.closePopup()};t.DomEvent.stop(e)}}}),t.Map.addInitHook('addHandler','keyboard',t.Map.Keyboard),t.Handler.MarkerDrag=t.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new t.Draggable(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),t.DomUtil.addClass(e,'leaflet-marker-draggable')},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&t.DomUtil.removeClass(this._marker._icon,'leaflet-marker-draggable')},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire('movestart').fire('dragstart')},_onDrag:function(e){var i=this._marker,n=i._shadow,o=t.DomUtil.getPosition(i._icon),s=i._map.layerPointToLatLng(o);n&&t.DomUtil.setPosition(n,o),i._latlng=s,e.latlng=s,e.oldLatLng=this._oldLatLng,i.fire('move',e).fire('drag',e)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire('moveend').fire('dragend',t)}}),t.Control=t.Class.extend({options:{position:'topright'},initialize:function(e){t.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var i=this._container=this.onAdd(e),o=this.getPosition(),n=e._controlCorners[o];return t.DomUtil.addClass(i,'leaflet-control'),o.indexOf('bottom')!==-1?n.insertBefore(i,n.firstChild):n.appendChild(i),this},remove:function(){return this._map?(t.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),t.control=function(e){return new t.Control(e)},t.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function e(e,s){var r=i+e+' '+i+s;n[e+s]=t.DomUtil.create('div',r,o)};var n=this._controlCorners={},i='leaflet-',o=this._controlContainer=t.DomUtil.create('div',i+'control-container',this._container);e('top','left'),e('top','right'),e('bottom','left'),e('bottom','right')},_clearControlPos:function(){t.DomUtil.remove(this._controlContainer)}}),t.Control.Zoom=t.Control.extend({options:{position:'topleft',zoomInText:'+',zoomInTitle:'Zoom in',zoomOutText:'-',zoomOutTitle:'Zoom out'},onAdd:function(e){var n='leaflet-control-zoom',o=t.DomUtil.create('div',n+' leaflet-bar'),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,n+'-in',o,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,n+'-out',o,this._zoomOut),this._updateDisabled(),e.on('zoomend zoomlevelschange',this._updateDisabled,this),o},onRemove:function(t){t.off('zoomend zoomlevelschange',this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(e,i,n,o,r){var s=t.DomUtil.create('a',n,o);return s.innerHTML=e,s.href='#',s.title=i,s.setAttribute('role','button'),s.setAttribute('aria-label',i),t.DomEvent.on(s,'mousedown dblclick',t.DomEvent.stopPropagation).on(s,'click',t.DomEvent.stop).on(s,'click',r,this).on(s,'click',this._refocusOnMap,this),s},_updateDisabled:function(){var e=this._map,i='leaflet-disabled';t.DomUtil.removeClass(this._zoomInButton,i),t.DomUtil.removeClass(this._zoomOutButton,i),(this._disabled||e._zoom===e.getMinZoom())&&t.DomUtil.addClass(this._zoomOutButton,i),(this._disabled||e._zoom===e.getMaxZoom())&&t.DomUtil.addClass(this._zoomInButton,i)}}),t.Map.mergeOptions({zoomControl:!0}),t.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new t.Control.Zoom,this.addControl(this.zoomControl))}),t.control.zoom=function(e){return new t.Control.Zoom(e)},t.Control.Attribution=t.Control.extend({options:{position:'bottomright',prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){t.setOptions(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=t.DomUtil.create('div','leaflet-control-attribution'),t.DomEvent&&t.DomEvent.disableClickPropagation(this._container);for(var i in e._layers)e._layers[i].getAttribution&&this.addAttribution(e._layers[i].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var i in this._attributions)this._attributions[i]&&e.push(i);var t=[];this.options.prefix&&t.push(this.options.prefix),e.length&&t.push(e.join(', ')),this._container.innerHTML=t.join(' | ')}}}),t.Map.mergeOptions({attributionControl:!0}),t.Map.addInitHook(function(){this.options.attributionControl&&(new t.Control.Attribution).addTo(this)}),t.control.attribution=function(e){return new t.Control.Attribution(e)},t.Control.Scale=t.Control.extend({options:{position:'bottomleft',maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var i='leaflet-control-scale',n=t.DomUtil.create('div',i),o=this.options;return this._addScales(o,i+'-line',n),e.on(o.updateWhenIdle?'moveend':'move',this._update,this),e.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?'moveend':'move',this._update,this)},_addScales:function(e,i,n){e.metric&&(this._mScale=t.DomUtil.create('div',i,n)),e.imperial&&(this._iScale=t.DomUtil.create('div',i,n))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+' m':e/1e3+' km';this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var i,n,o,e=3.2808399*t;e>5280?(i=e/5280,n=this._getRoundNum(i),this._updateScale(this._iScale,n+' mi',n/i)):(o=this._getRoundNum(e),this._updateScale(this._iScale,o+' ft',o/e))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+'px',t.innerHTML=e},_getRoundNum:function(t){var i=Math.pow(10,(Math.floor(t)+'').length-1),e=t/i;return e=e>=10?10:e>=5?5:e>=3?3:e>=2?2:1,i*e}}),t.control.scale=function(e){return new t.Control.Scale(e)},t.Control.Layers=t.Control.extend({options:{collapsed:!0,position:'topright',autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,i,n){return i<n?-1:n<i?1:0}},initialize:function(e,i,n){t.setOptions(this,n),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var o in e)this._addLayer(e[o],o);for(o in i)this._addLayer(i[o],o,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,t.on('zoomend',this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off('zoomend',this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off('add remove',this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(e){e.off('add remove',this._onLayerChange,this);var i=this._getLayer(t.stamp(e));return i&&this._layers.splice(this._layers.indexOf(i),1),this._map?this._update():this},expand:function(){t.DomUtil.addClass(this._container,'leaflet-control-layers-expanded'),this._form.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._form.clientHeight?(t.DomUtil.addClass(this._form,'leaflet-control-layers-scrollbar'),this._form.style.height=e+'px'):t.DomUtil.removeClass(this._form,'leaflet-control-layers-scrollbar'),this._checkDisabledLayers(),this},collapse:function(){return t.DomUtil.removeClass(this._container,'leaflet-control-layers-expanded'),this},_initLayout:function(){var e='leaflet-control-layers',i=this._container=t.DomUtil.create('div',e),s=this.options.collapsed;i.setAttribute('aria-haspopup',!0),t.DomEvent.disableClickPropagation(i),t.Browser.touch||t.DomEvent.disableScrollPropagation(i);var o=this._form=t.DomUtil.create('form',e+'-list');s&&(this._map.on('click',this.collapse,this),t.Browser.android||t.DomEvent.on(i,{mouseenter:this.expand,mouseleave:this.collapse},this));var n=this._layersLink=t.DomUtil.create('a',e+'-toggle',i);n.href='#',n.title='Layers',t.Browser.touch?t.DomEvent.on(n,'click',t.DomEvent.stop).on(n,'click',this.expand,this):t.DomEvent.on(n,'focus',this.expand,this),t.DomEvent.on(o,'click',function(){setTimeout(t.bind(this._onInputClick,this),0)},this),s||this.expand(),this._baseLayersList=t.DomUtil.create('div',e+'-base',o),this._separator=t.DomUtil.create('div',e+'-separator',o),this._overlaysList=t.DomUtil.create('div',e+'-overlays',o),i.appendChild(o)},_getLayer:function(e){for(var i=0;i<this._layers.length;i++)if(this._layers[i]&&t.stamp(this._layers[i].layer)===e)return this._layers[i]},_addLayer:function(e,i,n){e.on('add remove',this._onLayerChange,this),this._layers.push({layer:e,name:i,overlay:n}),this.options.sortLayers&&this._layers.sort(t.bind(function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)},this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;t.DomUtil.empty(this._baseLayersList),t.DomUtil.empty(this._overlaysList);var e,o,n,i,s=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),o=o||i.overlay,e=e||!i.overlay,s+=i.overlay?0:1;return this.options.hideSingleBase&&(e=e&&s>1,this._baseLayersList.style.display=e?'':'none'),this._separator.style.display=o&&e?'':'none',this},_onLayerChange:function(e){this._handlingClick||this._update();var i=this._getLayer(t.stamp(e.target)),n=i.overlay?'add'===e.type?'overlayadd':'overlayremove':'add'===e.type?'baselayerchange':null;n&&this._map.fire(n,i)},_createRadioElement:function(t,e){var o='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':'')+'/>',n=i.createElement('div');return n.innerHTML=o,n.firstChild},_addItem:function(e){var n,s=i.createElement('label'),a=this._map.hasLayer(e.layer);e.overlay?(n=i.createElement('input'),n.type='checkbox',n.className='leaflet-control-layers-selector',n.defaultChecked=a):n=this._createRadioElement('leaflet-base-layers',a),n.layerId=t.stamp(e.layer),t.DomEvent.on(n,'click',this._onInputClick,this);var r=i.createElement('span');r.innerHTML=' '+e.name;var o=i.createElement('div');s.appendChild(o),o.appendChild(n),o.appendChild(r);var h=e.overlay?this._overlaysList:this._baseLayersList;return h.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){var e,i,n,r=this._form.getElementsByTagName('input'),o=[],s=[];this._handlingClick=!0;for(var t=r.length-1;t>=0;t--)e=r[t],i=this._getLayer(e.layerId).layer,n=this._map.hasLayer(i),e.checked&&!n?o.push(i):!e.checked&&n&&s.push(i);for(t=0;t<s.length;t++)this._map.removeLayer(s[t]);for(t=0;t<o.length;t++)this._map.addLayer(o[t]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var e,t,o=this._form.getElementsByTagName('input'),s=this._map.getZoom(),i=o.length-1;i>=0;i--)e=o[i],t=this._getLayer(e.layerId).layer,e.disabled=t.options.minZoom!==n&&s<t.options.minZoom||t.options.maxZoom!==n&&s>t.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),t.control.layers=function(e,i,n){return new t.Control.Layers(e,i,n)}}(window,document);
;L.TileLayer.OSM=L.TileLayer.extend({options:{url:'//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>'},initialize:function(e){if(this.options.subAttribution)this.options.attribution+=' | '+this.options.subAttribution;L.TileLayer.prototype.initialize.call(this,this.options.url,e)}});L.TileLayer.OSM.FR=L.TileLayer.OSM.extend({options:{url:'//{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png'}});L.TileLayer.OSM.MRI=L.TileLayer.OSM.extend({options:{url:'//maps.refuges.info/hiking/{z}/{x}/{y}.png',subAttribution:'<a href="http://wiki.openstreetmap.org/wiki/Hiking/mri">MRI</a>'}});L.TileLayer.Kompass=L.TileLayer.OSM.extend({options:{l:'Touristik',url:'http://ec{s}.cdn.ecmaps.de/WmsGateway.ashx.jpg?Experience=kompass&MapStyle=KOMPASS%20{l}&TileX={x}&TileY={y}&ZoomLevel={z}',maxZoom:15,subdomains:'0123',subAttribution:'<a href="http://www.kompass.de/livemap/">KOMPASS</a>'}});L.TileLayer.OSM.hikebike=L.TileLayer.OSM.extend({options:{url:'http://{s}.tiles.wmflabs.org/hikebike/{z}/{x}/{y}.png',subdomains:'abc',maxZoom:20,subAttribution:'<a href="http://www.hikebikemap.org/">hikebikemap.org</a>'}});L.TileLayer.OSM.hill=L.TileLayer.OSM.extend({options:{url:'//{s}.tiles.wmflabs.org/hillshading/{z}/{x}/{y}.png',subdomains:'abc',maxZoom:15,subAttribution:'<a href="https://wikitech.wikimedia.org">Wikimedia Tool Labs</a>'}});var ft=['Landscape','Outdoors','Cycle','Transport'];for(m in ft)L.TileLayer.OSM[ft[m]]=L.TileLayer.OSM.extend({options:{url:'//{s}.tile.thunderforest.com/'+ft[m].toLowerCase()+'/{z}/{x}/{y}.png?apikey={k}',subAttribution:'<a href="http://www.thunderforest.com">Thunderforest '+ft[m]+'</a>'}});
;L.TileLayer.IGN=L.TileLayer.extend({options:{l:'GEOGRAPHICALGRIDSYSTEMS.MAPS',f:'jpeg',maxNativeZoom:18,maxZoom:21,errorTileUrl:'http://www.ign.fr/sites/all/themes/ign_portail/logo.png',attribution:'&copy; <a href="http://www.ign.fr/">IGN</a>'},initialize:function(i){L.TileLayer.prototype.initialize.call(this,'//wxs.ign.fr/{k}/geoportail/wmts?LAYER={l}&EXCEPTIONS=text/xml&FORMAT=image/{f}&SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetTile&STYLE=normal&TILEMATRIXSET=PM&TILEMATRIX={z}&TILECOL={x}&TILEROW={y}',i)}});
;L.TileLayer.WMS.IGM=L.TileLayer.WMS.extend({initialize:function(){L.TileLayer.WMS.prototype.initialize.call(this,'http://129.206.228.72/cached/osm?',{crs:L.CRS.EPSG900913,tileSize:512})},onAdd:function(t){L.TileLayer.WMS.prototype.onAdd.call(this,t);t.on('zoomend',this._onZoom,this);this._onZoom()},_onZoom:function(){if(!this._map)return;var t={url:'http://wms.pcn.minambiente.it/ogc?map=/ms_ogc/WMS_v1.3/raster/',urlExt:'',attribution:'&copy; <a href="http://www.pcn.minambiente.it/viewer">IGM</a>'};if(this._map._zoom<11){t.url='http://129.206.228.72/cached/osm?';t.layers='osm_auto:all';t.attribution='&copy; <a href="http://www.osm-wms.de/">OSM</a>'}
else if(this._map._zoom<13){t.urlExt='IGM_250000.map';t.layers='CB.IGM250000'}
else if(this._map._zoom<15){t.urlExt='IGM_100000.map';t.layers='MB.IGM100000'}
else if(this._map._zoom<16){t.urlExt='IGM_25000.map';t.layers='CB.IGM25000'};if(this.wmsParams.layers!=t.layers){this._url=t.url+t.urlExt;this.wmsParams.layers=t.layers;this.redraw();this.options.attribution=t.attribution;this._map.attributionControl._attributions=[];this._map.attributionControl.addAttribution(t.attribution)}}});
;L.TileLayer.WMS.IDEE=L.TileLayer.WMS.extend({options:{url:'http://www.idee.es/wms/MTN-Raster/MTN-Raster',layer:'mtn_rasterizado',crs:L.CRS.EPSG3857,maxNativeZoom:18,maxZoom:21,attribution:'&copy; <a href="http://www.idee.es/">IDEE</a>'},initialize:function(t){L.TileLayer.WMS.prototype.initialize.call(this,this.options.url,{layers:this.options.layer,attribution:this.options.attribution},t)}});L.TileLayer.WMS.IDEE.Photo=L.TileLayer.WMS.IDEE.extend({options:{url:'//www.ign.es/wms-inspire/pnoa-ma',layer:'OI.OrthoimageCoverage',attribution:'&copy; <a href="http://www.ign.es/PNOA/">PNOA</a>'}});
;L.TileLayer.Google=L.TileLayer.extend({options:{subdomains:'0123',l:'m',maxZoom:22,attribution:'&copy; <a href="https://www.google.com/maps">Google Maps</a>'},initialize:function(o){L.TileLayer.prototype.initialize.call(this,'//mt{s}.google.com/vt/lyrs={l}&x={x}&y={y}&z={z}',o)},onAdd:function(o){o.on('movestart',this._resetNativeZoom,this);L.TileLayer.prototype.onAdd.call(this,o)},onRemove:function(o){o.off('movestart',this._resetNativeZoom,this);L.TileLayer.prototype.onRemove.call(this,o)},_resetNativeZoom:function(){this.options.maxNativeZoom=20},_tileOnError:function(o,t,e){this.options.maxNativeZoom=19;L.TileLayer.prototype._tileOnError.call(this,o,t,e)}});
(function(t,e){typeof exports==='object'&&typeof module!=='undefined'?module.exports=e():typeof define==='function'&&define.amd?define(e):(t.proj4=e())}(this,(function(){'use strict';var ce=function(t){t('EPSG:4326','+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees');t('EPSG:4269','+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees');t('EPSG:3857','+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs');t.WGS84=t['EPSG:4326'];t['EPSG:3785']=t['EPSG:3857'];t.GOOGLE=t['EPSG:3857'];t['EPSG:900913']=t['EPSG:3857'];t['EPSG:102113']=t['EPSG:3857']},d=1,p=2,me=4,L=5,U=4.84813681109535993589914102357e-6,e=Math.PI/2,de=0.1666666666666666667,pe=0.04722222222222222222,Me=0.02215608465608465608,o=(typeof Number.EPSILON==='undefined')?1.0e-10:Number.EPSILON,r=0.01745329251994329577,g=57.29577951308232088,ge=Math.PI/4,ve=Math.PI*2,ye=3.14159265359,s={};s.greenwich=0.0;s.lisbon=-9.131906111111;s.paris=2.337229166667;s.bogota=-74.080916666667;s.madrid=-3.687938888889;s.rome=12.452333333333;s.bern=7.439583333333;s.jakarta=106.807719444444;s.ferro=-17.666666666667;s.brussels=4.367975;s.stockholm=18.058277777778;s.athens=23.7163375;s.oslo=10.722916666667;var fe={ft:{to_meter:0.3048},'us-ft':{to_meter:1200/3937}};var ut=/[\s_\-\/\(\)]/g;function G(t,e){if(t[e]){return t[e]};var i=Object.keys(t),n=e.toLowerCase().replace(ut,''),r=-1,a,s;while(++r<i.length){a=i[r];s=a.toLowerCase().replace(ut,'');if(s===n){return t[a]}}};var st=function(t){var e={};var o=t.split('+').map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var a=e.split('=');a.push(!0);t[a[0].toLowerCase()]=a[1];return t},{});var a,i,n,h={proj:'projName',datum:'datumCode',rf:function(t){e.rf=parseFloat(t)},lat_0:function(t){e.lat0=t*r},lat_1:function(t){e.lat1=t*r},lat_2:function(t){e.lat2=t*r},lat_ts:function(t){e.lat_ts=t*r},lon_0:function(t){e.long0=t*r},lon_1:function(t){e.long1=t*r},lon_2:function(t){e.long2=t*r},alpha:function(t){e.alpha=parseFloat(t)*r},lonc:function(t){e.longc=t*r},x_0:function(t){e.x0=parseFloat(t)},y_0:function(t){e.y0=parseFloat(t)},k_0:function(t){e.k0=parseFloat(t)},k:function(t){e.k0=parseFloat(t)},a:function(t){e.a=parseFloat(t)},b:function(t){e.b=parseFloat(t)},r_a:function(){e.R_A=!0},zone:function(t){e.zone=parseInt(t,10)},south:function(){e.utmSouth=!0},towgs84:function(t){e.datum_params=t.split(',').map(function(t){return parseFloat(t)})},to_meter:function(t){e.to_meter=parseFloat(t)},units:function(t){e.units=t;var a=G(fe,t);if(a){e.to_meter=a.to_meter}},from_greenwich:function(t){e.from_greenwich=t*r},pm:function(t){var a=G(s,t);e.from_greenwich=(a?a:parseFloat(t))*r},nadgrids:function(t){if(t==='@null'){e.datumCode='none'}
else{e.nadgrids=t}},axis:function(t){var a='ewnsud';if(t.length===3&&a.indexOf(t.substr(0,1))!==-1&&a.indexOf(t.substr(1,1))!==-1&&a.indexOf(t.substr(2,1))!==-1){e.axis=t}}};for(a in o){i=o[a];if(a in h){n=h[a];if(typeof n==='function'){n(i)}
else{e[n]=i}}
else{e[a]=i}};if(typeof e.datumCode==='string'&&e.datumCode!=='WGS84'){e.datumCode=e.datumCode.toLowerCase()};return e},C=1,nt=2,ht=3,E=4,ot=5,D=-1,oe=/\s/,le=/[A-Za-z]/,ue=/[A-Za-z84]/,k=/[,\]]/,lt=/[\d\.E\-\+]/;function c(t){if(typeof t!=='string'){throw new Error('not a string')};this.text=t.trim();this.level=0;this.place=0;this.root=null;this.stack=[];this.currentObject=null;this.state=C};c.prototype.readCharicter=function(){var char=this.text[this.place++];if(this.state!==E){while(oe.test(char)){if(this.place>=this.text.length){return};char=this.text[this.place++]}};switch(this.state){case C:return this.neutral(char);case nt:return this.keyword(char);case E:return this.quoted(char);case ot:return this.afterquote(char);case ht:return this.number(char);case D:return}};c.prototype.afterquote=function(char){if(char==='"'){this.word+='"';this.state=E;return};if(k.test(char)){this.word=this.word.trim();this.afterItem(char);return};throw new Error('havn\'t handled "'+char+'" in afterquote yet, index '+this.place)};c.prototype.afterItem=function(char){if(char===','){if(this.word!==null){this.currentObject.push(this.word)};this.word=null;this.state=C;return};if(char===']'){this.level--;if(this.word!==null){this.currentObject.push(this.word);this.word=null};this.state=C;this.currentObject=this.stack.pop();if(!this.currentObject){this.state=D};return}};c.prototype.number=function(char){if(lt.test(char)){this.word+=char;return};if(k.test(char)){this.word=parseFloat(this.word);this.afterItem(char);return};throw new Error('havn\'t handled "'+char+'" in number yet, index '+this.place)};c.prototype.quoted=function(char){if(char==='"'){this.state=ot;return};this.word+=char;return};c.prototype.keyword=function(char){if(ue.test(char)){this.word+=char;return};if(char==='['){var e=[];e.push(this.word);this.level++;if(this.root===null){this.root=e}
else{this.currentObject.push(e)};this.stack.push(this.currentObject);this.currentObject=e;this.state=C;return};if(k.test(char)){this.afterItem(char);return};throw new Error('havn\'t handled "'+char+'" in keyword yet, index '+this.place)};c.prototype.neutral=function(char){if(le.test(char)){this.word=char;this.state=nt;return};if(char==='"'){this.word='';this.state=E;return};if(lt.test(char)){this.word=char;this.state=ht;return};if(k.test(char)){this.afterItem(char);return};throw new Error('havn\'t handled "'+char+'" in neutral yet, index '+this.place)};c.prototype.output=function(){while(this.place<this.text.length){this.readCharicter()};if(this.state===D){return this.root};throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function be(t){var e=new c(t);return e.output()};function ft(t,e,a){if(Array.isArray(e)){a.unshift(e);e=null};var r=e?{}:t;var i=a.reduce(function(t,e){v(e,t);return t},r);if(e){t[e]=i}};function v(t,e){if(!Array.isArray(t)){e[t]=!0;return};var a=t.shift();if(a==='PARAMETER'){a=t.shift()};if(t.length===1){if(Array.isArray(t[0])){e[a]={};v(t[0],e[a]);return};e[a]=t[0];return};if(!t.length){e[a]=!0;return};if(a==='TOWGS84'){e[a]=t;return};if(!Array.isArray(a)){e[a]={}};var i;switch(a){case'UNIT':case'PRIMEM':case'VERT_DATUM':e[a]={name:t[0].toLowerCase(),convert:t[1]};if(t.length===3){v(t[2],e[a])};return;case'SPHEROID':case'ELLIPSOID':e[a]={name:t[0],a:t[1],rf:t[2]};if(t.length===4){v(t[3],e[a])};return;case'PROJECTEDCRS':case'PROJCRS':case'GEOGCS':case'GEOCCS':case'PROJCS':case'LOCAL_CS':case'GEODCRS':case'GEODETICCRS':case'GEODETICDATUM':case'EDATUM':case'ENGINEERINGDATUM':case'VERT_CS':case'VERTCRS':case'VERTICALCRS':case'COMPD_CS':case'COMPOUNDCRS':case'ENGINEERINGCRS':case'ENGCRS':case'FITTED_CS':case'LOCAL_DATUM':case'DATUM':t[0]=['name',t[0]];ft(e,a,t);return;default:i=-1;while(++i<t.length){if(!Array.isArray(t[i])){return v(t,e[a])}};return ft(e,a,t)}};var he=0.01745329251994329577;function we(t,e){var a=e[0],i=e[1];if(!(a in t)&&(i in t)){t[a]=t[i];if(e.length===3){t[a]=e[2](t[a])}}};function m(t){return t*he};function Se(t){if(t.type==='GEOGCS'){t.projName='longlat'}
else if(t.type==='LOCAL_CS'){t.projName='identity';t.local=!0}
else{if(typeof t.PROJECTION==='object'){t.projName=Object.keys(t.PROJECTION)[0]}
else{t.projName=t.PROJECTION}};if(t.UNIT){t.units=t.UNIT.name.toLowerCase();if(t.units==='metre'){t.units='meter'};if(t.UNIT.convert){if(t.type==='GEOGCS'){if(t.DATUM&&t.DATUM.SPHEROID){t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a}}
else{t.to_meter=t.UNIT.convert,10}}};var e=t.GEOGCS;if(t.type==='GEOGCS'){e=t};if(e){if(e.DATUM){t.datumCode=e.DATUM.name.toLowerCase()}
else{t.datumCode=e.name.toLowerCase()};if(t.datumCode.slice(0,2)==='d_'){t.datumCode=t.datumCode.slice(2)};if(t.datumCode==='new_zealand_geodetic_datum_1949'||t.datumCode==='new_zealand_1949'){t.datumCode='nzgd49'};if(t.datumCode==='wgs_1984'){if(t.PROJECTION==='Mercator_Auxiliary_Sphere'){t.sphere=!0};t.datumCode='wgs84'};if(t.datumCode.slice(-6)==='_ferro'){t.datumCode=t.datumCode.slice(0,-6)};if(t.datumCode.slice(-8)==='_jakarta'){t.datumCode=t.datumCode.slice(0,-8)};if(~t.datumCode.indexOf('belge')){t.datumCode='rnb72'};if(e.DATUM&&e.DATUM.SPHEROID){t.ellps=e.DATUM.SPHEROID.name.replace('_19','').replace(/[Cc]larke\_18/,'clrk');if(t.ellps.toLowerCase().slice(0,13)==='international'){t.ellps='intl'};t.a=e.DATUM.SPHEROID.a;t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)};if(~t.datumCode.indexOf('osgb_1936')){t.datumCode='osgb36'}};if(t.b&&!isFinite(t.b)){t.b=t.a};function a(e){var a=t.to_meter||1;return e*a};var i=function(e){return we(t,e)},r=[['standard_parallel_1','Standard_Parallel_1'],['standard_parallel_2','Standard_Parallel_2'],['false_easting','False_Easting'],['false_northing','False_Northing'],['central_meridian','Central_Meridian'],['latitude_of_origin','Latitude_Of_Origin'],['latitude_of_origin','Central_Parallel'],['scale_factor','Scale_Factor'],['k0','scale_factor'],['latitude_of_center','Latitude_of_center'],['lat0','latitude_of_center',m],['longitude_of_center','Longitude_Of_Center'],['longc','longitude_of_center',m],['x0','false_easting',a],['y0','false_northing',a],['long0','central_meridian',m],['lat0','latitude_of_origin',m],['lat0','standard_parallel_1',m],['lat1','standard_parallel_1',m],['lat2','standard_parallel_2',m],['alpha','azimuth',m],['srsCode','name']];r.forEach(i);if(!t.long0&&t.longc&&(t.projName==='Albers_Conic_Equal_Area'||t.projName==='Lambert_Azimuthal_Equal_Area')){t.long0=t.longc};if(!t.lat_ts&&t.lat1&&(t.projName==='Stereographic_South_Pole'||t.projName==='Polar Stereographic (variant B)')){t.lat0=m(t.lat1>0?90:-90);t.lat_ts=t.lat1}};var rt=function(t){var e=be(t),i=e.shift(),r=e.shift();e.unshift(['name',r]);e.unshift(['type',i]);var a={};v(e,a);Se(a);return a};function n(t){var a=this;if(arguments.length===2){var e=arguments[1];if(typeof e==='string'){if(e.charAt(0)==='+'){n[t]=st(arguments[1])}
else{n[t]=rt(arguments[1])}}
else{n[t]=e}}
else if(arguments.length===1){if(Array.isArray(t)){return t.map(function(t){if(Array.isArray(t)){n.apply(a,t)}
else{n(t)}})}
else if(typeof t==='string'){if(t in n){return n[t]}}
else if('EPSG' in t){n['EPSG:'+t.EPSG]=t}
else if('ESRI' in t){n['ESRI:'+t.ESRI]=t}
else if('IAU2000' in t){n['IAU2000:'+t.IAU2000]=t}
else{console.log(t)};return}};ce(n);function Ce(t){return typeof t==='string'};function Ne(t){return t in n};var ne=['PROJECTEDCRS','PROJCRS','GEOGCS','GEOCCS','PROJCS','LOCAL_CS','GEODCRS','GEODETICCRS','GEODETICDATUM','ENGCRS','ENGINEERINGCRS'];function xe(t){return ne.some(function(e){return t.indexOf(e)>-1})};function Ee(t){return t[0]==='+'};function ke(t){if(Ce(t)){if(Ne(t)){return n[t]};if(xe(t)){return rt(t)};if(Ee(t)){return st(t)}}
else{return t}};var at=function(t,e){t=t||{};var a,i;if(!e){return t};for(i in e){a=e[i];if(a!==undefined){t[i]=a}};return t},T=function(t,e,a){var i=t*e;return a/(Math.sqrt(1-i*i))},j=function(t){return t<0?-1:1},u=function(t){return(Math.abs(t)<=ye)?t:(t-(j(t)*ve))},S=function(t,a,i){var r=t*i,s=0.5*t;r=Math.pow(((1-r)/(1+r)),s);return(Math.tan(0.5*(e-a))/r)},it=function(t,a){var h=0.5*t,r,s,i=e-2*Math.atan(a);for(var n=0;n<=15;n++){r=t*Math.sin(i);s=e-2*Math.atan(a*(Math.pow(((1-r)/(1+r)),h)))-i;i+=s;if(Math.abs(s)<=0.0000000001){return i}};return-9999};function Ge(){var t=this.b/this.a;this.es=1-t*t;if(!('x0' in this)){this.x0=0};if(!('y0' in this)){this.y0=0};this.e=Math.sqrt(this.es);if(this.lat_ts){if(this.sphere){this.k0=Math.cos(this.lat_ts)}
else{this.k0=T(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}}
else{if(!this.k0){if(this.k){this.k0=this.k}
else{this.k0=1}}}};function Pe(t){var i=t.x,a=t.y;if(a*g>90&&a*g<-90&&i*g>180&&i*g<-180){return null};var r,s;if(Math.abs(Math.abs(a)-e)<=o){return null}
else{if(this.sphere){r=this.x0+this.a*this.k0*u(i-this.long0);s=this.y0+this.a*this.k0*Math.log(Math.tan(ge+0.5*a))}
else{var n=Math.sin(a),h=S(this.e,a,n);r=this.x0+this.a*this.k0*u(i-this.long0);s=this.y0-this.a*this.k0*Math.log(h)};t.x=r;t.y=s;return t}};function Ae(t){var n=t.x-this.x0,i=t.y-this.y0,r,a;if(this.sphere){a=e-2*Math.atan(Math.exp(-i/(this.a*this.k0)))}
else{var s=Math.exp(-i/(this.a*this.k0));a=it(this.e,s);if(a===-9999){return null}};r=u(this.long0+n/(this.a*this.k0));t.x=r;t.y=a;return t};var re=['Mercator','Popular Visualisation Pseudo Mercator','Mercator_1SP','Mercator_Auxiliary_Sphere','merc'],se={init:Ge,forward:Pe,inverse:Ae,names:re};function Ie(){};function ct(t){return t};var ae=['longlat','identity'],ie={init:Ie,forward:ct,inverse:ct,names:ae};var ee=[se,ie],x={};var N=[];function mt(t,e){var a=N.length;if(!t.names){console.log(e);return!0};N[a]=t;t.names.forEach(function(t){x[t.toLowerCase()]=a});return this};function Re(t){if(!t){return!1};var e=t.toLowerCase();if(typeof x[e]!=='undefined'&&N[x[e]]){return N[x[e]]}};function Oe(){ee.forEach(mt)};var te={start:Oe,add:mt,get:Re};var t={};t.MERIT={a:6378137.0,rf:298.257,ellipseName:'MERIT 1983'};t.SGS85={a:6378136.0,rf:298.257,ellipseName:'Soviet Geodetic System 85'};t.GRS80={a:6378137.0,rf:298.257222101,ellipseName:'GRS 1980(IUGG, 1980)'};t.IAU76={a:6378140.0,rf:298.257,ellipseName:'IAU 1976'};t.airy={a:6377563.396,b:6356256.910,ellipseName:'Airy 1830'};t.APL4={a:6378137,rf:298.25,ellipseName:'Appl. Physics. 1965'};t.NWL9D={a:6378145.0,rf:298.25,ellipseName:'Naval Weapons Lab., 1965'};t.mod_airy={a:6377340.189,b:6356034.446,ellipseName:'Modified Airy'};t.andrae={a:6377104.43,rf:300.0,ellipseName:'Andrae 1876 (Den., Iclnd.)'};t.aust_SA={a:6378160.0,rf:298.25,ellipseName:'Australian Natl & S. Amer. 1969'};t.GRS67={a:6378160.0,rf:298.2471674270,ellipseName:'GRS 67(IUGG 1967)'};t.bessel={a:6377397.155,rf:299.1528128,ellipseName:'Bessel 1841'};t.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:'Bessel 1841 (Namibia)'};t.clrk66={a:6378206.4,b:6356583.8,ellipseName:'Clarke 1866'};t.clrk80={a:6378249.145,rf:293.4663,ellipseName:'Clarke 1880 mod.'};t.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:'Clarke 1858'};t.CPM={a:6375738.7,rf:334.29,ellipseName:'Comm. des Poids et Mesures 1799'};t.delmbr={a:6376428.0,rf:311.5,ellipseName:'Delambre 1810 (Belgium)'};t.engelis={a:6378136.05,rf:298.2566,ellipseName:'Engelis 1985'};t.evrst30={a:6377276.345,rf:300.8017,ellipseName:'Everest 1830'};t.evrst48={a:6377304.063,rf:300.8017,ellipseName:'Everest 1948'};t.evrst56={a:6377301.243,rf:300.8017,ellipseName:'Everest 1956'};t.evrst69={a:6377295.664,rf:300.8017,ellipseName:'Everest 1969'};t.evrstSS={a:6377298.556,rf:300.8017,ellipseName:'Everest (Sabah & Sarawak)'};t.fschr60={a:6378166.0,rf:298.3,ellipseName:'Fischer (Mercury Datum) 1960'};t.fschr60m={a:6378155.0,rf:298.3,ellipseName:'Fischer 1960'};t.fschr68={a:6378150.0,rf:298.3,ellipseName:'Fischer 1968'};t.helmert={a:6378200.0,rf:298.3,ellipseName:'Helmert 1906'};t.hough={a:6378270.0,rf:297.0,ellipseName:'Hough'};t.intl={a:6378388.0,rf:297.0,ellipseName:'International 1909 (Hayford)'};t.kaula={a:6378163.0,rf:298.24,ellipseName:'Kaula 1961'};t.lerch={a:6378139.0,rf:298.257,ellipseName:'Lerch 1979'};t.mprts={a:6397300.0,rf:191.0,ellipseName:'Maupertius 1738'};t.new_intl={a:6378157.5,b:6356772.2,ellipseName:'New International 1967'};t.plessis={a:6376523.0,rf:6355863.0,ellipseName:'Plessis 1817 (France)'};t.krass={a:6378245.0,rf:298.3,ellipseName:'Krassovsky, 1942'};t.SEasia={a:6378155.0,b:6356773.3205,ellipseName:'Southeast Asia'};t.walbeck={a:6376896.0,b:6355834.8467,ellipseName:'Walbeck'};t.WGS60={a:6378165.0,rf:298.3,ellipseName:'WGS 60'};t.WGS66={a:6378145.0,rf:298.25,ellipseName:'WGS 66'};t.WGS7={a:6378135.0,rf:298.26,ellipseName:'WGS 72'};var Yt=t.WGS84={a:6378137.0,rf:298.257223563,ellipseName:'WGS 84'};t.sphere={a:6370997.0,b:6370997.0,ellipseName:'Normal Sphere (r=6370997)'};function ze(t,e,a,r){var s=t*t,n=e*e,i=(s-n)/s,h=0;if(r){t*=1-i*(de+i*(pe+i*Me));s=t*t;i=0}
else{h=Math.sqrt(i)};var o=(s-n)/n;return{es:i,e:h,ep2:o}};function Te(e,a,i,r,n){if(!e){var s=G(t,r);if(!s){s=Yt};e=s.a;a=s.b;i=s.rf};if(i&&!a){a=(1.0-1.0/i)*e};if(i===0||Math.abs(e-a)<o){n=!0;a=e};return{a:e,b:a,rf:i,sphere:n}};var a={};a.wgs84={towgs84:'0,0,0',ellipse:'WGS84',datumName:'WGS84'};a.ch1903={towgs84:'674.374,15.056,405.346',ellipse:'bessel',datumName:'swiss'};a.ggrs87={towgs84:'-199.87,74.79,246.62',ellipse:'GRS80',datumName:'Greek_Geodetic_Reference_System_1987'};a.nad83={towgs84:'0,0,0',ellipse:'GRS80',datumName:'North_American_Datum_1983'};a.nad27={nadgrids:'@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat',ellipse:'clrk66',datumName:'North_American_Datum_1927'};a.potsdam={towgs84:'606.0,23.0,413.0',ellipse:'bessel',datumName:'Potsdam Rauenberg 1950 DHDN'};a.carthage={towgs84:'-263.0,6.0,431.0',ellipse:'clark80',datumName:'Carthage 1934 Tunisia'};a.hermannskogel={towgs84:'653.0,-212.0,449.0',ellipse:'bessel',datumName:'Hermannskogel'};a.ire65={towgs84:'482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15',ellipse:'mod_airy',datumName:'Ireland 1965'};a.rassadiran={towgs84:'-133.63,-157.5,-158.62',ellipse:'intl',datumName:'Rassadiran'};a.nzgd49={towgs84:'59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993',ellipse:'intl',datumName:'New Zealand Geodetic Datum 1949'};a.osgb36={towgs84:'446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894',ellipse:'airy',datumName:'Airy 1830'};a.s_jtsk={towgs84:'589,76,480',ellipse:'bessel',datumName:'S-JTSK (Ferro)'};a.beduaram={towgs84:'-106,-87,188',ellipse:'clrk80',datumName:'Beduaram'};a.gunung_segara={towgs84:'-403,684,41',ellipse:'bessel',datumName:'Gunung Segara Jakarta'};a.rnb72={towgs84:'106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1',ellipse:'intl',datumName:'Reseau National Belge 1972'};function je(t,e,i,r,s,n){var a={};if(t===undefined||t==='none'){a.datum_type=L}
else{a.datum_type=me};if(e){a.datum_params=e.map(parseFloat);if(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0){a.datum_type=d};if(a.datum_params.length>3){if(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0){a.datum_type=p;a.datum_params[3]*=U;a.datum_params[4]*=U;a.datum_params[5]*=U;a.datum_params[6]=(a.datum_params[6]/1000000.0)+1.0}}};a.a=i;a.b=r;a.es=s;a.ep2=n;return a};function f(t,e){if(!(this instanceof f)){return new f(t)};e=e||function(t){if(t){throw t}};var i=ke(t);if(typeof i!=='object'){e(t);return};var h=f.projections.get(i.projName);if(!h){e(t);return};if(i.datumCode&&i.datumCode!=='none'){var s=G(a,i.datumCode);if(s){i.datum_params=s.towgs84?s.towgs84.split(','):null;i.ellps=s.ellipse;i.datumName=s.datumName?s.datumName:i.datumCode}};i.k0=i.k0||1.0;i.axis=i.axis||'enu';i.ellps=i.ellps||'wgs84';var r=Te(i.a,i.b,i.rf,i.ellps,i.sphere),n=ze(r.a,r.b,r.rf,i.R_A),o=i.datum||je(i.datumCode,i.datum_params,r.a,r.b,n.es,n.ep2);at(this,i);at(this,h);this.a=r.a;this.b=r.b;this.rf=r.rf;this.sphere=r.sphere;this.es=n.es;this.e=n.e;this.ep2=n.ep2;this.datum=o;this.init();e(null,this)};f.projections=te;f.projections.start();function De(t,e){if(t.datum_type!==e.datum_type){return!1}
else if(t.a!==e.a||Math.abs(t.es-e.es)>0.000000000050){return!1}
else if(t.datum_type===d){return(t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2])}
else if(t.datum_type===p){return(t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6])}
else{return!0}};function Le(t,a,i){var s=t.x,r=t.y,o=t.z?t.z:0,n,h,u,l;if(r<-e&&r>-1.001*e){r=-e}
else if(r>e&&r<1.001*e){r=e}
else if((r<-e)||(r>e)){return null};if(s>Math.PI){s-=(2*Math.PI)};h=Math.sin(r);l=Math.cos(r);u=h*h;n=i/(Math.sqrt(1.0e0-a*u));return{x:(n+o)*l*Math.cos(s),y:(n+o)*l*Math.sin(s),z:((n*(1-a))+o)*h}};function Ue(t,a,i,h){var u=1e-12,x=(u*u),E=30,f,c,b,s,n,m,d,p,r,M,g,w,S,o=t.x,l=t.y,v=t.z?t.z:0.0,C,N,y;f=Math.sqrt(o*o+l*l);c=Math.sqrt(o*o+l*l+v*v);if(f/i<u){C=0.0;if(c/i<u){N=e;y=-h;return{x:t.x,y:t.y,z:t.z}}}
else{C=Math.atan2(l,o)};b=v/c;s=f/c;n=1.0/Math.sqrt(1.0-a*(2.0-a)*s*s);p=s*(1.0-a)*n;r=b*n;S=0;do{S++;d=i/Math.sqrt(1.0-a*r*r);y=f*p+v*r-d*(1.0-a*r*r);m=a*d/(d+y);n=1.0/Math.sqrt(1.0-m*(2.0-m)*s*s);M=s*(1.0-m)*n;g=b*n;w=g*p-M*r;p=M;r=g}
while(w*w>x&&S<E);N=Math.atan(g/Math.abs(M));return{x:C,y:N,z:y}};function Fe(t,e,a){if(e===d){return{x:t.x+a[0],y:t.y+a[1],z:t.z+a[2],}}
else if(e===p){var h=a[0],o=a[1],l=a[2],r=a[3],s=a[4],n=a[5],i=a[6];return{x:i*(t.x-n*t.y+s*t.z)+h,y:i*(n*t.x+t.y-r*t.z)+o,z:i*(-s*t.x+r*t.y+t.z)+l}}};function qe(t,e,a){if(e===d){return{x:t.x-a[0],y:t.y-a[1],z:t.z-a[2],}}
else if(e===p){var u=a[0],f=a[1],c=a[2],h=a[3],o=a[4],l=a[5],i=a[6],r=(t.x-u)/i,s=(t.y-f)/i,n=(t.z-c)/i;return{x:r+l*s-o*n,y:-l*r+s+h*n,z:o*r-h*s+n}}};function P(t){return(t===d||t===p)};var Xt=function(t,e,a){if(De(t,e)){return a};if(t.datum_type===L||e.datum_type===L){return a};if(t.es===e.es&&t.a===e.a&&!P(t.datum_type)&&!P(e.datum_type)){return a};a=Le(a,t.es,t.a);if(P(t.datum_type)){a=Fe(a,t.datum_type,t.datum_params)};if(P(e.datum_type)){a=qe(a,e.datum_type,e.datum_params)};return Ue(a,e.es,e.a,e.b)},tt=function(t,e,a){var h=a.x,o=a.y,l=a.z||0.0,i,r,s,n={};for(s=0;s<3;s++){if(e&&s===2&&a.z===undefined){continue};if(s===0){i=h;r='x'}
else if(s===1){i=o;r='y'}
else{i=l;r='z'};switch(t.axis[s]){case'e':n[r]=i;break;case'w':n[r]=-i;break;case'n':n[r]=i;break;case's':n[r]=-i;break;case'u':if(a[r]!==undefined){n.z=i};break;case'd':if(a[r]!==undefined){n.z=-i};break;default:return null}};return n},et=function(t){var e={x:t[0],y:t[1]};if(t.length>2){e.z=t[2]};if(t.length>3){e.m=t[3]};return e};function We(t,e){return((t.datum.datum_type===d||t.datum.datum_type===p)&&e.datumCode!=='WGS84')||((e.datum.datum_type===d||e.datum.datum_type===p)&&t.datumCode!=='WGS84')};function A(t,e,a){var i;if(Array.isArray(a)){a=et(a)};if(t.datum&&e.datum&&We(t,e)){i=new f('WGS84');a=A(t,i,a);t=i};if(t.axis!=='enu'){a=tt(t,!1,a)};if(t.projName==='longlat'){a={x:a.x*r,y:a.y*r}}
else{if(t.to_meter){a={x:a.x*t.to_meter,y:a.y*t.to_meter}};a=t.inverse(a)};if(t.from_greenwich){a.x+=t.from_greenwich};a=Xt(t.datum,e.datum,a);if(e.from_greenwich){a={x:a.x-e.from_greenwich,y:a.y}};if(e.projName==='longlat'){a={x:a.x*g,y:a.y*g}}
else{a=e.forward(a);if(e.to_meter){a={x:a.x/e.to_meter,y:a.y/e.to_meter}}};if(e.axis!=='enu'){return tt(e,!0,a)};return a};var Y=f('WGS84');function F(t,e,a){var i;if(Array.isArray(a)){i=A(t,e,a);if(a.length===3){return[i.x,i.y,i.z]}
else{return[i.x,i.y]}}
else{return A(t,e,a)}};function dt(t){if(t instanceof f){return t};if(t.oProj){return t.oProj};return f(t)};function l(t,e,a){t=dt(t);var i=!1,r;if(typeof e==='undefined'){e=t;t=Y;i=!0}
else if(typeof e.x!=='undefined'||Array.isArray(e)){a=e;e=t;t=Y;i=!0};e=dt(e);if(a){return F(t,e,a)}
else{r={forward:function(a){return F(t,e,a)},inverse:function(a){return F(e,t,a)}};if(i){r.oProj=e};return r}};var Q=6,V='AJSAJS',X='AFAFAF',M=65,i=73,h=79,b=86,w=90,Vt={forward:pt,inverse:Je,toPoint:Mt};function pt(t,e){e=e||5;return Ze(He({lat:t[1],lon:t[0]}),e)};function Je(t){var e=W(yt(t.toUpperCase()));if(e.lat&&e.lon){return[e.lon,e.lat,e.lon,e.lat]};return[e.left,e.bottom,e.right,e.top]};function Mt(t){var e=W(yt(t.toUpperCase()));if(e.lat&&e.lon){return[e.lon,e.lat]};return[(e.left+e.right)/2,(e.top+e.bottom)/2]};function q(t){return(t*(Math.PI/180.0))};function gt(t){return(180.0*(t/Math.PI))};function He(t){var h=t.lat,i=t.lon,c=6378137.0,e=0.00669438,m=0.9996,d,l,u,s,o,a,p,r=q(h),v=q(i),M,n;n=Math.floor((i+180)/6)+1;if(i===180){n=60};if(h>=56.0&&h<64.0&&i>=3.0&&i<12.0){n=32};if(h>=72.0&&h<84.0){if(i>=0.0&&i<9.0){n=31}
else if(i>=9.0&&i<21.0){n=33}
else if(i>=21.0&&i<33.0){n=35}
else if(i>=33.0&&i<42.0){n=37}};d=(n-1)*6-180+3;M=q(d);l=(e)/(1-e);u=c/Math.sqrt(1-e*Math.sin(r)*Math.sin(r));s=Math.tan(r)*Math.tan(r);o=l*Math.cos(r)*Math.cos(r);a=Math.cos(r)*(v-M);p=c*((1-e/4-3*e*e/64-5*e*e*e/256)*r-(3*e/8+3*e*e/32+45*e*e*e/1024)*Math.sin(2*r)+(15*e*e/256+45*e*e*e/1024)*Math.sin(4*r)-(35*e*e*e/3072)*Math.sin(6*r));var g=(m*u*(a+(1-s+o)*a*a*a/6.0+(5-18*s+s*s+72*o-58*l)*a*a*a*a*a/120.0)+500000.0),f=(m*(p+u*Math.tan(r)*(a*a/2+(5-s+9*o+4*o*o)*a*a*a*a/24.0+(61-58*s+s*s+600*o-330*l)*a*a*a*a*a*a/720.0)));if(h<0.0){f+=10000000.0};return{northing:Math.round(f),easting:Math.round(g),zoneNumber:n,zoneLetter:Be(h)}};function W(t){var S=t.northing,C=t.easting,N=t.zoneLetter,d=t.zoneNumber;if(d<0||d>60){return null};var M=0.9996,c=6378137.0,a=0.00669438,h,i=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),m,n,s,g,e,v,y,o,r,w=C-500000.0,b=S;if(N<'N'){b-=10000000.0};y=(d-1)*6-180+3;h=(a)/(1-a);v=b/M;o=v/(c*(1-a/4-3*a*a/64-5*a*a*a/256));r=o+(3*i/2-27*i*i*i/32)*Math.sin(2*o)+(21*i*i/16-55*i*i*i*i/32)*Math.sin(4*o)+(151*i*i*i/96)*Math.sin(6*o);m=c/Math.sqrt(1-a*Math.sin(r)*Math.sin(r));n=Math.tan(r)*Math.tan(r);s=h*Math.cos(r)*Math.cos(r);g=c*(1-a)/Math.pow(1-a*Math.sin(r)*Math.sin(r),1.5);e=w/(m*M);var u=r-(m*Math.tan(r)/g)*(e*e/2-(5+3*n+10*s-4*s*s-9*h)*e*e*e*e/24+(61+90*n+298*s+45*n*n-252*h-3*s*s)*e*e*e*e*e*e/720);u=gt(u);var l=(e-(1+2*n+s)*e*e*e/6+(5-2*s+28*n-3*s*s+8*h+24*n*n)*e*e*e*e*e/120)/Math.cos(r);l=y+gt(l);var f;if(t.accuracy){var p=W({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});f={top:p.lat,right:p.lon,bottom:u,left:l}}
else{f={lat:u,lon:l}};return f};function Be(t){var e='Z';if((84>=t)&&(t>=72)){e='X'}
else if((72>t)&&(t>=64)){e='W'}
else if((64>t)&&(t>=56)){e='V'}
else if((56>t)&&(t>=48)){e='U'}
else if((48>t)&&(t>=40)){e='T'}
else if((40>t)&&(t>=32)){e='S'}
else if((32>t)&&(t>=24)){e='R'}
else if((24>t)&&(t>=16)){e='Q'}
else if((16>t)&&(t>=8)){e='P'}
else if((8>t)&&(t>=0)){e='N'}
else if((0>t)&&(t>=-8)){e='M'}
else if((-8>t)&&(t>=-16)){e='L'}
else if((-16>t)&&(t>=-24)){e='K'}
else if((-24>t)&&(t>=-32)){e='J'}
else if((-32>t)&&(t>=-40)){e='H'}
else if((-40>t)&&(t>=-48)){e='G'}
else if((-48>t)&&(t>=-56)){e='F'}
else if((-56>t)&&(t>=-64)){e='E'}
else if((-64>t)&&(t>=-72)){e='D'}
else if((-72>t)&&(t>=-80)){e='C'};return e};function Ze(t,e){var a='00000'+t.easting,i='00000'+t.northing;return t.zoneNumber+t.zoneLetter+Ke(t.easting,t.northing,t.zoneNumber)+a.substr(a.length-5,e)+i.substr(i.length-5,e)};function Ke(t,e,a){var i=vt(a),r=Math.floor(t/100000),s=Math.floor(e/100000)%20;return Qe(r,s,i)};function vt(t){var e=t%Q;if(e===0){e=Q};return e};function Qe(t,e,a){var u=a-1,o=V.charCodeAt(u),l=X.charCodeAt(u),r=o+t-1,s=l+e,n=!1;if(r>w){r=r-w+M-1;n=!0};if(r===i||(o<i&&r>i)||((r>i||o<i)&&n)){r++};if(r===h||(o<h&&r>h)||((r>h||o<h)&&n)){r++;if(r===i){r++}};if(r>w){r=r-w+M-1};if(s>b){s=s-b+M-1;n=!0}
else{n=!1};if(((s===i)||((l<i)&&(s>i)))||(((s>i)||(l<i))&&n)){s++};if(((s===h)||((l<h)&&(s>h)))||(((s>h)||(l<h))&&n)){s++;if(s===i){s++}};if(s>b){s=s-b+M-1};var f=String.fromCharCode(r)+String.fromCharCode(s);return f};function yt(t){if(t&&t.length===0){throw('MGRSPoint coverting from nothing')};var M=t.length,n=null,g='',v,e=0;while(!(/[A-Z]/).test(v=t.charAt(e))){if(e>=2){throw('MGRSPoint bad conversion from: '+t)};g+=v;e++};var p=parseInt(g,10);if(e===0||e+3>M){throw('MGRSPoint bad conversion from: '+t)};var a=t.charAt(e++);if(a<='A'||a==='B'||a==='Y'||a>='Z'||a==='I'||a==='O'){throw('MGRSPoint zone letter '+a+' not handled: '+t)};n=t.substring(e,e+=2);var d=vt(p),y=Ve(n.charAt(0),d),s=Xe(n.charAt(1),d);while(s<Ye(a)){s+=2000000};var m=M-e;if(m%2!==0){throw('MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters'+t)};var i=m/2,h=0.0,o=0.0,r,l,u,f,c;if(i>0){r=100000.0/Math.pow(10,i);l=t.substring(e,e+i);h=parseFloat(l)*r;u=t.substring(e+i);o=parseFloat(u)*r};f=h+y;c=o+s;return{easting:f,northing:c,zoneLetter:a,zoneNumber:p,accuracy:r}};function Ve(t,e){var a=V.charCodeAt(e-1),r=100000.0,s=!1;while(a!==t.charCodeAt(0)){a++;if(a===i){a++};if(a===h){a++};if(a>w){if(s){throw('Bad character: '+t)};a=M;s=!0};r+=100000.0};return r};function Xe(t,e){if(t>'V'){throw('MGRSPoint given invalid Northing '+t)};var a=X.charCodeAt(e-1),r=0.0,s=!1;while(a!==t.charCodeAt(0)){a++;if(a===i){a++};if(a===h){a++};if(a>b){if(s){throw('Bad character: '+t)};a=M;s=!0};r+=100000.0};return r};function Ye(t){var e;switch(t){case'C':e=1100000.0;break;case'D':e=2000000.0;break;case'E':e=2800000.0;break;case'F':e=3700000.0;break;case'G':e=4600000.0;break;case'H':e=5500000.0;break;case'J':e=6400000.0;break;case'K':e=7300000.0;break;case'L':e=8200000.0;break;case'M':e=9100000.0;break;case'N':e=0.0;break;case'P':e=800000.0;break;case'Q':e=1700000.0;break;case'R':e=2600000.0;break;case'S':e=3500000.0;break;case'T':e=4400000.0;break;case'U':e=5300000.0;break;case'V':e=6200000.0;break;case'W':e=7000000.0;break;case'X':e=7900000.0;break;default:e=-1.0};if(e>=0.0){return e}
else{throw('Invalid zone letter: '+t)}};function y(t,e,a){if(!(this instanceof y)){return new y(t,e,a)};if(Array.isArray(t)){this.x=t[0];this.y=t[1];this.z=t[2]||0.0}
else if(typeof t==='object'){this.x=t.x;this.y=t.y;this.z=t.z||0.0}
else if(typeof t==='string'&&typeof e==='undefined'){var i=t.split(',');this.x=parseFloat(i[0],10);this.y=parseFloat(i[1],10);this.z=parseFloat(i[2],10)||0.0}
else{this.x=t;this.y=e;this.z=a||0.0};console.warn('proj4.Point will be removed in version 3, use proj4.toPoint')};y.fromMGRS=function(t){return new y(Mt(t))};y.prototype.toMGRS=function(t){return pt([this.x,this.y],t)};var Qt='2.4.4-alpha';function ta(){var i=this.lat0;this.lambda0=this.long0;var e=Math.sin(i),o=this.a,l=this.rf,r=1/l,t=2*r-Math.pow(r,2),a=this.e=Math.sqrt(t);this.R=this.k0*o*Math.sqrt(1-t)/(1-t*Math.pow(e,2));this.alpha=Math.sqrt(1+t/(1-t)*Math.pow(Math.cos(i),4));this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),n=Math.log(Math.tan(Math.PI/4+i/2)),h=Math.log((1+a*e)/(1-a*e));this.K=s-this.alpha*n+this.alpha*a/2*h};function ea(t){var r=Math.log(Math.tan(Math.PI/4-t.y/2)),s=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(r+s)+this.K,e=2*(Math.atan(Math.exp(n))-Math.PI/4),a=this.alpha*(t.x-this.lambda0),h=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(a))),i=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(a));t.y=this.R/2*Math.log((1+Math.sin(i))/(1-Math.sin(i)))+this.y0;t.x=this.R*h+this.x0;return t};function aa(t){var h=t.x-this.x0,o=t.y-this.y0,a=h/this.R,i=2*(Math.atan(Math.exp(o/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(a)),l=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(i))),u=this.lambda0+l/this.alpha,s=0,e=r,n=-1000,f=0;while(Math.abs(e-n)>0.0000001){if(++f>20){return};s=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(e))/2));n=e;e=2*Math.atan(Math.exp(s))-Math.PI/2};t.x=u;t.y=e;return t};var Zt=['somerc'],Kt={init:ta,forward:ea,inverse:aa,names:Zt};var zt=1,Tt=0.25,B=0.046875,Z=0.01953125,K=0.01068115234375,jt=0.75,Dt=0.46875,Lt=0.01302083333333333333,Ut=0.00712076822916666666,Ft=0.36458333333333333333,qt=0.00569661458333333333,Wt=0.3076171875,Jt=function(t){var e=[];e[0]=zt-t*(Tt+t*(B+t*(Z+t*K)));e[1]=t*(jt-t*(B+t*(Z+t*K)));var a=t*t;e[2]=a*(Dt-t*(Lt+t*Ut));a*=t;e[3]=a*(Ft-t*qt);e[4]=a*t*Wt;return e},z=function(t,e,a,i){a*=e;e*=e;return(i[0]*t-a*(i[1]+e*(i[2]+e*(i[3]+e*i[4]))))},Ht=20,Bt=function(t,e,a){var h=1/(1-e),i=t;for(var n=Ht;n;--n){var s=Math.sin(i),r=1-e*s*s;r=(z(i,s,Math.cos(i),a)-t)*(r*Math.sqrt(r))*h;i-=r;if(Math.abs(r)<o){return i}};return i};function ia(){this.x0=this.x0!==undefined?this.x0:0;this.y0=this.y0!==undefined?this.y0:0;this.long0=this.long0!==undefined?this.long0:0;this.lat0=this.lat0!==undefined?this.lat0:0;if(this.es){this.en=Jt(this.es);this.ml0=z(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en)}};function ra(t){var y=t.x,f=t.y,c=u(y-this.long0),p,m,a,d=Math.sin(f),h=Math.cos(f);if(!this.es){var r=h*Math.sin(c);if((Math.abs(Math.abs(r)-1))<o){return(93)}
else{m=0.5*this.a*this.k0*Math.log((1+r)/(1-r))+this.x0;a=h*Math.cos(c)/Math.sqrt(1-Math.pow(r,2));r=Math.abs(a);if(r>=1){if((r-1)>o){return(93)}
else{a=0}}
else{a=Math.acos(a)};if(f<0){a=-a};a=this.a*this.k0*(a-this.lat0)+this.y0}}
else{var l=h*c,s=Math.pow(l,2),i=this.ep2*Math.pow(h,2),g=Math.pow(i,2),v=Math.abs(h)>o?Math.tan(f):0,e=Math.pow(v,2),n=Math.pow(e,2);p=1-this.es*Math.pow(d,2);l=l/Math.sqrt(p);var M=z(f,d,h,this.en);m=this.a*(this.k0*l*(1+s/6*(1-e+i+s/20*(5-18*e+n+14*i-58*e*i+s/42*(61+179*n-n*e-479*e)))))+this.x0;a=this.a*(this.k0*(M-this.ml0+d*c*l/2*(1+s/12*(5-e+9*i+4*g+s/30*(61+n-58*e+270*i-330*e*i+s/56*(1385+543*n-n*e-3111*e))))))+this.y0};t.x=m;t.y=a;return t};function sa(t){var i,h,l,f,y=(t.x-this.x0)*(1/this.a),c=(t.y-this.y0)*(1/this.a);if(!this.es){var v=Math.exp(y/this.k0),d=0.5*(v-1/v),S=this.lat0+c/this.k0,p=Math.cos(S);i=Math.sqrt((1-Math.pow(p,2))/(1+Math.pow(d,2)));l=Math.asin(i);if(c<0){l=-l};if((d===0)&&(p===0)){f=0}
else{f=u(Math.atan2(d,p)+this.long0)}}
else{i=this.ml0+c/this.k0;h=Bt(i,this.es,this.en);if(Math.abs(h)<e){var b=Math.sin(h),m=Math.cos(h),g=Math.abs(m)>o?Math.tan(h):0,r=this.ep2*Math.pow(m,2),w=Math.pow(r,2),a=Math.pow(g,2),n=Math.pow(a,2);i=1-this.es*Math.pow(b,2);var M=y*Math.sqrt(i)/this.k0,s=Math.pow(M,2);i=i*g;l=h-(i*s/(1-this.es))*0.5*(1-s/12*(5+3*a-9*r*a+r-4*w-s/30*(61+90*a-252*r*a+45*n+46*r-s/56*(1385+3633*a+4095*n+1574*n*a))));f=u(this.long0+(M*(1-s/6*(1+2*a+r-s/20*(5+28*a+24*n+8*r*a+6*r-s/42*(61+662*a+1320*n+720*n*a))))/m))}
else{l=e*j(c);f=0}};t.x=f;t.y=l;return t};var Rt=['Transverse_Mercator','Transverse Mercator','tmerc'],Ot={init:ia,forward:ra,inverse:sa,names:Rt};var kt=function(t,e){if(t===undefined){t=Math.floor((u(e)+Math.PI)*30/Math.PI)+1;if(t<0){return 0}
else if(t>60){return 60}};return t},J=function(t){var e=Math.exp(t);e=(e-1/e)/2;return e},R=function(t,e){t=Math.abs(t);e=Math.abs(e);var a=Math.max(t,e),i=Math.min(t,e)/(a?a:1);return a*Math.sqrt(1+Math.pow(i,2))},Gt=function(t){var e=1+t,a=e-1;return a===0?t:t*Math.log(e)/a},Pt=function(t){var e=Math.abs(t);e=Gt(e*(1+e/(R(1,e)+1)));return t<0?-e:e},O=function(t,e){var n=2*Math.cos(2*e),a=t.length-1,i=t[a],s=0,r;while(--a>=0){r=-s+n*i+t[a];s=i;i=r};return(e+r*Math.sin(2*e))},At=function(t,e){var n=2*Math.cos(e),a=t.length-1,i=t[a],s=0,r;while(--a>=0){r=-s+n*i+t[a];s=i;i=r};return Math.sin(e)*r},It=function(t){var e=Math.exp(t);e=(e+1/e)/2;return e},H=function(t,e,a){var u=Math.sin(e),f=Math.cos(e),c=J(a),m=It(a),i=2*f*m,r=-2*u*c,l=t.length-1,s=t[l],n=0,h=0,o=0,d,p;while(--l>=0){d=h;p=n;h=s;n=o;s=-d+i*h-r*n+t[l];o=-p+r*h+i*n};i=u*m;r=f*c;return[i*s-r*o,i*o+r*s]};function na(){if(this.es===undefined||this.es<=0){throw new Error('incorrect elliptical usage')};this.x0=this.x0!==undefined?this.x0:0;this.y0=this.y0!==undefined?this.y0:0;this.long0=this.long0!==undefined?this.long0:0;this.lat0=this.lat0!==undefined?this.lat0:0;this.cgb=[];this.cbg=[];this.utg=[];this.gtu=[];var i=this.es/(1+Math.sqrt(1-this.es)),t=i/(2-i),e=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675))))));this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725))))));e=e*t;this.cgb[1]=e*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945)))));this.cbg[1]=e*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945)))));e=e*t;this.cgb[2]=e*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835))));this.cbg[2]=e*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835))));e=e*t;this.cgb[3]=e*(4279/630+t*(-332/35+t*(-399572/14175)));this.cbg[3]=e*(1237/630+t*(-12/5+t*(-24832/14175)));e=e*t;this.cgb[4]=e*(4174/315+t*(-144838/6237));this.cbg[4]=e*(-734/315+t*(109598/31185));e=e*t;this.cgb[5]=e*(601676/22275);this.cbg[5]=e*(444337/155925);e=Math.pow(t,2);this.Qn=this.k0/(1+t)*(1+e*(1/4+e*(1/64+e/256)));this.utg[0]=t*(-0.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800))))));this.gtu[0]=t*(0.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800))))));this.utg[1]=e*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720)))));this.gtu[1]=e*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360)))));e=e*t;this.utg[2]=e*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720))));this.gtu[2]=e*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440))));e=e*t;this.utg[3]=e*(-4397/161280+t*(11/504+t*(830251/7257600)));this.gtu[3]=e*(49561/161280+t*(-179/168+t*(6601661/7257600)));e=e*t;this.utg[4]=e*(-4583/161280+t*(108847/3991680));this.gtu[4]=e*(34729/80640+t*(-3418889/1995840));e=e*t;this.utg[5]=e*(-20648693/638668800);this.gtu[5]=e*(212378941/319334400);var a=O(this.cbg,this.lat0);this.Zb=-this.Qn*(a+At(this.gtu,2*a))};function ha(t){var e=u(t.x-this.long0),a=t.y;a=O(this.cbg,a);var h=Math.sin(a),s=Math.cos(a),l=Math.sin(e),o=Math.cos(e);a=Math.atan2(h,o*s);e=Math.atan2(l*s,R(h,s*o));e=Pt(Math.tan(e));var n=H(this.gtu,2*a,2*e);a=a+n[0];e=e+n[1];var i,r;if(Math.abs(e)<=2.623395162778){i=this.a*(this.Qn*e)+this.x0;r=this.a*(this.Qn*a+this.Zb)+this.y0}
else{i=Infinity;r=Infinity};t.x=i;t.y=r;return t};function oa(t){var e=(t.x-this.x0)*(1/this.a),a=(t.y-this.y0)*(1/this.a);a=(a-this.Zb)/this.Qn;e=e/this.Qn;var r,s;if(Math.abs(e)<=2.623395162778){var o=H(this.utg,2*a,2*e);a=a+o[0];e=e+o[1];e=Math.atan(J(e));var l=Math.sin(a),n=Math.cos(a),h=Math.sin(e),i=Math.cos(e);a=Math.atan2(l*i,R(h,i*n));e=Math.atan2(h,i*n);r=u(e+this.long0);s=O(this.cgb,a)}
else{r=Infinity;s=Infinity};t.x=r;t.y=s;return t};var Et=['Extended_Transverse_Mercator','Extended Transverse Mercator','etmerc'],I={init:na,forward:ha,inverse:oa,names:Et};var xt='etmerc';function la(){var t=kt(this.zone,this.long0);if(t===undefined){throw new Error('unknown utm zone')};this.lat0=0;this.long0=((6*Math.abs(t))-183)*r;this.x0=500000;this.y0=this.utmSouth?10000000:0;this.k0=0.9996;I.init.apply(this);this.forward=I.forward;this.inverse=I.inverse};var Ct=['Universal Transverse Mercator System','utm'],Nt={init:la,names:Ct,dependsOn:xt};function ua(){if(!this.lat2){this.lat2=this.lat1};if(!this.k0){this.k0=1};this.x0=this.x0||0;this.y0=this.y0||0;if(Math.abs(this.lat1+this.lat2)<o){return};var r=this.b/this.a;this.e=Math.sqrt(1-r*r);var t=Math.sin(this.lat1),s=Math.cos(this.lat1),e=T(this.e,t,s),a=S(this.e,this.lat1,t),i=Math.sin(this.lat2),n=Math.cos(this.lat2),h=T(this.e,i,n),l=S(this.e,this.lat2,i),u=S(this.e,this.lat0,Math.sin(this.lat0));if(Math.abs(this.lat1-this.lat2)>o){this.ns=Math.log(e/h)/Math.log(a/l)}
else{this.ns=t};if(isNaN(this.ns)){this.ns=t};this.f0=e/(this.ns*Math.pow(a,this.ns));this.rh=this.a*this.f0*Math.pow(u,this.ns);if(!this.title){this.title='Lambert Conformal Conic'}};function fa(t){var h=t.x,a=t.y;if(Math.abs(2*Math.abs(a)-Math.PI)<=o){a=j(a)*(e-2*o)};var r=Math.abs(Math.abs(a)-e),n,i;if(r>o){n=S(this.e,a,Math.sin(a));i=this.a*this.f0*Math.pow(n,this.ns)}
else{r=a*this.ns;if(r<=0){return null};i=0};var s=this.ns*u(h-this.long0);t.x=this.k0*(i*Math.sin(s))+this.x0;t.y=this.k0*(this.rh-i*Math.cos(s))+this.y0;return t};function ca(t){var i,a,o,n,l,r=(t.x-this.x0)/this.k0,s=(this.rh-(t.y-this.y0)/this.k0);if(this.ns>0){i=Math.sqrt(r*r+s*s);a=1}
else{i=-Math.sqrt(r*r+s*s);a=-1};var h=0;if(i!==0){h=Math.atan2((a*r),(a*s))};if((i!==0)||(this.ns>0)){a=1/this.ns;o=Math.pow((i/(this.a*this.f0)),a);n=it(this.e,o);if(n===-9999){return null}}
else{n=-e};l=u(h/this.ns+this.long0);t.x=l;t.y=n;return t};var wt=['Lambert Tangential Conformal Conic Projection','Lambert_Conformal_Conic','Lambert_Conformal_Conic_2SP','lcc'],St={init:ua,forward:fa,inverse:ca,names:wt};var bt=function(t){t.Proj.projections.add(Kt);t.Proj.projections.add(Ot);t.Proj.projections.add(Nt);t.Proj.projections.add(St)};l.defaultDatum='WGS84';l.Proj=f;l.WGS84=new l.Proj('WGS84');l.Point=y;l.toPoint=et;l.defs=n;l.transform=A;l.mgrs=Vt;l.version=Qt;bt(l);return l})));
(function(t){var e,i;if(typeof define==='function'&&define.amd){define(['leaflet','proj4'],t)}
else if(typeof module==='object'&&typeof module.exports==='object'){e=require('leaflet');i=require('proj4');module.exports=t(e,i)}
else{if(typeof window.L==='undefined'||typeof window.proj4==='undefined')throw'Leaflet and proj4 must be loaded first';t(window.L,window.proj4)}}(function(t,e){t.Proj={};t.Proj._isProj4Obj=function(t){return(typeof t.inverse!=='undefined'&&typeof t.forward!=='undefined')};t.Proj.Projection=t.Class.extend({initialize:function(e,i,o){var n=t.Proj._isProj4Obj(e);this._proj=n?e:this._projFromCodeDef(e,i);this.bounds=n?i:o},project:function(e){var i=this._proj.forward([e.lng,e.lat]);return new t.Point(i[0],i[1])},unproject:function(e,i){var o=this._proj.inverse([e.x,e.y]);return new t.LatLng(o[1],o[0],i)},_projFromCodeDef:function(t,i){if(i){e.defs(t,i)}
else if(e.defs[t]===undefined){var o=t.split(':');if(o.length>3){t=o[o.length-3]+':'+o[o.length-1]};if(e.defs[t]===undefined){throw'No projection definition for code '+t}};return e(t)}});t.Proj.CRS=t.Class.extend({includes:t.CRS,options:{transformation:new t.Transformation(1,0,-1,0)},initialize:function(e,i,o){var r,a,f,s;if(t.Proj._isProj4Obj(e)){a=e;r=a.srsCode;s=i||{};this.projection=new t.Proj.Projection(a,s.bounds)}
else{r=e;f=i;s=o||{};this.projection=new t.Proj.Projection(r,f,s.bounds)};t.Util.setOptions(this,s);this.code=r;this.transformation=this.options.transformation;if(this.options.origin){this.transformation=new t.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])};if(this.options.scales){this._scales=this.options.scales}
else if(this.options.resolutions){this._scales=[];for(var n=this.options.resolutions.length-1;n>=0;n--){if(this.options.resolutions[n]){this._scales[n]=1/this.options.resolutions[n]}}};this.infinite=!this.options.bounds},scale:function(t){var e=Math.floor(t),i,o,n,s;if(t===e){return this._scales[t]}
else{i=this._scales[e];o=this._scales[e+1];n=o-i;s=(t-e);return i+n*s}},zoom:function(t){var e=this._closestElement(this._scales,t),i=this._scales.indexOf(e),o,n,s;if(t===e){return i};n=i+1;o=this._scales[n];if(o===undefined){return Infinity};s=o-e;return(t-e)/s+i},distance:t.CRS.Earth.distance,R:t.CRS.Earth.R,_closestElement:function(t,e){var o;for(var i=t.length;i--;){if(t[i]<=e&&(o===undefined||o<t[i])){o=t[i]}};return o}});t.Proj.GeoJSON=t.GeoJSON.extend({initialize:function(e,i){this._callLevel=0;t.GeoJSON.prototype.initialize.call(this,e,i)},addData:function(e){var i;if(e){if(e.crs&&e.crs.type==='name'){i=new t.Proj.CRS(e.crs.properties.name)}
else if(e.crs&&e.crs.type){i=new t.Proj.CRS(e.crs.type+':'+e.crs.properties.code)};if(i!==undefined){this.options.coordsToLatLng=function(e){var o=t.point(e[0],e[1]);return i.projection.unproject(o)}}};this._callLevel++;try{t.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--;if(this._callLevel===0){delete this.options.coordsToLatLng}}}});t.Proj.geoJson=function(e,i){return new t.Proj.GeoJSON(e,i)};t.Proj.ImageOverlay=t.ImageOverlay.extend({initialize:function(e,i,o){t.ImageOverlay.prototype.initialize.call(this,e,null,o);this._projectedBounds=i},_animateZoom:function(e){var i=this._map.getZoomScale(e.zoom),o=t.point(this._projectedBounds.min.x,this._projectedBounds.max.y),n=this._projectedToNewLayerPoint(o,e.zoom,e.center);t.DomUtil.setTransform(this._image,n,i)},_reset:function(){var e=this._map.getZoom(),i=this._map.getPixelOrigin(),o=t.bounds(this._transform(this._projectedBounds.min,e)._subtract(i),this._transform(this._projectedBounds.max,e)._subtract(i)),n=o.getSize();t.DomUtil.setPosition(this._image,o.min);this._image.style.width=n.x+'px';this._image.style.height=n.y+'px'},_projectedToNewLayerPoint:function(t,e,i){var o=this._map.getSize()._divideBy(2),n=this._map.project(i,e)._subtract(o)._round(),s=n.add(this._map._getMapPanePos());return this._transform(t,e)._subtract(s)},_transform:function(t,e){var i=this._map.options.crs,o=i.transformation,n=i.scale(e);return o.transform(t,n)}});t.Proj.imageOverlay=function(e,i,o){return new t.Proj.ImageOverlay(e,i,o)};return t.Proj}));
;L.Map.addInitHook(function(){this.on('layeradd',function(t){if(t.layer.options){var e=t.layer.options.crs||L.CRS.EPSG3857;if(t.layer.options.tileSize&&this.options.crs!=e){var s=this.getBounds(),c=this.getCenter();this.options.crs=e;var a=s.getNorthWest(),r=s.getSouthEast(),h=this.getSize().distanceTo(L.point(0,0)),i=Infinity;for(z=0;z<this.getMaxZoom();z++){var n=this.project(r,z).distanceTo(this.project(a,z)),o=Math.abs(n-h);if(o<i){i=o;closestZoom=z}};this._resetView(c,closestZoom)}}},this)});
;L.CRS.EPSG21781=L.extend(new L.Proj.CRS('EPSG:21781','+proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +k_0=1 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs',{resolutions:[4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20,10,5,2.5,2,1.5,1,0.5,1/4,1/8,1/16],origin:[420000,350000]}),{bounds:L.bounds([5.97,45.83],[10.49,47.81]),name:'Coordonnées suisses',title:{lng:'X',lat:'Y'},distance:function(o,s){return L.CRS.Earth.distance(o,s)}});L.TileLayer.SwissTopo=L.TileLayer.extend({options:{subdomains:'56789',l:'ch.swisstopo.pixelkarte-farbe',f:'jpeg',crs:L.CRS.EPSG21781,minZoom:0,maxNativeZoom:L.CRS.EPSG21781.options.resolutions.length-1-3,maxZoom:L.CRS.EPSG21781.options.resolutions.length-1,attribution:'&copy; <a href="http://www.swisstopo.admin.ch/internet/swisstopo/fr/home.html">swisstopo, BAFU</a>'},initialize:function(o){L.TileLayer.prototype.initialize.call(this,'//wmts{s}.geo.admin.ch/1.0.0/{l}/default/current/21781/{z}/{y}/{x}.{f}',o)}});L.TileLayer.SwissTopo.Extended=L.TileLayer.SwissTopo.extend({_update:function(){if(this._map){this.options.l=this._map._zoom<24?'ch.swisstopo.pixelkarte-farbe':'ch.swisstopo.landeskarte-farbe-10';this.options.f=this._map._zoom<24?'jpeg':'png'};L.TileLayer.prototype._update.call(this)}});
(function(e,t){if(typeof define==='function'&&define.amd){define(['leaflet','proj4leaflet'],t)}
else if(typeof exports==='object'){var n=require('leaflet');require('proj4leaflet');module.exports=t(n)}
else{if(typeof window.L==='undefined'){throw new Error('Leaflet missing')};e.returnExports=t(e.L)}}(this,function(e){e.OSOpenSpace=e.OSOpenSpace||{};e.OSOpenSpace.VERSION='1.0.0';e.OSOpenSpace.CRS=e.extend(new e.Proj.CRS('EPSG:27700','+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs',{resolutions:[2500,1000,500,200,100,50,25,10,5,2.5]}),{distance:function(t,n){return e.CRS.Earth.distance(t,n)}});e.OSOpenSpace.LogoControl=e.Control.extend({options:{position:'bottomleft'},onAdd:function(){var t=e.DomUtil.create('div','os-logo-control'),n=e.DomUtil.create('img','',t);n.title='Powered by OS OpenSpace';n.src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAA7CAMAAAD4p6zTAAAAdVBMVEUAAABDPYxDPY1AQI9EPY5EPoxEPY3///9EPY3z8/iWkr+KhrhzbqrEB1FnYaJbVZtQSZR+erGinsb00d7Fwtv78PTwwdTQz+PTRX3IF1zc2+ro5/Gtqs25ttTig6jaZJLtssn44OnLJmfpor7lk7PPNnLWVYfBOrQkAAAAB3RSTlMAUJ8Qv8+vnqzJJAAAAmNJREFUeAHl14Vi2zAUheHyuVds5nD6/o84211YcsHj/aVA85lBd0P3T/S1nu7vxh5fiIyIP58wRA+PA/FApsHXagw9DEtBhvHV2FC/LM/U4Os19Hx3RwZzMtQTAnMSAxFjTvE5QaRkg4lUARRqkgDLaC6BVHWOhBToeo9qS4adU4JIsCJrB8I5Em0EmM5HxMIJV7ORFhGlXWRaRDHVtWN2MkJNI9GwjYlrBx9RFE2sgFjZwrUy6kgpJQit6/+6DjDfFySOZStFYEFQWEbUCisb59imYKbxtVrKw1wwVFtY14QISGcN15TCSHSkXEdAZI1t+h83EtYaholwSxxqahzj4uy1gk9P2BYe4jOxFZhJ9P0vRN1K1RenjIvWu2WJbblIME1wa+mYbM6Ape7DbqP1ZjtFpJYuEoc5WVV6aLB6pcyChKDrTP0m6LcwttBVEiAk3eYGY11dEMir0k9I8uUYWOpLAknuJVLypwB9aHqjsqNAHZYfI2IKZbH+GGEpWIrXA5HkSZCoKZzE7kCUWleLzE/EFM4hPyN6ZOslJE3EOCf6tj5C0UTFNaFX84kqm03oxS0R0USM/TWx+ewWQVZeETq7IQoKF6Fvu78k8hsCjoJ1GFvnizAxvSSOceiMSD5zpMbwEbgl0JI/Ax/x6iFC29XVWCW3RO4l2JCnAiir/JoInDvBkf/sm1R6cUlUWYAAWkcXqQZD673ebLMTsUmmblGkOwMKHNpV/cwvF9lILLPpayqnQlkiFbUNzlst91onZVXu1n/mzcH8kcD88cj8UdGPGJvNHyH2PT7MHKfOHy1/Axgmj2KBwwXnAAAAAElFTkSuQmCC';return t}});e.OSOpenSpace.TileLayer=e.TileLayer.WMS.extend({initialize:function(t,n,o){if(!t){throw new Error('OSOpenSpace layer requires an API Key parameter to function.')};if(!n){n='file:///'};e.TileLayer.WMS.prototype.initialize.call(this,'https://openspace.ordnancesurvey.co.uk/osmapapi/ts',{crs:e.OSOpenSpace.CRS,maxZoom:14,minZoom:0,tileSize:200},o);this.wmsParams={KEY:t,FORMAT:'image/png',URL:n,REQUEST:'GetMap',WIDTH:this.options.tileSize,HEIGHT:this.options.tileSize}},getAttribution:function(){return'&copy; Crown copyright and database rights '+new Date().getFullYear()+' Ordnance Survey. <a target="_blank" href="https://www.ordnancesurvey.co.uk/web-services/os-openspace/developer-agreement.html" title="OS OpenSpace Terms of Use">Terms of Use</a>.'},onAdd:function(t){if(t.options.attributionControl){t.addControl(new e.OSOpenSpace.LogoControl())};e.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var n=this.options.crs.options.resolutions[t.z],o=this.options.tileSize*n,i=o*t.x,r=o*(-1-t.y);this.wmsParams.BBOX=[i,r,0,0].join(',');this.wmsParams.LAYERS=n;return this._url+e.Util.getParamString(this.wmsParams)}});e.OSOpenSpace.tilelayer=function(t,n,o){return new e.OSOpenSpace.TileLayer(t,n,o)};return e.OSOpenSpace}));
;L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:'Aerial',attribution:'Bing',culture:''},initialize:function(t,i){L.Util.setOptions(this,i);this._key=t;this._url=null;this._providers=[];this.metaRequested=!1},tile2quad:function(t,i,n){var o='';for(var r=n;r>0;r--){var e=0,a=1<<(r-1);if((t&a)!==0)e+=1;if((i&a)!==0)e+=2;o=o+e};return o},getTileUrl:function(t){var i=this._getZoomForUrl(),e=this.options.subdomains,r=this.options.subdomains[Math.abs((t.x+t.y)%e.length)];return this._url.replace('{subdomain}',r).replace('{quadkey}',this.tile2quad(t.x,t.y,i)).replace('{culture}',this.options.culture)},loadMetadata:function(){if(this.metaRequested)return;this.metaRequested=!0;var o=this,t='_bing_metadata_'+L.Util.stamp(this);window[t]=function(i){window[t]=undefined;var e=document.getElementById(t);e.parentNode.removeChild(e);if(i.errorDetails){throw new Error(i.errorDetails);return};o.initMetadata(i)};var e=(document.location.protocol==='file:')?'http':document.location.protocol.slice(0,-1),r=e+'://dev.virtualearth.net/REST/v1/Imagery/Metadata/'+this.options.type+'?include=ImageryProviders&jsonp='+t+'&key='+this._key+'&UriScheme='+e,i=document.createElement('script');i.type='text/javascript';i.src=r;i.id=t;document.getElementsByTagName('head')[0].appendChild(i)},initMetadata:function(t){var e=t.resourceSets[0].resources[0];this.options.subdomains=e.imageUrlSubdomains;this._url=e.imageUrl;if(e.imageryProviders){for(var n=0;n<e.imageryProviders.length;n++){var a=e.imageryProviders[n];for(var o=0;o<a.coverageAreas.length;o++){var i=a.coverageAreas[o],r={zoomMin:i.zoomMin,zoomMax:i.zoomMax,active:!1};var s=new L.LatLngBounds(new L.LatLng(i.bbox[0]+0.01,i.bbox[1]+0.01),new L.LatLng(i.bbox[2]-0.01,i.bbox[3]-0.01));r.bounds=s;r.attrib=a.attribution;this._providers.push(r)}}};this._update()},_update:function(){if(this._url===null||!this._map)return;this._update_attribution();L.TileLayer.prototype._update.apply(this,[])},_update_attribution:function(){var r=L.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap()),e=this._map.getZoom();for(var i=0;i<this._providers.length;i++){var t=this._providers[i];if((e<=t.zoomMax&&e>=t.zoomMin)&&r.intersects(t.bounds)){if(!t.active&&this._map.attributionControl)this._map.attributionControl.addAttribution(t.attrib);t.active=!0}
else{if(t.active&&this._map.attributionControl)this._map.attributionControl.removeAttribution(t.attrib);t.active=!1}}},onAdd:function(t){this.loadMetadata();L.TileLayer.prototype.onAdd.apply(this,[t])},onRemove:function(t){for(var e=0;e<this._providers.length;e++){var i=this._providers[e];if(i.active&&this._map.attributionControl){this._map.attributionControl.removeAttribution(i.attrib);i.active=!1}};L.TileLayer.prototype.onRemove.apply(this,[t])}});L.bingLayer=function(t,i){return new L.BingLayer(t,i)};
;L.TileLayer.collection=function(i){if(typeof this._col=='undefined'){this._col={'OSM-FR':new L.TileLayer.OSM.FR(),'Maps-refuges-info':new L.TileLayer.OSM.MRI(),'Hike & Bike':new L.TileLayer.OSM.hikebike()};var e=['Landscape','Outdoors','Cycle','Transport'];for(m in e)if(typeof L.TileLayer.OSM[e[m]]!='undefined')this._col['OSM-'+e[m]]=new L.TileLayer.OSM[e[m]]({k:key.thunderforest});if(typeof L.TileLayer.IGN!='undefined'&&typeof key!='undefined'&&typeof key.ign!='undefined')L.Util.extend(this._col,{'IGN':new L.TileLayer.IGN({k:key.ign,l:'GEOGRAPHICALGRIDSYSTEMS.MAPS'}),'IGN topo':new L.TileLayer.IGN({k:key.ign,l:'GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD'}),'IGN classique':new L.TileLayer.IGN({k:key.ign,l:'GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.CLASSIQUE'}),'IGN cadastre':new L.TileLayer.IGN({k:key.ign,l:'CADASTRALPARCELS.PARCELS',f:'png'}),'IGN photo':new L.TileLayer.IGN({k:key.ign,l:'ORTHOIMAGERY.ORTHOPHOTOS'})});if(typeof L.TileLayer.WMS.IDEE!='undefined')L.Util.extend(this._col,{'Espagne':new L.TileLayer.WMS.IDEE(),'Espagne photo':new L.TileLayer.WMS.IDEE.Photo()});if(typeof L.TileLayer.WMS.IGM!='undefined')this._col.Italie=new L.TileLayer.WMS.IGM();if(typeof L.TileLayer.SwissTopo!='undefined')L.Util.extend(this._col,{'SwissTopo':new L.TileLayer.SwissTopo.Extended(),'Swiss Image':new L.TileLayer.SwissTopo({l:'ch.swisstopo.swissimage'})});if(typeof L.TileLayer.Kompass!='undefined')L.Util.extend(this._col,{'Autriche':new L.TileLayer.Kompass({l:'Touristik'})});if(typeof key!='undefined'&&typeof key.os!='undefined'){if(window.location.href[4]!='s')if(typeof L.OSOpenSpace.TileLayer!='undefined'){L.OSOpenSpace.TileLayer.prototype.options.crs=L.OSOpenSpace.CRS;this._col['OS Great Britain']=new L.OSOpenSpace.TileLayer(key.os)}
else if(typeof L.TileLayer.OSOpenSpace!='undefined'){L.TileLayer.OSOpenSpace.prototype._url=L.TileLayer.OSOpenSpace.prototype._url.replace('https','http');this._col['OS-Great Britain']=new L.TileLayer.OSOpenSpace(key.os,{})}};if(typeof L.BingLayer!='undefined'&&typeof key!='undefined'&&typeof key.bing!='undefined'){L.BingLayer.prototype.options.maxNativeZoom=18;L.BingLayer.prototype.options.maxZoom=21;L.Util.extend(this._col,{'Bing Photo':new L.BingLayer(key.bing,{type:'Aerial'}),})};if(typeof L.TileLayer.Google!='undefined')L.Util.extend(this._col,{'Google Terrain':new L.TileLayer.Google({l:'p'}),'Google Photo':new L.TileLayer.Google({l:'s'})});L.Util.extend(this._col,{'Neutre':L.tileLayer('',{maxZoom:23})})};return typeof this._col[i]!='undefined'?this._col[i]:this._col};
;L.Control.Permalink=L.Control.extend({includes:L.Mixin.Events,options:{position:'bottomleft',useAnchor:!0,useLocation:!1,useLocalStorage:!1,text:'Permalink'},initialize:function(t){L.Util.setOptions(this,t);this._params={};this._set_urlvars();this.on('update',this._set_center,this);for(var i in this){if(typeof(i)==='string'&&i.indexOf('initialize_')===0)this[i]()}},onAdd:function(t){this._container=L.DomUtil.create('div','leaflet-control-attribution leaflet-control-permalink');L.DomEvent.disableClickPropagation(this._container);this._map=t;this._href=L.DomUtil.create('a',null,this._container);this._href.innerHTML=this.options.text;t.on('moveend',this._update_center,this);this.fire('update',{params:this._params});this._update_center();if(this.options.useAnchor&&'onhashchange' in window){var e=this,i=window.onhashchange;window.onhashchange=function(){e._set_urlvars();if(i)return i()}};this.fire('add',{map:t});return this._container},_update_center:function(){if(!this._map)return;var t=this._round_point(this._map.getCenter());this._update({zoom:String(this._map.getZoom()),lat:String(t.lat),lon:String(t.lng)})},_update_href:function(){var t=L.Util.getParamString(this._params),e='?';if(this.options.useAnchor)e='#';var i=this._url_base+e+t.slice(1);if(this._href)this._href.setAttribute('href',i);if(this.options.useLocation)location.replace('#'+t.slice(1));if(this.options.useLocalStorage)window.localStorage.setItem('paramsTemp',t.slice(1));return i},_round_point:function(t){var i=this._map.getBounds(),e=this._map.getSize(),n=i.getNorthEast(),r=i.getSouthWest(),a=function(t,i){if(i===0)return t;var e=1;while(i<1&&i>-1){t*=10;i*=10;e*=10};return Math.floor(t)/e};t.lat=a(t.lat,(n.lat-r.lat)/e.y);t.lng=a(t.lng,(n.lng-r.lng)/e.x);return t},_update:function(t){for(var i in t){if(!t.hasOwnProperty(i))continue;if(t[i]!==null&&t[i]!==undefined)this._params[i]=t[i];else delete this._params[i]};this._update_href()},_set_urlvars:function(){var t;if(this.options.useAnchor){t=L.UrlUtil.queryParse(L.UrlUtil.hash());this._url_base=window.location.href.split('#')[0]}
else{t=L.UrlUtil.queryParse(L.UrlUtil.query());this._url_base=window.location.href.split('#')[0].split('?')[0]};if(this.options.useLocalStorage){t=window.localStorage.getItem('paramsTemp');if(t!==null){t=L.UrlUtil.queryParse(t)}
else{t={}}};function i(t,i){for(var e in t)if(t.hasOwnProperty(e)&&t[e]!==i[e])return!1;return!0};if(i(t,this._params)&&i(this._params,t))return;this._params=t;this._update_href();this.fire('update',{params:this._params})},_set_center:function(t){var i=t.params;if(i.zoom===undefined||i.lat===undefined||i.lon===undefined)return;this._map.setView(new L.LatLng(i.lat,i.lon),i.zoom)}});L.UrlUtil={queryParse:function(t){var a={};var r='&';if(t.search('&amp;')!==-1)r='&amp;';var n=t.split(r);for(var e=0;e<n.length;e++){var i=n[e].split('=');if(i.length!==2)continue;a[i[0]]=decodeURIComponent(i[1])};return a},query:function(){var t=window.location.href.split('#')[0],i=t.indexOf('?');if(i<0)return'';return t.slice(i+1)},hash:function(){return window.location.hash.slice(1)},updateParamString:function(t,i){var n=L.UrlUtil.queryParse(t);for(var e in i){if(i.hasOwnProperty(e))n[e]=i[e]};return L.Util.getParamString(n).slice(1)}};
;L.Control.Permalink.include({initialize_layer:function(){this.on('update',this._set_layer,this);this.on('add',this._onadd_layer,this)},_onadd_layer:function(){this._map.on('layeradd',this._update_layer,this);this._map.on('layerremove',this._update_layer,this);this._update_layer()},_update_layer:function(){if(!this.options.layers)return;var a=this.options.layers.currentBaseLayer();if(a)this._update({layer:a.name})},_set_layer:function(a){var e=a.params;if(!this.options.layers||!e.layer)return;this.options.layers.chooseBaseLayer(e.layer)}});L.Control.Layers.include({chooseBaseLayer:function(r){var e,a;for(var t in this._layers){if(!this._layers.hasOwnProperty(t))continue;a=this._layers[t];if(!a.overlay&&a.name===r)e=a.layer};if(!e||this._map.hasLayer(e))return;for(var i in this._layers){if(!this._layers.hasOwnProperty(i))continue;a=this._layers[i];if(!a.overlay&&this._map.hasLayer(a.layer))this._map.removeLayer(a.layer)};this._map.addLayer(e);this._update()},currentBaseLayer:function(){for(var e in this._layers){if(!this._layers.hasOwnProperty(e))continue;var a=this._layers[e];if(a.overlay)continue;if(!a.overlay&&this._map.hasLayer(a.layer))return a}}});
;L.Control.Permalink.Cookies=L.Control.Permalink.extend({_pk:document.cookie.match(/permalink=([^;]+)/),options:{useAnchor:!1,move:!0,layer:!0},onAdd:function(t){if(this._pk&&!this._params.zoom)this._params=L.UrlUtil.queryParse(this._pk[1]);return L.Control.Permalink.prototype.onAdd.call(this,t)},_set_center:function(o){var t=o.params;if(t.zoom&&t.lat&&t.lon&&this.options.move)this._map.setView(new L.LatLng(t.lat,t.lon),t.zoom,{reset:!0})},_set_layer:function(t){if(this.options.layer)L.Control.Permalink.prototype._set_layer.call(this,t)},_update_href:function(){document.cookie='permalink='+L.Util.getParamString(this._params).substring(1)+';path=/';return L.Control.Permalink.prototype._update_href.call(this)}});
;L.NumberFormatter={round:function(t,n,a){var e=L.Util.formatNum(t,n)+"",r=e.split(".");if(r[1]){var i=n-r[1].length;for(;i>0;i--){r[1]+="0"};e=r.join(a||".")};return e},toDMS:function(n){var e=Math.floor(Math.abs(n)),a=(Math.abs(n)-e)*60,r=Math.floor(a),f=(a-r)*60,t=Math.round(f);if(t==60){r++;t="00"};if(r==60){e++;r="00"};if(t<10){t="0"+t};if(r<10){r="0"+r};var i="";if(n<0){i="-"};return(""+i+e+"&deg; "+r+"' "+t+"''")},createValidNumber:function(r,t){if(r&&r.length>0){var e=r.split(t||".");try{var n=Number(e.join("."));if(isNaN(n)){return undefined};return n}catch(i){return undefined}};return undefined}};
;L.Control.Coordinates=L.Control.extend({options:{position:'bottomright',decimals:4,decimalSeperator:'.',labelTemplateLat:'Lat: {y}',labelTemplateLng:'Lng: {x}',labelFormatterLat:undefined,labelFormatterLng:undefined,enableUserInput:!0,useDMS:!1,useLatLngOrder:!1,centerUserCoordinates:!1,markerType:L.marker,markerProps:{}},onAdd:function(t){this._map=t;var o='leaflet-control-coordinates',a=this._container=L.DomUtil.create('div',o),e=this.options;this._labelcontainer=L.DomUtil.create('div','uiElement label',a);this._label=L.DomUtil.create('span','labelFirst',this._labelcontainer);this._inputcontainer=L.DomUtil.create('div','uiElement input uiHidden',a);var i,n;if(e.useLatLngOrder){n=L.DomUtil.create('span','',this._inputcontainer);this._inputY=this._createInput('inputY',this._inputcontainer);i=L.DomUtil.create('span','',this._inputcontainer);this._inputX=this._createInput('inputX',this._inputcontainer)}
else{i=L.DomUtil.create('span','',this._inputcontainer);this._inputX=this._createInput('inputX',this._inputcontainer);n=L.DomUtil.create('span','',this._inputcontainer);this._inputY=this._createInput('inputY',this._inputcontainer)};i.innerHTML=e.labelTemplateLng.replace('{x}','');n.innerHTML=e.labelTemplateLat.replace('{y}','');L.DomEvent.on(this._inputX,'keyup',this._handleKeypress,this);L.DomEvent.on(this._inputY,'keyup',this._handleKeypress,this);t.on('mousemove',this._update,this);t.on('dragstart',this.collapse,this);t.whenReady(this._update,this);this._showsCoordinates=!0;if(e.enableUserInput){L.DomEvent.addListener(this._container,'click',this._switchUI,this)};return a},_createInput:function(t,i){var e=L.DomUtil.create('input',t,i);e.type='text';L.DomEvent.disableClickPropagation(e);return e},_clearMarker:function(){this._map.removeLayer(this._marker)},_handleKeypress:function(t){switch(t.keyCode){case 27:this.collapse();break;case 13:this._handleSubmit();this.collapse();break;default:this._handleSubmit();break}},_handleSubmit:function(){var i=L.NumberFormatter.createValidNumber(this._inputX.value,this.options.decimalSeperator),n=L.NumberFormatter.createValidNumber(this._inputY.value,this.options.decimalSeperator);if(i!==undefined&&n!==undefined){var t=this._marker;if(!t){t=this._marker=this._createNewMarker();t.on('click',this._clearMarker,this)};var e=new L.LatLng(n,i);t.setLatLng(e);t.addTo(this._map);if(this.options.centerUserCoordinates){this._map.setView(e,this._map.getZoom())}}},expand:function(){this._showsCoordinates=!1;this._map.off('mousemove',this._update,this);L.DomEvent.addListener(this._container,'mousemove',L.DomEvent.stop);L.DomEvent.removeListener(this._container,'click',this._switchUI,this);L.DomUtil.addClass(this._labelcontainer,'uiHidden');L.DomUtil.removeClass(this._inputcontainer,'uiHidden')},_createCoordinateLabel:function(t){var e=this.options,i,n;if(e.customLabelFcn){return e.customLabelFcn(t,e)};if(e.labelLng){i=e.labelFormatterLng(t.lng)}
else{i=L.Util.template(e.labelTemplateLng,{x:this._getNumber(t.lng,e)})};if(e.labelFormatterLat){n=e.labelFormatterLat(t.lat)}
else{n=L.Util.template(e.labelTemplateLat,{y:this._getNumber(t.lat,e)})};if(e.useLatLngOrder){return n+' '+i};return i+' '+n},_getNumber:function(t,e){var i;if(e.useDMS){i=L.NumberFormatter.toDMS(t)}
else{i=L.NumberFormatter.round(t,e.decimals,e.decimalSeperator)};return i},collapse:function(){if(!this._showsCoordinates){this._map.on('mousemove',this._update,this);this._showsCoordinates=!0;var r=this.options;L.DomEvent.addListener(this._container,'click',this._switchUI,this);L.DomEvent.removeListener(this._container,'mousemove',L.DomEvent.stop);L.DomUtil.addClass(this._inputcontainer,'uiHidden');L.DomUtil.removeClass(this._labelcontainer,'uiHidden');if(this._marker){var e=this._createNewMarker(),a=this._marker.getLatLng();e.setLatLng(a);var n=L.DomUtil.create('div',''),o=L.DomUtil.create('div','',n);o.innerHTML=this._ordinateLabel(a);var t=L.DomUtil.create('a','',n);t.innerHTML='Remove';t.href='#';var i=L.DomEvent.stopPropagation;L.DomEvent.on(t,'click',i).on(t,'mousedown',i).on(t,'dblclick',i).on(t,'click',L.DomEvent.preventDefault).on(t,'click',function(){this._map.removeLayer(e)},this);e.bindPopup(n);e.addTo(this._map);this._map.removeLayer(this._marker);this._marker=null}}},_switchUI:function(t){L.DomEvent.stop(t);L.DomEvent.stopPropagation(t);L.DomEvent.preventDefault(t);if(this._showsCoordinates){this.expand()}
else{this.collapse()}},onRemove:function(t){t.off('mousemove',this._update,this)},_update:function(t){var e=t.latlng,i=this.options;if(e){e=e.wrap();this._currentPos=e;this._inputY.value=L.NumberFormatter.round(e.lat,i.decimals,i.decimalSeperator);this._inputX.value=L.NumberFormatter.round(e.lng,i.decimals,i.decimalSeperator);this._label.innerHTML=this._createCoordinateLabel(e)}},_createNewMarker:function(){return this.options.markerType(null,this.options.markerProps)}});L.control.coordinates=function(t){return new L.Control.Coordinates(t)};L.Map.mergeOptions({coordinateControl:!1});L.Map.addInitHook(function(){if(this.options.coordinateControl){this.coordinateControl=new L.Control.Coordinates();this.addControl(this.coordinateControl)}});
;L.Control.Fullscreen=L.Control.extend({options:{position:'topleft',title:{'false':'View Fullscreen','true':'Exit Fullscreen'}},onAdd:function(e){var l=L.DomUtil.create('div','leaflet-control-fullscreen leaflet-bar leaflet-control');this.link=L.DomUtil.create('a','leaflet-control-fullscreen-button leaflet-bar-part',l);this.link.href='#';this._map=e;this._map.on('fullscreenchange',this._toggleTitle,this);this._toggleTitle();L.DomEvent.on(this.link,'click',this._click,this);return l},_click:function(e){L.DomEvent.stopPropagation(e);L.DomEvent.preventDefault(e);this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}});L.Map.include({isFullscreen:function(){return this._isFullscreen||!1},toggleFullscreen:function(l){var e=this.getContainer();if(this.isFullscreen()){if(l&&l.pseudoFullscreen){this._disablePseudoFullscreen(e)}
else if(document.exitFullscreen){document.exitFullscreen()}
else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}
else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}
else if(document.msExitFullscreen){document.msExitFullscreen()}
else{this._disablePseudoFullscreen(e)}}
else{if(l&&l.pseudoFullscreen){this._enablePseudoFullscreen(e)}
else if(e.requestFullscreen){e.requestFullscreen()}
else if(e.mozRequestFullScreen){e.mozRequestFullScreen()}
else if(e.webkitRequestFullscreen){e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}
else if(e.msRequestFullscreen){e.msRequestFullscreen()}
else{this._enablePseudoFullscreen(e)}}},_enablePseudoFullscreen:function(e){L.DomUtil.addClass(e,'leaflet-pseudo-fullscreen');this._setFullscreen(!0);this.fire('fullscreenchange')},_disablePseudoFullscreen:function(e){L.DomUtil.removeClass(e,'leaflet-pseudo-fullscreen');this._setFullscreen(!1);this.fire('fullscreenchange')},_setFullscreen:function(e){this._isFullscreen=e;var l=this.getContainer();if(e){L.DomUtil.addClass(l,'leaflet-fullscreen-on')}
else{L.DomUtil.removeClass(l,'leaflet-fullscreen-on')};this.invalidateSize()},_onFullscreenChange:function(e){var l=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(l===this.getContainer()&&!this._isFullscreen){this._setFullscreen(!0);this.fire('fullscreenchange')}
else if(l!==this.getContainer()&&this._isFullscreen){this._setFullscreen(!1);this.fire('fullscreenchange')}}});L.Map.mergeOptions({fullscreenControl:!1});L.Map.addInitHook(function(){if(this.options.fullscreenControl){this.fullscreenControl=new L.Control.Fullscreen(this.options.fullscreenControl);this.addControl(this.fullscreenControl)};var e;if('onfullscreenchange' in document){e='fullscreenchange'}
else if('onmozfullscreenchange' in document){e='mozfullscreenchange'}
else if('onwebkitfullscreenchange' in document){e='webkitfullscreenchange'}
else if('onmsfullscreenchange' in document){e='MSFullscreenChange'};if(e){var l=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,e,l)});this.on('unload',function(){L.DomEvent.off(document,e,l)})}});L.control.fullscreen=function(e){return new L.Control.Fullscreen(e)};
(function(t){if(typeof define==='function'&&define.amd){define(['leaflet'],t)}
else if(typeof module!=='undefined'){module.exports=t(require('leaflet'))}
else{if(typeof window.L==='undefined')throw'Leaflet must be loaded first';t(window.L)}})(function(t){t.Control.Gps=t.Control.extend({includes:t.Mixin.Events,options:{autoActive:!1,autoCenter:!1,maxZoom:null,textErr:null,callErr:null,style:{radius:5,weight:2,color:'#c20',opacity:1,fillColor:'#f23',fillOpacity:1},marker:null,accuracy:!0,title:'Center map on your location',position:'topleft',transform:function(t){return t},setView:!1},initialize:function(i){if(i&&i.style)i.style=t.Util.extend({},this.options.style,i.style);t.Util.setOptions(this,i);this._errorFunc=this.options.callErr||this.showAlert;this._isActive=!1;this._firstMoved=!1;this._currentLocation=null},onAdd:function(i){this._map=i;var o=t.DomUtil.create('div','leaflet-control-gps');this._button=t.DomUtil.create('a','gps-button',o);this._button.href='#';this._button.title=this.options.title;t.DomEvent.on(this._button,'click',t.DomEvent.stop,this).on(this._button,'click',this._switchGps,this);this._alert=t.DomUtil.create('div','gps-alert',o);this._alert.style.display='none';this._gpsMarker=this.options.marker?this.options.marker:new t.CircleMarker([0,0],this.options.style);this._map.on('locationfound',this._drawGps,this).on('locationerror',this._errorGps,this);if(this.options.autoActive)this.activate();return o},onRemove:function(t){this.deactivate()},_switchGps:function(){if(this._isActive)this.deactivate();else this.activate()},getLocation:function(){return this._currentLocation},activate:function(){this._isActive=!0;this._map.addLayer(this._gpsMarker);this._map.locate({enableHighAccuracy:!0,watch:!0,setView:this.options.setView,maxZoom:this.options.maxZoom})},deactivate:function(){this._isActive=!1;this._firstMoved=!1;this._map.stopLocate();t.DomUtil.removeClass(this._button,'active');this._map.removeLayer(this._gpsMarker);this.fire('gps:disabled')},_drawGps:function(i){this._currentLocation=this.options.transform(i.latlng);this._gpsMarker.setLatLng(this._currentLocation);if(this._isActive&&(!this._firstMoved||this.options.autoCenter))this._moveTo(this._currentLocation);this.fire('gps:located',{latlng:this._currentLocation,marker:this._gpsMarker});t.DomUtil.addClass(this._button,'active')},_moveTo:function(t){this._firstMoved=!0;if(this.options.maxZoom)this._map.setView(t,Math.min(this._map.getZoom(),this.options.maxZoom));else this._map.panTo(t)},_errorGps:function(t){this.deactivate();this._errorFunc.call(this,this.options.textErr||t.message)},showAlert:function(t){this._alert.style.display='block';this._alert.innerHTML=t;var i=this;clearTimeout(this.timerAlert);this.timerAlert=setTimeout(function(){i._alert.style.display='none'},5000)}});t.Map.addInitHook(function(){if(this.options.gpsControl){this.gpsControl=t.control.gps(this.options.gpsControl);this.addControl(this.gpsControl)}});t.control.gps=function(i){return new t.Control.Gps(i)};return t.Control.Gps});
;if(typeof console=="undefined"){this.console={log:function(e){}}};L.Control.OSMGeocoder=L.Control.extend({options:{collapsed:!0,position:"topright",text:"Locate",placeholder:"",bounds:null,email:null,callback:function(e){if(e.length==0){console.log("ERROR: didn't find a result");return};var t=e[0].boundingbox,o=new L.LatLng(t[0],t[2]),n=new L.LatLng(t[1],t[3]),i=new L.LatLngBounds([o,n]);this._map.fitBounds(i)}},_callbackId:0,initialize:function(e){L.Util.setOptions(this,e)},onAdd:function(e){this._map=e;var a="leaflet-control-geocoder",t=this._container=L.DomUtil.create("div",a);L.DomEvent.disableClickPropagation(t);var o=this._form=L.DomUtil.create("form",a+"-form"),s=this._input=document.createElement("input");s.type="text";s.placeholder=this.options.placeholder||"";var i=document.createElement("input");i.type="submit";i.value=this.options.text;o.appendChild(s);o.appendChild(i);L.DomEvent.addListener(o,"submit",this._geocode,this);if(this.options.collapsed){L.DomEvent.addListener(t,"mouseover",this._expand,this);L.DomEvent.addListener(t,"mouseout",this._collapse,this);var n=this._layersLink=L.DomUtil.create("a",a+"-toggle",t);n.href="#";n.title="Nominatim Geocoder";L.DomEvent.addListener(n,L.Browser.touch?"click":"focus",this._expand,this);this._map.on("movestart",this._collapse,this)}
else{this._expand()};t.appendChild(o);return t},_createSearchResult:function(e,o){var n=0.005,t=[];t[0]={};t[0]["boundingbox"]=[parseFloat(e)-n,parseFloat(e)+n,parseFloat(o)-n,parseFloat(o)+n];t[0]["class"]="boundary";t[0]["display_name"]="Position: "+e+" "+o;t[0]["lat"]=e;t[0]["lon"]=o;return t},_isLatLon:function(e){var o=/(-?\d+\.\d+)\s(-?\d+\.\d+)/,t=o.exec(e);if(t!=undefined)return t;o=/lat\D*(-?\d+\.\d+)\D*lon\D*(-?\d+\.\d+)/;t=o.exec(e);if(t!=undefined)return t;else return null},_isLatLon_decMin:function(e){console.log("is LatLon?: "+e);re=/([ns])\s*(\d+)\D*(\d+\.\d+).?\s*([ew])\s*(\d+)\D*(\d+\.\d+)/i;m=re.exec(e.toLowerCase());if((m!=undefined))return m;else return null},_geocode:function(t){L.DomEvent.preventDefault(t);var s=this._input.value;if(this._isLatLon(s)!=null){var e=this._isLatLon(s);console.log("LatLon: "+e[1]+" "+e[2]);this.options.callback.call(this,this._createSearchResult(e[1],e[2]));return}
else if(this._isLatLon_decMin(s)!=null){var e=this._isLatLon_decMin(s),o=[];o["n"]=1;o["s"]=-1;o["e"]=1;o["w"]=-1;this.options.callback.call(this,this._createSearchResult(o[e[1]]*(Number(e[2])+e[3]/60),o[e[4]]*(Number(e[5])+e[6]/60)));return};console.log(this._callbackId);window[("_l_osmgeocoder_"+this._callbackId)]=L.Util.bind(this.options.callback,this);var i={q:this._input.value,json_callback:("_l_osmgeocoder_"+this._callbackId++),format:"json"};if(this.options.bounds&&this.options.bounds!=null){if(this.options.bounds instanceof L.LatLngBounds){i.viewbox=this.options.bounds.toBBoxString();i.bounded=1}
else{console.log("bounds must be of type L.LatLngBounds");return}};if(this.options.email&&this.options.email!=null){if(typeof this.options.email=="string"){i.email=this.options.email}
else{console.log("email must be a string")}};var a=location.protocol;if(a=="file:")a="https:";var l=a+"//nominatim.openstreetmap.org/search"+L.Util.getParamString(i),n=document.createElement("script");n.type="text/javascript";n.src=l;n.id=this._callbackId;document.getElementsByTagName("head")[0].appendChild(n)},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-geocoder-expanded","")}});
;var toGeoJSON=(function(){'use strict';var d=/\s*/g,y=/^\s*|\s*$/g,v=/\s+/;function s(e){if(!e||!e.length)return 0;for(var r=0,t=0;r<e.length;r++){t=((t<<5)-t)+e.charCodeAt(r)|0};return t};function r(e,t){return e.getElementsByTagName(t)};function i(e,t){return e.getAttribute(t)};function l(e,t){return parseFloat(i(e,t))};function e(e,t){var i=r(e,t);return i.length?i[0]:null};function k(e){if(e.normalize){e.normalize()};return e};function f(e){for(var t=0,r=[];t<e.length;t++){r[t]=parseFloat(e[t])};return r};function t(e){if(e){k(e)};return(e&&e.textContent)||''};function a(r,i){var a={},o,n;for(n=0;n<i.length;n++){o=e(r,i[n]);if(o)a[i[n]]=t(o)};return a};function n(e,t){for(var r in t)e[r]=t[r]};function u(e){return f(e.replace(d,'').split(','))};function c(e){var r=e.replace(y,'').split(v),i=[];for(var t=0;t<r.length;t++){i.push(u(r[t]))};return i};function p(r){var n=[l(r,'lon'),l(r,'lat')],o=e(r,'ele'),a=e(r,'gpxtpx:hr')||e(r,'hr'),s=e(r,'time'),i;if(o){i=parseFloat(t(o));if(!isNaN(i)){n.push(i)}};return{coordinates:n,time:s?t(s):null,heartRate:a?parseFloat(t(a)):null}};function h(){return{type:'FeatureCollection',features:[]}};var o;if(typeof XMLSerializer!=='undefined'){o=new XMLSerializer()}
else if(typeof exports==='object'&&typeof process==='object'&&!process.browser){o=new(require('xmldom').XMLSerializer)()};function g(e){if(e.xml!==undefined)return e.xml;return o.serializeToString(e)};var m={kml:function(n){var x=h(),p={},L={},y={},o=['Polygon','LineString','Point','Track','gx:Track'],F=r(n,'Placemark'),v=r(n,'Style'),m=r(n,'StyleMap');for(var l=0;l<v.length;l++){var b=s(g(v[l])).toString(16);p['#'+i(v[l],'id')]=b;L[b]=v[l]};for(var a=0;a<m.length;a++){p['#'+i(m[a],'id')]=s(g(m[a])).toString(16);var T=r(m[a],'Pair'),N={};for(var d=0;d<T.length;d++){N[t(e(T[d],'key'))]=t(e(T[d],'styleUrl'))};y['#'+i(m[a],'id')]=N};for(var S=0;S<F.length;S++){x.features=x.features.concat(R(F[S]))};function M(e){var t,r;e=e||'';if(e.substr(0,1)==='#'){e=e.substr(1)};if(e.length===6||e.length===3){t=e};if(e.length===8){r=parseInt(e.substr(0,2),16)/255;t='#'+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)};return[t,isNaN(r)?undefined:r]};function P(e){return f(e.split(' '))};function w(e){var i=r(e,'coord','gx'),s=[],l=[];if(i.length===0)i=r(e,'gx:coord');for(var o=0;o<i.length;o++)s.push(P(t(i[o])));var a=r(e,'when');for(var n=0;n<a.length;n++)l.push(t(a[n]));return{coords:s,times:l}};function k(i){var a,l,n,f,p,s=[],d=[];if(e(i,'MultiGeometry')){return k(e(i,'MultiGeometry'))};if(e(i,'MultiTrack')){return k(e(i,'MultiTrack'))};if(e(i,'gx:MultiTrack')){return k(e(i,'gx:MultiTrack'))};for(n=0;n<o.length;n++){l=r(i,o[n]);if(l){for(f=0;f<l.length;f++){a=l[f];if(o[n]==='Point'){s.push({type:'Point',coordinates:u(t(e(a,'coordinates')))})}
else if(o[n]==='LineString'){s.push({type:'LineString',coordinates:c(t(e(a,'coordinates')))})}
else if(o[n]==='Polygon'){var g=r(a,'LinearRing'),m=[];for(p=0;p<g.length;p++){m.push(c(t(e(g[p],'coordinates'))))};s.push({type:'Polygon',coordinates:m})}
else if(o[n]==='Track'||o[n]==='gx:Track'){var h=w(a);s.push({type:'LineString',coordinates:h.coords});if(h.times.length)d.push(h.times)}}}};return{geoms:s,coordTimes:d}};function R(n){var l=k(n),a,o={},z=t(e(n,'name')),G=t(e(n,'address')),s=t(e(n,'styleUrl')),A=t(e(n,'description')),m=e(n,'TimeSpan'),C=e(n,'TimeStamp'),d=e(n,'ExtendedData'),u=e(n,'LineStyle'),f=e(n,'PolyStyle'),H=e(n,'visibility');if(!l.geoms.length)return[];if(z)o.name=z;if(G)o.address=G;if(s){if(s[0]!=='#'){s='#'+s};o.styleUrl=s;if(p[s]){o.styleHash=p[s]};if(y[s]){o.styleMapHash=y[s];o.styleHash=p[y[s].normal]};var g=L[o.styleHash];if(g){if(!u)u=e(g,'LineStyle');if(!f)f=e(g,'PolyStyle')}};if(A)o.description=A;if(m){var D=t(e(m,'begin')),U=t(e(m,'end'));o.timespan={begin:D,end:U}};if(C){o.timestamp=t(e(C,'when'))};if(u){var F=M(t(e(u,'color'))),P=F[0],w=F[1],R=parseFloat(t(e(u,'width')));if(P)o.stroke=P;if(!isNaN(w))o['stroke-opacity']=w;if(!isNaN(R))o['stroke-width']=R};if(f){var S=M(t(e(f,'color'))),T=S[0],x=S[1],N=t(e(f,'fill')),b=t(e(f,'outline'));if(T)o.fill=T;if(!isNaN(x))o['fill-opacity']=x;if(N)o['fill-opacity']=N==='1'?o['fill-opacity']||1:0;if(b)o['stroke-opacity']=b==='1'?o['stroke-opacity']||1:0};if(d){var c=r(d,'Data'),h=r(d,'SimpleData');for(a=0;a<c.length;a++){o[c[a].getAttribute('name')]=t(e(c[a],'value'))};for(a=0;a<h.length;a++){o[h[a].getAttribute('name')]=t(h[a])}};if(H){o.visibility=t(H)};if(l.coordTimes.length){o.coordTimes=(l.coordTimes.length===1)?l.coordTimes[0]:l.coordTimes};var v={type:'Feature',geometry:(l.geoms.length===1)?l.geoms[0]:{type:'GeometryCollection',geometries:l.geoms},properties:o};if(i(n,'id'))v.id=i(n,'id');return[v]};return x},gpx:function(o){var s,c=r(o,'trk'),g=r(o,'rte'),m=r(o,'wpt'),f=h(),l;for(s=0;s<c.length;s++){l=v(c[s]);if(l)f.features.push(l)};for(s=0;s<g.length;s++){l=k(g[s]);if(l)f.features.push(l)};for(s=0;s<m.length;s++){f.features.push(S(m[s]))};function d(e,t){var o=r(e,t),a=[],s=[],l=[],f=o.length;if(f<2)return{};for(var n=0;n<f;n++){var i=p(o[n]);a.push(i.coordinates);if(i.time)s.push(i.time);if(i.heartRate)l.push(i.heartRate)};return{line:a,times:s,heartRates:l}};function v(t){var c=r(t,'trkseg'),o=[],s=[],l=[],i;for(var f=0;f<c.length;f++){i=d(c[f],'trkpt');if(i){if(i.line)o.push(i.line);if(i.times&&i.times.length)s.push(i.times);if(i.heartRates&&i.heartRates.length)l.push(i.heartRates)}};if(o.length===0)return;var a=u(t);n(a,y(e(t,'extensions')));if(s.length)a.coordTimes=o.length===1?s[0]:s;if(l.length)a.heartRates=o.length===1?l[0]:l;return{type:'Feature',properties:a,geometry:{type:o.length===1?'LineString':'MultiLineString',coordinates:o.length===1?o[0]:o}}};function k(t){var i=d(t,'rtept');if(!i.line)return;var r=u(t);n(r,y(e(t,'extensions')));var o={type:'Feature',properties:r,geometry:{type:'LineString',coordinates:i.line}};return o};function S(e){var t=u(e);n(t,a(e,['sym']));return{type:'Feature',properties:t,geometry:{type:'Point',coordinates:p(e).coordinates}}};function y(r){var n={};if(r){var i=e(r,'line');if(i){var o=t(e(i,'color')),a=parseFloat(t(e(i,'opacity'))),s=parseFloat(t(e(i,'width')));if(o)n.stroke=o;if(!isNaN(a))n['stroke-opacity']=a;if(!isNaN(s))n['stroke-width']=s*96/25.4}};return n};function u(e){var l=a(e,['name','cmt','desc','type','time','keywords']),o=r(e,'link');if(o.length)l.links=[];for(var t=0,s;t<o.length;t++){s={href:i(o[t],'href')};n(s,a(o[t],['text','type']));l.links.push(s)};return l};return f}};return m})();if(typeof module!=='undefined')module.exports=toGeoJSON;
(function(e,i){if(typeof define==='function'&&define.amd&&i.toGeoJSON){define(['leaflet'],function(t){e(t,i.toGeoJSON)})}
else if(typeof module==='object'&&module.exports){module.exports=function(t,o,r){if(o===undefined){if(typeof i!=='undefined'){o=require('leaflet')}
else{o=require('leaflet')(t)}};if(r===undefined){if(typeof i!=='undefined'){r=require('togeojson')}
else{r=require('togeojson')(t)}};e(o,r);return o}}
else if(typeof i!=='undefined'&&i.L&&i.toGeoJSON){e(i.L,i.toGeoJSON)}}(function(e,i){var o=e.Class.extend({includes:e.Mixin.Events,options:{layer:e.geoJson,layerOptions:{},fileSizeLimit:1024},initialize:function(i,t){this._map=i;e.Util.setOptions(this,t);this._parsers={geojson:this._loadGeoJSON,json:this._loadGeoJSON,gpx:this._convertToGeoJSON,kml:this._convertToGeoJSON}},load:function(i,t){var r,o;if(this._isParameterMissing(i,'file')){return!1};if(!this._isFileSizeOk(i.size)){return!1};o=this._getParser(i.name,t);if(!o){return!1};r=new FileReader();r.onload=e.Util.bind(function(e){var t;try{this.fire('data:loading',{filename:i.name,format:o.ext});t=o.processor.call(this,e.target.result,o.ext);this.fire('data:loaded',{layer:t,filename:i.name,format:o.ext})}catch(r){this.fire('data:error',{error:r})}},this);if(!i.testing){r.readAsText(i)};return r},loadData:function(e,i,o){var t,r;if((this._isParameterMissing(e,'data'))||(this._isParameterMissing(i,'name'))){return};if(!this._isFileSizeOk(e.length)){return};t=this._getParser(i,o);if(!t){return};try{this.fire('data:loading',{filename:i,format:t.ext});r=t.processor.call(this,e,t.ext);this.fire('data:loaded',{layer:r,filename:i,format:t.ext})}catch(n){this.fire('data:error',{error:n})}},_isParameterMissing:function(e,i){if(typeof e==='undefined'){this.fire('data:error',{error:new Error('Missing parameter: '+i)});return!0};return!1},_getParser:function(e,i){var t;i=i||e.split('.').pop();t=this._parsers[i];if(!t){this.fire('data:error',{error:new Error('Unsupported file type ('+i+')')});return undefined};return{processor:t,ext:i}},_isFileSizeOk:function(e){var i=(e/1024).toFixed(4);if(i>this.options.fileSizeLimit){this.fire('data:error',{error:new Error('File size exceeds limit ('+i+' > '+this.options.fileSizeLimit+'kb)')});return!1};return!0},_loadGeoJSON:function(e){var i;if(typeof e==='string'){e=JSON.parse(e)};i=this.options.layer(e,this.options.layerOptions);if(i.getLayers().length===0){throw new Error('GeoJSON has no valid layers.')};if(this.options.addToMap){i.addTo(this._map)};return i},_convertToGeoJSON:function(e,t){var o;if(typeof e==='string'){e=(new window.DOMParser()).parseFromString(e,'text/xml')};o=i[t](e);return this._loadGeoJSON(o)}});var t=e.Control.extend({statics:{TITLE:'Load local file (GPX, KML, GeoJSON)',LABEL:'&#8965;'},options:{position:'topleft',fitBounds:!0,layerOptions:{},addToMap:!0,fileSizeLimit:1024},initialize:function(i){e.Util.setOptions(this,i);this.loader=null},onAdd:function(i){this.loader=e.Util.fileLoader(i,this.options);this.loader.on('data:loaded',function(e){if(this.options.fitBounds){window.setTimeout(function(){i.fitBounds(e.layer.getBounds())},500)}},this);this._initDragAndDrop(i);return this._initContainer()},_initDragAndDrop:function(e){var i,o=this,r=e._container,t={dragenter:function(){e.scrollWheelZoom.disable()},dragleave:function(){e.scrollWheelZoom.enable()},dragover:function(e){e.stopPropagation();e.preventDefault()},drop:function(i){i.stopPropagation();i.preventDefault();o._loadFiles(i.dataTransfer.files);e.scrollWheelZoom.enable()}};for(i in t){if(t.hasOwnProperty(i)){r.addEventListener(i,t[i],!1)}}},_initContainer:function(){var a=this,i,r='leaflet-control-filelayer leaflet-control-zoom',n='leaflet-bar',s=n+'-part',o=e.DomUtil.create('div',r+' '+n),t=e.DomUtil.create('a',r+'-in '+s,o);t.innerHTML=e.Control.FileLayerLoad.LABEL;t.href='#';t.title=e.Control.FileLayerLoad.TITLE;i=e.DomUtil.create('input','hidden',o);i.type='file';i.multiple='multiple';if(!this.options.formats){i.accept='.gpx,.kml,.geojson'}
else{i.accept=this.options.formats.join(',')};i.style.display='none';i.addEventListener('change',function(){a._loadFiles(this.files);this.value=''},!1);e.DomEvent.disableClickPropagation(t);e.DomEvent.on(t,'click',function(e){i.click();e.preventDefault()});return o},_loadFiles:function(e){var i=this.loader;e=Array.prototype.slice.apply(e);setTimeout(function(){i.load(e.shift());if(e.length>0){setTimeout(arguments.callee,25)}},25)}});e.Util.FileLoader=o;e.Util.fileLoader=function(i,t){return new e.Util.FileLoader(i,t)};e.Control.FileLayerLoad=t;e.Control.fileLayerLoad=function(i){return new e.Control.FileLayerLoad(i)}},window));
;L.Control.Click=L.Control.extend({options:{position:'topleft',title:'Click to launch action',label:'X'},initialize:function(t,i){this._url=t;L.Util.setOptions(this,i)},onAdd:function(o){var i=L.DomUtil.create('div','leaflet-control-zoom leaflet-bar'),t=L.DomUtil.create('a','leaflet-control-zoom-in leaflet-bar-part',i);t.innerHTML=this.options.label;t.title=this.options.title;t.style.cursor='pointer';L.DomEvent.on(t,'click',function(){var i=typeof this._url=='function'?this._url():this._url;if(i)t.href=i},this);return i}});
;L.Control.EasyPrint=L.Control.extend({options:{title:'Print map',position:'topleft'},onAdd:function(){var t=L.DomUtil.create('div','leaflet-control-easyPrint leaflet-bar leaflet-control');this.link=L.DomUtil.create('a','leaflet-control-easyPrint-button leaflet-bar-part',t);this.link.id='leafletEasyPrint';this.link.title=this.options.title;L.DomEvent.addListener(this.link,'click',printPage,this);L.DomEvent.disableClickPropagation(t);return t}});L.easyPrint=function(t){addCSS();return new L.Control.EasyPrint(t)};function printPage(){if(this.options.elementsToHide){var i=document.querySelectorAll(this.options.elementsToHide);for(var t=0;t<i.length;t++){i[t].className=i[t].className+' _epHidden'}};this._map.fire('beforePrint');window.print();this._map.fire('afterPrint');if(this.options.elementsToHide){var i=document.querySelectorAll(this.options.elementsToHide);for(var t=0;t<i.length;t++){i[t].className=i[t].className.replace(' _epHidden','')}}};function addCSS(){var t=document.createElement('style');t.type='text/css';t.innerHTML='.leaflet-control-easyPrint a { 		background-image: url(data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxMiA1MTI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8cGF0aCBkPSJNMTI4LDMyaDI1NnY2NEgxMjhWMzJ6IE00ODAsMTI4SDMyYy0xNy42LDAtMzIsMTQuNC0zMiwzMnYxNjBjMCwxNy42LDE0LjM5OCwzMiwzMiwzMmg5NnYxMjhoMjU2VjM1Mmg5NiAgIGMxNy42LDAsMzItMTQuNCwzMi0zMlYxNjBDNTEyLDE0Mi40LDQ5Ny42LDEyOCw0ODAsMTI4eiBNMzUyLDQ0OEgxNjBWMjg4aDE5MlY0NDh6IE00ODcuMTk5LDE3NmMwLDEyLjgxMy0xMC4zODcsMjMuMi0yMy4xOTcsMjMuMiAgIGMtMTIuODEyLDAtMjMuMjAxLTEwLjM4Ny0yMy4yMDEtMjMuMnMxMC4zODktMjMuMiwyMy4xOTktMjMuMkM0NzYuODE0LDE1Mi44LDQ4Ny4xOTksMTYzLjE4Nyw0ODcuMTk5LDE3NnoiIGZpbGw9IiMwMDAwMDAiLz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8Zz4KPC9nPgo8L3N2Zz4K); 		background-size:16px 16px; 		cursor: pointer; 	} 	._epHidden{ 		display:none!important; 	} 	@media print { 		html {padding: 0px!important;} 		.leaflet-control-easyPrint-button{display: none!important;} 	}';document.body.appendChild(t)};
;L.Rrose=L.Popup.extend({_initLayout:function(){var t='leaflet-rrose',i=this._container=L.DomUtil.create('div',t+' '+this.options.className+' leaflet-zoom-animated'),n,o;if(this.options.closeButton){n=this._closeButton=L.DomUtil.create('a',t+'-close-button',i);n.href='#close';n.innerHTML='&#215;';L.DomEvent.on(n,'click',this._onCloseButtonClick,this)};var s=80,p=80;this.options.position='n';var a=p-this._map.latLngToContainerPoint(this._latlng).y;if(a>0){this.options.position='s'};var e=this._map.latLngToContainerPoint(this._latlng).x-(this._map.getSize().x-s);if(e>0){this.options.position+='w'}
else{e=s-this._map.latLngToContainerPoint(this._latlng).x;if(e>0){this.options.position+='e'}};if(/s/.test(this.options.position)){if(this.options.position==='s'){this._tipContainer=L.DomUtil.create('div',t+'-tip-container',i);o=this._wrapper=L.DomUtil.create('div',t+'-content-wrapper',i)}
else{this._tipContainer=L.DomUtil.create('div',t+'-tip-container '+t+'-tip-container-'+this.options.position,i);o=this._wrapper=L.DomUtil.create('div',t+'-content-wrapper '+t+'-content-wrapper-'+this.options.position,i)};this._tip=L.DomUtil.create('div',t+'-tip '+t+'-tip-'+this.options.position,this._tipContainer);L.DomEvent.disableClickPropagation(o);this._contentNode=L.DomUtil.create('div',t+'-content',o);L.DomEvent.on(this._contentNode,'mousewheel',L.DomEvent.stopPropagation)}
else{if(this.options.position==='n'){o=this._wrapper=L.DomUtil.create('div',t+'-content-wrapper',i);this._tipContainer=L.DomUtil.create('div',t+'-tip-container',i)}
else{o=this._wrapper=L.DomUtil.create('div',t+'-content-wrapper '+t+'-content-wrapper-'+this.options.position,i);this._tipContainer=L.DomUtil.create('div',t+'-tip-container '+t+'-tip-container-'+this.options.position,i)};L.DomEvent.disableClickPropagation(o);this._contentNode=L.DomUtil.create('div',t+'-content',o);L.DomEvent.on(this._contentNode,'mousewheel',L.DomEvent.stopPropagation);this._tip=L.DomUtil.create('div',t+'-tip '+t+'-tip-'+this.options.position,this._tipContainer)}},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng),i=L.Browser.any3d,o=this.options.offset;if(i){L.DomUtil.setPosition(this._container,t)};if(/s/.test(this.options.position)){this._containerBottom=-this._container.offsetHeight+o.y-(i?0:t.y)}
else{this._containerBottom=-o.y-(i?0:t.y)};if(/e/.test(this.options.position)){this._containerLeft=o.x+(i?0:t.x)}
else if(/w/.test(this.options.position)){this._containerLeft=-Math.round(this._containerWidth)+o.x+(i?0:t.x)}
else{this._containerLeft=-Math.round(this._containerWidth/2)+o.x+(i?0:t.x)};this._container.style.bottom=this._containerBottom+'px';this._container.style.left=this._containerLeft+'px'}});
;L.Marker.include({setStyle:function(t){L.setOptions(this,t);if(this._map){this._initIcon();this.update()};return this},});L.GeoJSON.Style=L.GeoJSON.extend({_setLayerStyle:function(o,e){var t=L.extend({popupAnchor:[0,-8],popupClass:'',popupValidity:100},o.feature.properties,typeof e=='function'?e.call(this,o.feature):e);if(t.iconUrl&&typeof o.setIcon=='function')o.setIcon(L.icon(t));function i(o){o=o.originalEvent||o;if(o.shiftKey||o.ctrlKey)window.open(t.url);else document.location.href=t.url};o.on('mouseover mousemove',function(o){if(t.popup){var e=new(L.Rrose||L.Popup)({offset:new L.Point(t.popupAnchor[0],t.popupAnchor[1]),className:t.popupClass,closeButton:!1,autoPan:!1});e.setContent(t.popup).setLatLng(o.latlng).openOn(this._map);if(t.url){e._container.style.cursor='pointer';e._container.addEventListener('click',i,!1)};this.popupLatlng=o.latlng}},this);if(this._map){if(t.popupValidity)this._map.on('mousemove',function(o){if(typeof this.popupLatlng=='object'){var e=this._map.latLngToLayerPoint(this.popupLatlng),i=Math.hypot(e.x-o.layerPoint.x,e.y-o.layerPoint.y);if(i>t.popupValidity)this._closePopup()}},this);else o.on('mouseout',this._closePopup,this);this._map.on('mouseout',this._closePopup,this)};if(t.url)o.on('click',i);o.on('mouseover',function(e){if(t.degroup)this._degroup(o,t.degroup)},this);if(typeof t.draggable=='function')o.on('dragstart drag dragend',t.draggable,this);L.GeoJSON.prototype._setLayerStyle.call(this,o,t)},_closePopup:function(){if(this._map)this._map.closePopup();delete this.popupLatlng},_degroup:function(o,i){var e=o._latlng;if(e){var a=this._map.latLngToLayerPoint(e);for(l in this._layers){var t=this._layers[l];if(!t._lli)t._lli=t._latlng;if(t._latlng&&o._leaflet_id!=t._leaflet_id){var p=this._map.latLngToLayerPoint(t._lli),n=p.distanceTo(a);if(!n)t.setLatLng(this._map.layerPointToLatLng(p.add([i,0])));else t.setLatLng(n>i?t._lli:[e.lat+(t._lli.lat-e.lat)*i/n,e.lng+(t._lli.lng-e.lng)*i/n])}}}}});
;L.GeoJSON.Ajax=L.GeoJSON.Style.extend({ajaxRequest:null,options:{urlGeoJSON:null,argsGeoJSON:{},idAjaxStatus:null},initialize:function(t,e){if(typeof t=='string')this.options.urlGeoJSON=t;else e=e||t;L.GeoJSON.Style.prototype.initialize.call(this,null,e);this.elAjaxStatus=document.getElementById(this.options.idAjaxStatus)||document.createElement('div');if(window.XMLHttpRequest)this.ajaxRequest=new XMLHttpRequest();else if(window.ActiveXObject)this.ajaxRequest=new ActiveXObject('Microsoft.XMLHTTP');else{return};this.ajaxRequest.context=this;this.ajaxRequest.onreadystatechange=this._onreadystatechange},onAdd:function(t){L.GeoJSON.Style.prototype.onAdd.call(this,t);this.reload();if(this.options.bbox)this._map.on('moveend',this.reload,this)},onRemove:function(t){this.elAjaxStatus.className='';this._map.off('moveend',this.reload,this);L.GeoJSON.Style.prototype.onRemove.call(this,t)},_getUrl:function(){var t=typeof this.options.argsGeoJSON=='function'?this.options.argsGeoJSON.call(this,this):this.options.argsGeoJSON;if(this.options.zoom&&this._map)t.zoom=this._map.getZoom();if(this.options.bbox&&this._map)t.bbox=this._map.getBounds().toBBoxString();return this.options.urlGeoJSON+L.Util.getParamString(t)},reload:function(){if(this.ajaxRequest){this.ajaxRequest.open('GET',this._getUrl(),!0);if(this.options.disabled){this.redraw();this.elAjaxStatus.className='ajax-none';return};if(this._map){var t=this._map.getBounds();if(t._northEast.lng-t._southWest.lng>this.options.maxLatAperture){this.elAjaxStatus.className='ajax-zoom';this.redraw();return}};this.ajaxRequest.send(null);this.elAjaxStatus.className='ajax-wait'}},_onreadystatechange:function(t){if(t.target.readyState<3);else if(t.target.status==200)t.target.context.redraw(t.target.responseText,t.target.status);else if(typeof t.target.context['error'+t.target.status]=='function')t.target.context['error'+t.target.status].call(t.target.context)},redraw:function(t,a){for(l in this._layers)if(this._map)this._map.removeLayer(this._layers[l]);this._layers=[];if(t){try{var e=JSON.parse(t)}catch(s){if(typeof a=='undefined'||a==4){this.elAjaxStatus.className='ajax-error'};return};e=this._tradJson.call(this,e);this.addData(e);if(this.elAjaxStatus.className=='ajax-wait')this.elAjaxStatus.className=e.length||(e.features&&e.features.length)?'ajax-some':'ajax-zero'}},_tradJson:function(t){return t}});
;L.Control.Layers.argsGeoJSON=L.Control.Layers.extend({_kl:document.cookie.match(/layerargs=([^;]+)/),_ac:window.location.search.match(/cookie=([^&]*)/),initialize:function(a,e,t){this.jsonLayer=a;for(i in e){e[i].on=function(){};e[i].options={}};L.Control.Layers.prototype.initialize.call(this,{},e,t)},onAdd:function(i){var o=L.Control.Layers.prototype.onAdd.call(this,i),l=this._ac?this._ac[1].split(','):this._kl?this._kl[1].split(','):[],r=null,a=this._form.getElementsByTagName('input');for(var e=0;e<a.length;e++){var t=this._getLayer(a[e].layerId);if(r&&r!=t.layer.p)a[e].parentElement.className='overlay-separator';r=t.layer.p;a[e].checked=l.indexOf(t.name)!=-1||!this._kl};this._onInputClick();return o},_onInputClick:function(){var o=[],t={},l={},r=this._form.getElementsByTagName('input');for(var a=0;a<this._layers.length;a++){var e=this._layers[a].layer;e.l.options.argsGeoJSON[e.p]='';t[e.l._leaflet_id]=e.l};for(var a=0;a<r.length;a++){var e=this._getLayer(r[a].layerId),i=e.layer.l.options.argsGeoJSON;if(r[a].checked){i[e.layer.p]+=(i[e.layer.p]?',':'')+e.layer.v;o.push(e.name)}};document.cookie='layerargs='+o.join(',')+';path=/';for(id in t)t[id].reload()}});
;L.GeoJSON.Ajax.OSM=L.GeoJSON.Ajax.extend({options:{urlGeoJSON:'//api.openstreetmap.fr/oapi/interpreter',bbox:!0,maxLatAperture:0.25,timeout:25,maxPoints:500,services:{},icons:{},language:{min:''},argsGeoJSON:function(){var t=document.getElementsByName('osm-categories[]');if(t.length){this.options.services={};for(var e=0;e<t.length;e++)if(t[e].checked)this.options.services[t[e].id]=t[e].value};this.options.disabled=!Object.keys(this.options.services).length;var a='[out:json][timeout:'+this.options.timeout+'];(\n',o=this._map.getBounds(),n=o._southWest.lat+','+o._southWest.lng+','+o._northEast.lat+','+o._northEast.lng;for(var i in this.options.services){var s=this.options.services[i]+'('+n+');\n';a+='node'+s+'way'+s};return{data:a+');out center;>;'}}},label:function(t){var e=t.tags;return{name:'<b>'+e.name+'</b>',description:[t.icon_name,'*'.repeat(e.stars),e.rooms?e.rooms+' rooms':'',e.place?e.place+' places':'',e.capacity?e.capacity+' places':'','<a href="http://www.openstreetmap.org/'+(t.center?'way':'node')+'/'+t.id+'">&copy;</a>'],phone:'<a href="tel:'+e.phone.replace(/[^0-9\+]+/ig,'')+'">'+e.phone+'</a>',email:'<a href="mailto:'+e.email+'">'+e.email+'</a>',address:[e['addr:housenumber'],e['addr:street'],e['addr:postcode'],e['addr:city']],website:'<a href="'+e.website+'>'+e.website+'</a>'}},_tradJson:function(a){if(a.remark)this.elAjaxStatus.className='ajax-zoom';var p=[];if(a.elements.length>this.options.maxPoints)this.elAjaxStatus.className='ajax-too';else for(var c in a.elements){var t=a.elements[c],e=t.tags,r=null;for(s in this.options.services)for(ti in e)if(this.options.services[s].indexOf(ti)!=-1&&e[ti]&&this.options.services[s].indexOf(e[ti])!=-1){t.icon_name=r=s;t.tag=e[ti]};if(!e.phone)e.phone=e['contact:phone']||'';delete e['contact:phone'];var o=typeof this.options.label=='function'?o=this.options.label(t,o):this.label(t),i=this.options.language,n=o.description.join(' ').replace(new RegExp(Object.keys(i).join('|'),'gi'),function(e){return i[e.toLowerCase()]}),l=[e.name?o.name:'',n.charAt(0).toUpperCase()+n.substr(1),e.ele?o.altitude:'',e.phone?o.phone:'',e.email?o.email:'',e['addr:street']?o.address.join(' '):'',e.website?o.website:'',e.ext1,e.ext2,e.ext3];if(t.center){t.lat=t.center.lat;t.lon=t.center.lon};if(t.type&&t.lon&&t.lat)p.push({type:'Feature',id:t.id,properties:{icon_name:r,popup:('<p>'+l.join('</p><p>')+'</p>').replace(/<p>\s*<\/p>/ig,'')},geometry:{type:'Point',coordinates:[t.lon,t.lat]}})};return p},error429:function(){this.elAjaxStatus.className='ajax-zoom'},error504:function(){this.elAjaxStatus.className='ajax-zoom'}});
;L.extend(L.CRS,{title:{lng:"Longitude",lat:"Latitude"},format:function(e){if(e<1000)return Math.round(e);var t=Math.floor(e/1000000),n=Math.floor((e-t*1000000)/1000),a=Math.round(e-t*1000000-n*1000);if(a>=1000){n++;a-=1000};if(n>=1000){t++;n-=1000};return(t===0?"":t+" ")+(t+n===0?"":(n<100?"0":"")+(n<10?"0":"")+n+" ")+(a<100?"0":"")+(a<10?"0":"")+a},unformat:function(e){if(!e)return 0;else return e.replace(/\s/g,"").replace(/,/g,".")}});L.CRS.decimal=L.extend({},L.CRS.EPSG4326,{name:"Degrés décimaux",format:function(e){return Math.round(e*100000)/100000}});L.CRS.degminsec=L.extend({},L.CRS.decimal,{name:"Deg Min Sec",format:function(e){var a=Math.floor(Math.abs(e)),r=(Math.abs(e)-a)*60,n=Math.floor(r),t=Math.round((r-n)*600)/10;if(t>=60){n++;t-=60};if(n>=60){a++;n-=60};return(e<0?"-":"")+a+"°"+(n<10?"0":"")+n+"'"+(t<10?"0":"")+t+"\""},unformat:function(e){va="0"+e.replace(/\s/g,"").replace(/,/g,".").replace(/-/g,"")+"°0°";vs=va.replace(/'|"/g,"°").split("°");return(e[0]=="-"?-1:1)*(parseFloat(vs[0])+parseFloat(0+vs[1])/60+parseFloat(0+vs[2])/3600)}});L.CRS.degmin=L.extend({},L.CRS.degminsec,{name:"Deg Min",format:function(e){var t=Math.floor(Math.abs(e)),n=Math.round((Math.abs(e)-t)*60*1000)/1000;if(n>=60){t++;n-=60};return(e<0?"-":"")+t+"°"+(n<10?"0":"")+n+"'"}});for(var u=28;u<=35;u++)L.CRS["EPSG326"+u]=L.extend(new L.Proj.CRS("EPSG:326"+u,"+proj=utm +zone="+u+" +ellps=WGS84 +datum=WGS84 +units=m +no_defs"),{bounds:L.bounds([6*u-186,0],[6*u-180,84]),name:"UTM "+u+"N"});L.CRS.EPSG32630.name+=" (France ouest)";L.CRS.EPSG32631.name+=" (France centre)";L.CRS.EPSG32632.name+=" (France est)";L.CRS.EPSG32633.name+=" (Autriche)";L.CRS.EPSG27571=L.extend(new L.Proj.CRS("EPSG:27571","+title=Lambert zone 1 , LCC +proj=lcc +lat_1=49.5 +lat_0=49.5 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),{bounds:L.bounds([-5.2,48.15],[8.23,51.1]),name:"Lambert I (Nord)"});L.CRS.EPSG27572=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS("EPSG:27572","+title=Lambert 2 étendue, LCC +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),{bounds:L.bounds([-5.2,42.25],[8.23,51.1]),name:"Lambert II (Centre)"});L.CRS.EPSG27573=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS("EPSG:27573","+title=Lambert zone 3, LCC +proj=lcc +lat_1=44.1 +lat_0=44.1 +lon_0=0 +k_0=0.999877499 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),{bounds:L.bounds([-1.76,42.33],[7.77,45.45]),name:"Lambert III (Sud)"});L.CRS.EPSG27574=L.extend({},L.CRS.EPSG27571,new L.Proj.CRS("EPSG:27574","+title=Lambert zone 4, +proj=lcc +lat_1=42.165 +lat_0=42.165 +lon_0=0 +k_0=0.99994471 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs"),{bounds:L.bounds([8.5,41.33],[9.6,43.05]),name:"Lambert IV (Corse)"});
;L.Marker.include({coordinates:function(o){this._elCoordinate=o;var t=document.getElementById(o+'-json');if(t){var n=t.innerHTML||t.value;if(n){var e=JSON.parse(n).coordinates;if(e)this.setLatLng([e[1],e[0]])}};this._displayCoord();this.on('move',this._displayCoord,this);return this},_displayCoord:function(){var r=this,t=r._latlng,a='decimal';if(!t)return;var e=document.getElementById(this._elCoordinate+'-select');if(e){if(e.value)a=e.value;while(e.hasChildNodes())e.removeChild(e.firstChild);for(c in L.CRS)if(L.CRS[c].name&&typeof L.CRS[c]=='object'&&(!L.CRS[c].bounds||L.CRS[c].bounds.contains([t.lng,t.lat]))){var i=document.createElement('option');i.value=c;if(c==a)i.selected='selected';i.appendChild(document.createTextNode(L.CRS[c].name));e.appendChild(i)};e.onchange=function(){r._displayCoord()}};var o=L.extend({},L.CRS,L.CRS[a]);var u=L.Projection.LonLat.unproject(o.projection.project(t));for(l in t){var s={title:o.title[l],deg:t[l],proj:o.format(u[l]),json:JSON.stringify(this.toGeoJSON().geometry)};for(v in s){var n=document.getElementById([this._elCoordinate,v,l].join('-'))||document.getElementById([this._elCoordinate,v].join('-'));if(n){var d=typeof n.value!='undefined'?'value':'innerHTML';n[d]=s[v];n.onchange=function(){var a={};for(l in t){var i=this.id.split('-');i[2]=l;var n=document.getElementById(i.join('-'));if(n)a[l]=o.unformat(n[d])};var e=o.projection.unproject(L.Projection.LonLat.project(a));r.setLatLng(e);r._map.panTo(e)}}}}}});
;L.drawVersion='0.4.2';L.Draw={};L.drawLocal={draw:{toolbar:{actions:{title:'Cancel drawing',text:'Cancel'},finish:{title:'Finish drawing',text:'Finish'},undo:{title:'Delete last point drawn',text:'Delete last point'},buttons:{polyline:'Draw a polyline',polygon:'Draw a polygon',rectangle:'Draw a rectangle',circle:'Draw a circle',marker:'Draw a marker'}},handlers:{circle:{tooltip:{start:'Click and drag to draw circle.'},radius:'Radius'},marker:{tooltip:{start:'Click map to place marker.'}},polygon:{tooltip:{start:'Click to start drawing shape.',cont:'Click to continue drawing shape.',end:'Click first point to close this shape.'}},polyline:{error:'<strong>Error:</strong> shape edges cannot cross!',tooltip:{start:'Click to start drawing line.',cont:'Click to continue drawing line.',end:'Click last point to finish line.'}},rectangle:{tooltip:{start:'Click and drag to draw rectangle.'}},simpleshape:{tooltip:{end:'Release mouse to finish drawing.'}}}},edit:{toolbar:{actions:{save:{title:'Save changes.',text:'Save'},cancel:{title:'Cancel editing, discards all changes.',text:'Cancel'},clearAll:{title:'clear all layers.',text:'Clear All'}},buttons:{edit:'Edit layers.',editDisabled:'No layers to edit.',remove:'Delete layers.',removeDisabled:'No layers to delete.'}},handlers:{edit:{tooltip:{text:'Drag handles, or marker to edit feature.',subtext:'Click cancel to undo changes.'}},remove:{tooltip:{text:'Click on a feature to remove'}}}}};
;L.Draw.Event={};L.Draw.Event.CREATED='draw:created';L.Draw.Event.EDITED='draw:edited';L.Draw.Event.DELETED='draw:deleted';L.Draw.Event.DRAWSTART='draw:drawstart';L.Draw.Event.DRAWSTOP='draw:drawstop';L.Draw.Event.DRAWVERTEX='draw:drawvertex';L.Draw.Event.EDITSTART='draw:editstart';L.Draw.Event.EDITMOVE='draw:editmove';L.Draw.Event.EDITRESIZE='draw:editresize';L.Draw.Event.EDITVERTEX='draw:editvertex';L.Draw.Event.EDITSTOP='draw:editstop';L.Draw.Event.DELETESTART='draw:deletestart';L.Draw.Event.DELETESTOP='draw:deletestop';
;L.Draw=L.Draw||{};L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(e,t){this._map=e;this._container=e._container;this._overlayPane=e._panes.overlayPane;this._popupPane=e._panes.popupPane;if(t&&t.shapeOptions){t.shapeOptions=L.Util.extend({},this.options.shapeOptions,t.shapeOptions)};L.setOptions(this,t)},enable:function(){if(this._enabled){return};L.Handler.prototype.enable.call(this);this.fire('enabled',{handler:this.type});this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type})},disable:function(){if(!this._enabled){return};L.Handler.prototype.disable.call(this);this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type});this.fire('disabled',{handler:this.type})},addHooks:function(){var e=this._map;if(e){L.DomUtil.disableTextSelection();e.getContainer().focus();this._tooltip=new L.Draw.Tooltip(this._map);L.DomEvent.on(this._container,'keyup',this._cancelDrawing,this)}},removeHooks:function(){if(this._map){L.DomUtil.enableTextSelection();this._tooltip.dispose();this._tooltip=null;L.DomEvent.off(this._container,'keyup',this._cancelDrawing,this)}},setOptions:function(e){L.setOptions(this,e)},_fireCreatedEvent:function(e){this._map.fire(L.Draw.Event.CREATED,{layer:e,layerType:this.type})},_cancelDrawing:function(e){this._map.fire('draw:canceled',{layerType:this.type});if(e.keyCode===27){this.disable()}}});
;L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:'polyline'},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:'#b00b00',timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon'}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:'leaflet-div-icon leaflet-editing-icon leaflet-touch-icon'}),guidelineDistance:20,maxGuideLineLength:4000,shapeOptions:{stroke:!0,color:'#3388ff',weight:4,opacity:0.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2000},initialize:function(t,i){if(L.Browser.touch){this.options.icon=this.options.touchIcon};this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error;if(i&&i.drawError){i.drawError=L.Util.extend({},this.options.drawError,i.drawError)};this.type=L.Draw.Polyline.TYPE;L.Draw.Feature.prototype.initialize.call(this,t,i)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);if(this._map){this._markers=[];this._markerGroup=new L.LayerGroup();this._map.addLayer(this._markerGroup);this._poly=new L.Polyline([],this.options.shapeOptions);this._tooltip.updateContent(this._getTooltipText());if(!this._mouseMarker){this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:'leaflet-mouse-marker',iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})};this._mouseMarker.on('mouseout',this._onMouseOut,this).on('mousemove',this._onMouseMove,this).on('mousedown',this._onMouseDown,this).on('mouseup',this._onMouseUp,this).addTo(this._map);this._map.on('mouseup',this._onMouseUp,this).on('mousemove',this._onMouseMove,this).on('zoomlevelschange',this._onZoomEnd,this).on('touchstart',this._onTouch,this).on('zoomend',this._onZoomEnd,this)}},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._mouseMarker.off('mousedown',this._onMouseDown,this).off('mouseout',this._onMouseOut,this).off('mouseup',this._onMouseUp,this).off('mousemove',this._onMouseMove,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._clearGuides();this._map.off('mouseup',this._onMouseUp,this).off('mousemove',this._onMouseMove,this).off('zoomlevelschange',this._onZoomEnd,this).off('zoomend',this._onZoomEnd,this).off('touchstart',this._onTouch,this).off('click',this._onTouch,this)},deleteLastVertex:function(){if(this._markers.length<=1){return};var e=this._markers.pop(),t=this._poly,i=t.getLatLngs(),o=i.splice(-1,1)[0];this._poly.setLatLngs(i);this._markerGroup.removeLayer(e);if(t.getLatLngs().length<2){this._map.removeLayer(t)};this._vertexChanged(o,!1)},addVertex:function(t){var i=this._markers.length;if(i>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)){this._showErrorTooltip();return}
else if(this._errorShown){this._hideErrorTooltip()};this._markers.push(this._createMarker(t));this._poly.addLatLng(t);if(this._poly.getLatLngs().length===2){this._map.addLayer(this._poly)};this._vertexChanged(t,!0)},completeShape:function(){if(this._markers.length<=1){return};this._fireCreatedEvent();this.disable();if(this.options.repeatMode){this.enable()}},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),i=this._poly.newLatLngIntersects(t[t.length-1]);if((!this.options.allowIntersection&&i)||!this._shapeIsValid()){this._showErrorTooltip();return};this._fireCreatedEvent();this.disable();if(this.options.repeatMode){this.enable()}},_shapeIsValid:function(){return!0},_onZoomEnd:function(){if(this._markers!==null){this._updateGuide()}},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i;this._updateTooltip(i);this._updateGuide(e);this._mouseMarker.setLatLng(i);L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,i){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup});this._updateFinishHandler();this._updateRunningMeasure(t,i);this._clearGuides();this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t);this._clickHandled=!0;this._disableNewMarkers();var i=t.originalEvent,e=i.clientX,o=i.clientY;this._startPoint.call(this,e,o)}},_startPoint:function(t,i){this._mouseDownOrigin=L.point(t,i)},_onMouseUp:function(t){var i=t.originalEvent,e=i.clientX,o=i.clientY;this._endPoint.call(this,e,o,t);this._clickHandled=null},_endPoint:function(t,i,e){if(this._mouseDownOrigin){var o=L.point(t,i).distanceTo(this._mouseDownOrigin),s=this._calculateFinishDistance(e.latlng);if(s<10&&L.Browser.touch){this._finishShape()}
else if(Math.abs(o)<9*(window.devicePixelRatio||1)){this.addVertex(e.latlng)};this._enableNewMarkers()};this._mouseDownOrigin=null},_onTouch:function(t){var i=t.originalEvent,e,o;if(i.touches&&i.touches[0]&&!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){e=i.touches[0].clientX;o=i.touches[0].clientY;this._disableNewMarkers();this._touchHandled=!0;this._startPoint.call(this,e,o);this._endPoint.call(this,e,o,t);this._touchHandled=null};this._clickHandled=null},_onMouseOut:function(){if(this._tooltip){this._tooltip._onMouseOut.call(this._tooltip)}},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE){i=this._markers[this._markers.length-1]}
else if(this.type===L.Draw.Polygon.TYPE){i=this._markers[0]}
else{return Infinity};var s=this._map.latLngToContainerPoint(i.getLatLng()),n=new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset*2});var o=this._map.latLngToContainerPoint(n.getLatLng());e=s.distanceTo(o)}
else{e=Infinity};return e},_updateFinishHandler:function(){var t=this._markers.length;if(t>1){this._markers[t-1].on('click',this._finishShape,this)};if(t>2){this._markers[t-2].off('click',this._finishShape,this)}},_createMarker:function(t){var i=new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset*2});this._markerGroup.addLayer(i);return i},_updateGuide:function(t){var i=this._markers?this._markers.length:0;if(i>0){t=t||this._map.latLngToLayerPoint(this._currentLatLng);this._clearGuides();this._drawGuide(this._map.latLngToLayerPoint(this._markers[i-1].getLatLng()),t)}},_updateTooltip:function(t){var i=this._getTooltipText();if(t){this._tooltip.updatePosition(t)};if(!this._errorShown){this._tooltip.updateContent(i)}},_drawGuide:function(t,i){var o=Math.floor(Math.sqrt(Math.pow((i.x-t.x),2)+Math.pow((i.y-t.y),2))),h=this.options.guidelineDistance,r=this.options.maxGuideLineLength,s=o>r?o-r:h,e,a,n;if(!this._guidesContainer){this._guidesContainer=L.DomUtil.create('div','leaflet-draw-guides',this._overlayPane)};for(;s<o;s+=this.options.guidelineDistance){e=s/o;a={x:Math.floor((t.x*(1-e))+(e*i.x)),y:Math.floor((t.y*(1-e))+(e*i.y))};n=L.DomUtil.create('div','leaflet-draw-guide-dash',this._guidesContainer);n.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color;L.DomUtil.setPosition(n,a)}},_updateGuideColor:function(t){if(this._guidesContainer){for(var i=0,e=this._guidesContainer.childNodes.length;i<e;i++){this._guidesContainer.childNodes[i].style.backgroundColor=t}}},_clearGuides:function(){if(this._guidesContainer){while(this._guidesContainer.firstChild){this._guidesContainer.removeChild(this._guidesContainer.firstChild)}}},_getTooltipText:function(){var e=this.options.showLength,t,i;if(L.Browser.touch){e=!1};if(this._markers.length===0){t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}}
else{i=e?this._getMeasurementString():'';if(this._markers.length===1){t={text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:i}}
else{t={text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:i}}};return t},_updateRunningMeasure:function(t,i){var s=this._markers.length,e,o;if(this._markers.length===1){this._measurementRunningTotal=0}
else{e=s-(i?2:1);o=t.distanceTo(this._markers[e].getLatLng());this._measurementRunningTotal+=o*(i?1:-1)}},_getMeasurementString:function(){var i=this._currentLatLng,e=this._markers[this._markers.length-1].getLatLng(),t;t=this._measurementRunningTotal+i.distanceTo(e);return L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic)},_showErrorTooltip:function(){this._errorShown=!0;this._tooltip.showAsError().updateContent({text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1;this._clearHideErrorTimeout();this._tooltip.removeError().updateContent(this._getTooltipText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){if(this._hideErrorTimeout){clearTimeout(this._hideErrorTimeout);this._hideErrorTimeout=null}},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){if(this._markers.length>1){this._markers[this._markers.length-1].off('click',this._finishShape,this)}},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}});
;L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:'polygon'},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:'#3388ff',weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0},metric:!0},initialize:function(i,t){L.Draw.Polyline.prototype.initialize.call(this,i,t);this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;if(i===1){this._markers[0].on('click',this._finishShape,this)};if(i>2){this._markers[i-1].on('dblclick',this._finishShape,this);if(i>3){this._markers[i-2].off('dblclick',this._finishShape,this)}}},_getTooltipText:function(){var i,t;if(this._markers.length===0){i=L.drawLocal.draw.handlers.polygon.tooltip.start}
else if(this._markers.length<3){i=L.drawLocal.draw.handlers.polygon.tooltip.cont}
else{i=L.drawLocal.draw.handlers.polygon.tooltip.end;t=this._getMeasurementString()};return{text:i,subtext:t}},_getMeasurementString:function(){var i=this._area;if(!i){return null};return L.GeometryUtil.readableArea(i,this.options.metric)},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,t){var e;if(!this.options.allowIntersection&&this.options.showArea){e=this._poly.getLatLngs();this._area=L.GeometryUtil.geodesicArea(e)};L.Draw.Polyline.prototype._vertexChanged.call(this,i,t)},_cleanUpShape:function(){var i=this._markers.length;if(i>0){this._markers[0].off('click',this._finishShape,this);if(i>2){this._markers[i-1].off('dblclick',this._finishShape,this)}}}});
;L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:'marker'},options:{icon:new L.Icon.Default(),repeatMode:!1,zIndexOffset:2000},initialize:function(t,e){this.type=L.Draw.Marker.TYPE;L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this);if(this._map){this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start});if(!this._mouseMarker){this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:'leaflet-mouse-marker',iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})};this._mouseMarker.on('click',this._onClick,this).addTo(this._map);this._map.on('mousemove',this._onMouseMove,this);this._map.on('click',this._onTouch,this)}},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this);if(this._map){if(this._marker){this._marker.off('click',this._onClick,this);this._map.off('click',this._onClick,this).off('click',this._onTouch,this).removeLayer(this._marker);delete this._marker};this._mouseMarker.off('click',this._onClick,this);this._map.removeLayer(this._mouseMarker);delete this._mouseMarker;this._map.off('mousemove',this._onMouseMove,this)}},_onMouseMove:function(e){var t=e.latlng;this._tooltip.updatePosition(t);this._mouseMarker.setLatLng(t);if(!this._marker){this._marker=new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset});this._marker.on('click',this._onClick,this);this._map.on('click',this._onClick,this).addLayer(this._marker)}
else{t=this._mouseMarker.getLatLng();this._marker.setLatLng(t)}},_onClick:function(){this._fireCreatedEvent();this.disable();if(this.options.repeatMode){this.enable()}},_onTouch:function(t){this._onMouseMove(t);this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}});
;L.Edit=L.Edit||{};L.Edit.Poly=L.Handler.extend({options:{},initialize:function(t,i){this.latlngs=[t._latlngs];if(t._holes){this.latlngs=this.latlngs.concat(t._holes)};this._poly=t;L.setOptions(this,i);this._poly.on('revert-edited',this._updateLatLngs,this)},_defaultShape:function(){if(!L.Polyline._flat){return this._poly._latlngs};return L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]},_eachVertexHandler:function(t){for(var i=0;i<this._verticesHandlers.length;i++){t(this._verticesHandlers[i])}},addHooks:function(){this._initHandlers();this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++){this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this.options))}},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs];if(t.layer._holes){this.latlngs=this.latlngs.concat(t.layer._holes)}}});L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:'leaflet-div-icon leaflet-editing-icon'}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:'leaflet-div-icon leaflet-editing-icon leaflet-touch-icon'}),drawError:{color:'#b00b00',timeout:1000}},initialize:function(t,i,e){if(L.Browser.touch){this.options.icon=this.options.touchIcon};this._poly=t;if(e&&e.drawError){e.drawError=L.Util.extend({},this.options.drawError,e.drawError)};this._latlngs=i;L.setOptions(this,e)},_defaultShape:function(){if(!L.Polyline._flat){return this._latlngs};return L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},addHooks:function(){var t=this._poly;if(!(t instanceof L.Polygon)){t.options.fill=!1;if(t.options.editing){t.options.editing.fill=!1}};t.setStyle(t.options.editing);if(this._poly._map){this._map=this._poly._map;if(!this._markerGroup){this._initMarkers()};this._poly._map.addLayer(this._markerGroup)}},removeHooks:function(){var t=this._poly;t.setStyle(t.options.original);if(t._map){t._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers}},updateMarkers:function(){this._markerGroup.clearLayers();this._initMarkers()},_initMarkers:function(){if(!this._markerGroup){this._markerGroup=new L.LayerGroup()};this._markers=[];var s=this._defaultShape(),t,o,i,n;for(t=0,i=s.length;t<i;t++){n=this._createMarker(s[t],t);n.on('click',this._onMarkerClick,this);this._markers.push(n)};var e,r;for(t=0,o=i-1;t<i;o=t++){if(t===0&&!(L.Polygon&&(this._poly instanceof L.Polygon))){continue};e=this._markers[o];r=this._markers[t];this._createMiddleMarker(e,r);this._updatePrevNext(e,r)}},_createMarker:function(t,i){var e=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon,});e._origLatLng=t;e._index=i;e.on('dragstart',this._onMarkerDragStart,this).on('drag',this._onMarkerDrag,this).on('dragend',this._fireEdit,this).on('touchmove',this._onTouchMove,this).on('touchend',this._fireEdit,this).on('MSPointerMove',this._onTouchMove,this).on('MSPointerUp',this._fireEdit,this);this._markerGroup.addLayer(e);return e},_onMarkerDragStart:function(){this._poly.fire('editstart')},_spliceLatLngs:function(){var t=this._defaultShape(),i=[].splice.apply(t,arguments);this._poly._convertLatLngs(t,!0);this._poly.redraw();return i},_removeMarker:function(t){var i=t._index;this._markerGroup.removeLayer(t);this._markers.splice(i,1);this._spliceLatLngs(i,1);this._updateIndexes(i,-1);t.off('dragstart',this._onMarkerDragStart,this).off('drag',this._onMarkerDrag,this).off('dragend',this._fireEdit,this).off('touchmove',this._onMarkerDrag,this).off('touchend',this._fireEdit,this).off('click',this._onMarkerClick,this).off('MSPointerMove',this._onTouchMove,this).off('MSPointerUp',this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0;this._poly.fire('edit');this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var i=t.target,e=this._poly;L.extend(i._origLatLng,i._latlng);if(i._middleLeft){i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i))};if(i._middleRight){i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next))};if(e.options.poly){var r=e._map._editTooltip;if(!e.options.poly.allowIntersection&&e.intersects()){var o=e.options.color;e.setStyle({color:this.options.drawError.color});if(L.version.indexOf('0.7')!==0){i.dragging._draggable._onUp(t)};this._onMarkerClick(t);if(r){r.updateContent({text:L.drawLocal.draw.handlers.polyline.error})};setTimeout(function(){e.setStyle({color:o});if(r){r.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})}},1000)}};this._poly.redraw();this._poly.fire('editdrag')},_onMarkerClick:function(t){var e=L.Polygon&&(this._poly instanceof L.Polygon)?4:3,i=t.target;if(this._defaultShape().length<e){return};this._removeMarker(i);this._updatePrevNext(i._prev,i._next);if(i._middleLeft){this._markerGroup.removeLayer(i._middleLeft)};if(i._middleRight){this._markerGroup.removeLayer(i._middleRight)};if(i._prev&&i._next){this._createMiddleMarker(i._prev,i._next)}
else if(!i._prev){i._next._middleLeft=null}
else if(!i._next){i._prev._middleRight=null};this._fireEdit()},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),r=this._map.layerPointToLatLng(e),i=t.target;L.extend(i._origLatLng,r);if(i._middleLeft){i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i))};if(i._middleRight){i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next))};this._poly.redraw();this.updateMarkers()},_updateIndexes:function(t,i){this._markerGroup.eachLayer(function(e){if(e._index>t){e._index+=i}})},_createMiddleMarker:function(t,e){var o=this._getMiddleLatLng(t,e),i=this._createMarker(o),s,r,n;i.setOpacity(0.6);t._middleRight=e._middleLeft=i;r=function(){i.off('touchmove',r,this);var n=e._index;i._index=n;i.off('click',s,this).on('click',this._onMarkerClick,this);o.lat=i.getLatLng().lat;o.lng=i.getLatLng().lng;this._spliceLatLngs(n,0,o);this._markers.splice(n,0,i);i.setOpacity(1);this._updateIndexes(n,1);e._index++;this._updatePrevNext(t,i);this._updatePrevNext(i,e);this._poly.fire('editstart')};n=function(){i.off('dragstart',r,this);i.off('dragend',n,this);i.off('touchmove',r,this);this._createMiddleMarker(t,i);this._createMiddleMarker(i,e)};s=function(){r.call(this);n.call(this);this._fireEdit()};i.on('click',s,this).on('dragstart',r,this).on('dragend',n,this).on('touchmove',r,this);this._markerGroup.addLayer(i)},_updatePrevNext:function(t,i){if(t){t._next=i};if(i){i._prev=t}},_getMiddleLatLng:function(t,i){var e=this._poly._map,r=e.project(t.getLatLng()),o=e.project(i.getLatLng());return e.unproject(r._add(o)._divideBy(2))}});L.Polyline.addInitHook(function(){if(this.editing){return};if(L.Edit.Poly){this.editing=new L.Edit.Poly(this,this.options.poly);if(this.options.editable){this.editing.enable()}};this.on('add',function(){if(this.editing&&this.editing.enabled()){this.editing.addHooks()}});this.on('remove',function(){if(this.editing&&this.editing.enabled()){this.editing.removeHooks()}})});
;L.Map.mergeOptions({touchExtend:!0});L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t;this._container=t._container;this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,'touchstart',this._onTouchStart,this);L.DomEvent.on(this._container,'touchend',this._onTouchEnd,this);L.DomEvent.on(this._container,'touchmove',this._onTouchMove,this);if(this._detectIE()){L.DomEvent.on(this._container,'MSPointerDown',this._onTouchStart,this);L.DomEvent.on(this._container,'MSPointerUp',this._onTouchEnd,this);L.DomEvent.on(this._container,'MSPointerMove',this._onTouchMove,this);L.DomEvent.on(this._container,'MSPointerCancel',this._onTouchCancel,this)}
else{L.DomEvent.on(this._container,'touchcancel',this._onTouchCancel,this);L.DomEvent.on(this._container,'touchleave',this._onTouchLeave,this)}},removeHooks:function(){L.DomEvent.off(this._container,'touchstart',this._onTouchStart);L.DomEvent.off(this._container,'touchend',this._onTouchEnd);L.DomEvent.off(this._container,'touchmove',this._onTouchMove);if(this._detectIE()){L.DomEvent.off(this._container,'MSPointerDowm',this._onTouchStart);L.DomEvent.off(this._container,'MSPointerUp',this._onTouchEnd);L.DomEvent.off(this._container,'MSPointerMove',this._onTouchMove);L.DomEvent.off(this._container,'MSPointerCancel',this._onTouchCancel)}
else{L.DomEvent.off(this._container,'touchcancel',this._onTouchCancel);L.DomEvent.off(this._container,'touchleave',this._onTouchLeave)}},_touchEvent:function(t,o){var n={};if(typeof t.touches!=='undefined'){if(!t.touches.length){return};n=t.touches[0]}
else if(t.pointerType==='touch'){n=t;if(!this._filterClick(t)){return}}
else{return};var i=this._map.mouseEventToContainerPoint(n),e=this._map.mouseEventToLayerPoint(n),r=this._map.layerPointToLatLng(e);this._map.fire(o,{latlng:r,layerPoint:e,containerPoint:i,pageX:n.pageX,pageY:n.pageY,originalEvent:t})},_filterClick:function(t){var e=(t.timeStamp||t.originalEvent.timeStamp),n=L.DomEvent._lastClick&&(e-L.DomEvent._lastClick);if((n&&n>100&&n<500)||(t.target._simulatedClick&&!t._simulated)){L.DomEvent.stop(t);return!1};L.DomEvent._lastClick=e;return!0},_onTouchStart:function(t){if(!this._map._loaded){return};var n='touchstart';this._touchEvent(t,n)},_onTouchEnd:function(t){if(!this._map._loaded){return};var n='touchend';this._touchEvent(t,n)},_onTouchCancel:function(t){if(!this._map._loaded){return};var n='touchcancel';if(this._detectIE()){n='pointercancel'};this._touchEvent(t,n)},_onTouchLeave:function(t){if(!this._map._loaded){return};var n='touchleave';this._touchEvent(t,n)},_onTouchMove:function(t){if(!this._map._loaded){return};var n='touchmove';this._touchEvent(t,n)},_detectIE:function(){var t=window.navigator.userAgent,e=t.indexOf('MSIE ');if(e>0){return parseInt(t.substring(e+5,t.indexOf('.',e)),10)};var i=t.indexOf('Trident/');if(i>0){var o=t.indexOf('rv:');return parseInt(t.substring(o+3,t.indexOf('.',o)),10)};var n=t.indexOf('Edge/');if(n>0){return parseInt(t.substring(n+5,t.indexOf('.',n)),10)};return!1}});L.Map.addInitHook('addHandler','touchExtend',L.Map.TouchExtend);L.Marker.Touch=L.Marker.extend({_initInteraction:function(){if(!this.addInteractiveTarget){return this._initInteractionLegacy()};return L.Marker.prototype._initInteraction.apply(this)},_initInteractionLegacy:function(){if(!this.options.clickable){return};var t=this._icon,n=['dblclick','mousedown','mouseover','mouseout','contextmenu','touchstart','touchend','touchmove'];if(this._detectIE){n.concat(['MSPointerDown','MSPointerUp','MSPointerMove','MSPointerCancel'])}
else{n.concat(['touchcancel'])};L.DomUtil.addClass(t,'leaflet-clickable');L.DomEvent.on(t,'click',this._onMouseClick,this);L.DomEvent.on(t,'keypress',this._onKeyPress,this);for(var e=0;e<n.length;e++){L.DomEvent.on(t,n[e],this._fireMouseEvent,this)};if(L.Handler.MarkerDrag){this.dragging=new L.Handler.MarkerDrag(this);if(this.options.draggable){this.dragging.enable()}}},_detectIE:function(){var t=window.navigator.userAgent,e=t.indexOf('MSIE ');if(e>0){return parseInt(t.substring(e+5,t.indexOf('.',e)),10)};var i=t.indexOf('Trident/');if(i>0){var o=t.indexOf('rv:');return parseInt(t.substring(o+3,t.indexOf('.',o)),10)};var n=t.indexOf('Edge/');if(n>0){return parseInt(t.substring(n+5,t.indexOf('.',n)),10)};return!1}});
;L.LatLngUtil={cloneLatLngs:function(n){var a=[];for(var t=0,l=n.length;t<l;t++){if(Array.isArray(n[t])){a.push(L.LatLngUtil.cloneLatLngs(n[t]))}
else{a.push(this.cloneLatLng(n[t]))}};return a},cloneLatLng:function(n){return L.latLng(n.lat,n.lng)}};
;L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(e){var a=e.length,r=0.0,i=Math.PI/180,m,l;if(a>2){for(var t=0;t<a;t++){m=e[t];l=e[(t+1)%a];r+=((l.lng-m.lng)*i)*(2+Math.sin(m.lat*i)+Math.sin(l.lat*i))};r=r*6378137.0*6378137.0/2.0};return Math.abs(r)},formattedNumber:function(t,m){var e=t.toFixed(m),o=L.drawLocal.format&&L.drawLocal.format.numeric,a=o&&o.delimiters,l=a&&a.thousands,i=a&&a.decimal;if(l||i){var r=e.split('.');e=l?r[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,'$1'+l):r[0];i=i||'.';if(r.length>1){e=e+i+r[1]}};return e},readableArea:function(e,r){var t;if(r){if(e>=10000){t=L.GeometryUtil.formattedNumber(e*0.0001,2)+' ha'}
else{t=L.GeometryUtil.formattedNumber(e,2)+' m&sup2;'}}
else{e/=0.836127;if(e>=3097600){t=L.GeometryUtil.formattedNumber(e/3097600,2)+' mi&sup2;'}
else if(e>=4840){t=L.GeometryUtil.formattedNumber(e/4840,2)+' acres'}
else{t=L.GeometryUtil.formattedNumber(Math.ceil(e))+' yd&sup2;'}};return t},readableDistance:function(e,a,i,m){var t,r;if(typeof a=='string'){r=a}
else{if(i){r='feet'}
else if(m){r='nauticalMile'}
else if(a){r='metric'}
else{r='yards'}};switch(r){case'metric':if(e>1000){t=L.GeometryUtil.formattedNumber(e/1000,2)+' km'}
else{t=L.GeometryUtil.formattedNumber(Math.ceil(e))+' m'};break;case'feet':e*=1.09361*3;t=L.GeometryUtil.formattedNumber(Math.ceil(e))+' ft';break;case'nauticalMile':e*=0.53996;t=L.GeometryUtil.formattedNumber(e/1000,2)+' nm';break;case'yards':default:e*=1.09361;if(e>1760){t=L.GeometryUtil.formattedNumber(e/1760,2)+' miles'}
else{t=L.GeometryUtil.formattedNumber(Math.ceil(e))+' yd'};break};return t}});
;L.Util.extend(L.LineUtil,{segmentsIntersect:function(e,c,t,n){return this._checkCounterclockwise(e,t,n)!==this._checkCounterclockwise(c,t,n)&&this._checkCounterclockwise(e,c,t)!==this._checkCounterclockwise(e,c,n)},_checkCounterclockwise:function(e,c,t){return(t.y-e.y)*(c.x-e.x)>(c.y-e.y)*(t.x-e.x)}});
;L.Polyline.include({intersects:function(){var e=this._getProjectedPoints(),i=e?e.length:0,t,n,r;if(this._tooFewPointsForIntersection()){return!1};for(t=i-1;t>=3;t--){n=e[t-1];r=e[t];if(this._lineSegmentsIntersectsRange(n,r,t-2)){return!0}};return!1},newLatLngIntersects:function(t,e){if(!this._map){return!1};return this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,n){var e=this._getProjectedPoints(),r=e?e.length:0,i=e?e[r-1]:null,s=r-2;if(this._tooFewPointsForIntersection(1)){return!1};return this._lineSegmentsIntersectsRange(i,t,s,n?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),n=e?e.length:0;n+=t||0;return!e||n<=3},_lineSegmentsIntersectsRange:function(t,n,a,r){var i=this._getProjectedPoints(),s,o;r=r||0;for(var e=a;e>r;e--){s=i[e-1];o=i[e];if(L.LineUtil.segmentsIntersect(t,n,s,o)){return!0}};return!1},_getProjectedPoints:function(){if(!this._defaultShape){return this._originalPoints};var e=[],n=this._defaultShape();for(var t=0;t<n.length;t++){e.push(this._map.latLngToLayerPoint(n[t]))};return e}});
;L.Control.Draw=L.Control.extend({options:{position:'topleft',draw:{},edit:!1},initialize:function(o){if(L.version<'0.7'){throw new Error('Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/')};L.Control.prototype.initialize.call(this,o);var t;this._toolbars={};if(L.DrawToolbar&&this.options.draw){t=new L.DrawToolbar(this.options.draw);this._toolbars[L.DrawToolbar.TYPE]=t;this._toolbars[L.DrawToolbar.TYPE].on('enable',this._toolbarEnabled,this)};if(L.EditToolbar&&this.options.edit){t=new L.EditToolbar(this.options.edit);this._toolbars[L.EditToolbar.TYPE]=t;this._toolbars[L.EditToolbar.TYPE].on('enable',this._toolbarEnabled,this)};L.toolbar=this},onAdd:function(t){var r=L.DomUtil.create('div','leaflet-draw'),a=!1,s='leaflet-draw-toolbar-top',o;for(var i in this._toolbars){if(this._toolbars.hasOwnProperty(i)){o=this._toolbars[i].addToolbar(t);if(o){if(!a){if(!L.DomUtil.hasClass(o,s)){L.DomUtil.addClass(o.childNodes[0],s)};a=!0};r.appendChild(o)}}};return r},onRemove:function(){for(var o in this._toolbars){if(this._toolbars.hasOwnProperty(o)){this._toolbars[o].removeToolbar()}}},setDrawingOptions:function(o){for(var t in this._toolbars){if(this._toolbars[t]instanceof L.DrawToolbar){this._toolbars[t].setOptions(o)}}},_toolbarEnabled:function(o){var i=o.target;for(var t in this._toolbars){if(this._toolbars[t]!==i){this._toolbars[t].disable()}}}});L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1});L.Map.addInitHook(function(){if(this.options.drawControl){this.drawControl=new L.Control.Draw();this.addControl(this.drawControl)}});
;L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t);this._modes={};this._actionButtons=[];this._activeMode=null},enabled:function(){return this._activeMode!==null},disable:function(){if(!this.enabled()){return};this._activeMode.handler.disable()},addToolbar:function(t){var i=L.DomUtil.create('div','leaflet-draw-section'),n=0,a=this._toolbarClass||'',e=this.getModeHandlers(t),o;this._toolbarContainer=L.DomUtil.create('div','leaflet-draw-toolbar leaflet-bar');this._map=t;for(o=0;o<e.length;o++){if(e[o].enabled){this._initModeHandler(e[o].handler,this._toolbarContainer,n++,a,e[o].title)}};if(!n){return};this._lastButtonIndex=--n;this._actionsContainer=L.DomUtil.create('ul','leaflet-draw-actions');i.appendChild(this._toolbarContainer);i.appendChild(this._actionsContainer);return i},removeToolbar:function(){for(var t in this._modes){if(this._modes.hasOwnProperty(t)){this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler);this._modes[t].handler.disable();this._modes[t].handler.off('enabled',this._handlerActivated,this).off('disabled',this._handlerDeactivated,this)}};this._modes={};for(var o=0,e=this._actionButtons.length;o<e;o++){this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback,this)};this._actionButtons=[];this._actionsContainer=null},_initModeHandler:function(o,e,i,n,a){var t=o.type;this._modes[t]={};this._modes[t].handler=o;this._modes[t].button=this._createButton({type:t,title:a,className:n+'-'+t,container:e,callback:this._modes[t].handler.enable,context:this._modes[t].handler});this._modes[t].buttonIndex=i;this._modes[t].handler.on('enabled',this._handlerActivated,this).on('disabled',this._handlerDeactivated,this)},_createButton:function(t){var o=L.DomUtil.create('a',t.className||'',t.container),e=L.DomUtil.create('span','sr-only',t.container);o.href='#';o.appendChild(e);if(t.title){o.title=t.title;e.innerHTML=t.title};if(t.text){o.innerHTML=t.text;e.innerHTML=t.text};L.DomEvent.on(o,'click',L.DomEvent.stopPropagation).on(o,'mousedown',L.DomEvent.stopPropagation).on(o,'dblclick',L.DomEvent.stopPropagation).on(o,'touchstart',L.DomEvent.stopPropagation).on(o,'click',L.DomEvent.preventDefault).on(o,'click',t.callback,t.context);return o},_disposeButton:function(t,o){L.DomEvent.off(t,'click',L.DomEvent.stopPropagation).off(t,'mousedown',L.DomEvent.stopPropagation).off(t,'dblclick',L.DomEvent.stopPropagation).off(t,'touchstart',L.DomEvent.stopPropagation).off(t,'click',L.DomEvent.preventDefault).off(t,'click',o)},_handlerActivated:function(t){this.disable();this._activeMode=this._modes[t.handler];L.DomUtil.addClass(this._activeMode.button,'leaflet-draw-toolbar-button-enabled');this._showActionsToolbar();this.fire('enable')},_handlerDeactivated:function(){this._hideActionsToolbar();L.DomUtil.removeClass(this._activeMode.button,'leaflet-draw-toolbar-button-enabled');this._activeMode=null;this.fire('disable')},_createActions:function(e){var n=this._actionsContainer,o=this.getActions(e),r=o.length,a,i,s,l;for(i=0,s=this._actionButtons.length;i<s;i++){this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback)};this._actionButtons=[];while(n.firstChild){n.removeChild(n.firstChild)};for(var t=0;t<r;t++){if('enabled' in o[t]&&!o[t].enabled){continue};a=L.DomUtil.create('li','',n);l=this._createButton({title:o[t].title,text:o[t].text,container:a,callback:o[t].callback,context:o[t].context});this._actionButtons.push({button:l,callback:o[t].callback})}},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,o=this._lastButtonIndex,e=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler);this._actionsContainer.style.top=e+'px';if(t===0){L.DomUtil.addClass(this._toolbarContainer,'leaflet-draw-toolbar-notop');L.DomUtil.addClass(this._actionsContainer,'leaflet-draw-actions-top')};if(t===o){L.DomUtil.addClass(this._toolbarContainer,'leaflet-draw-toolbar-nobottom');L.DomUtil.addClass(this._actionsContainer,'leaflet-draw-actions-bottom')};this._actionsContainer.style.display='block'},_hideActionsToolbar:function(){this._actionsContainer.style.display='none';L.DomUtil.removeClass(this._toolbarContainer,'leaflet-draw-toolbar-notop');L.DomUtil.removeClass(this._toolbarContainer,'leaflet-draw-toolbar-nobottom');L.DomUtil.removeClass(this._actionsContainer,'leaflet-draw-actions-top');L.DomUtil.removeClass(this._actionsContainer,'leaflet-draw-actions-bottom')}});
;L.Draw=L.Draw||{};L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t;this._popupPane=t._panes.popupPane;this._container=t.options.drawControlTooltips?L.DomUtil.create('div','leaflet-draw-tooltip',this._popupPane):null;this._singleLineLabel=!1;this._map.on('mouseout',this._onMouseOut,this)},dispose:function(){this._map.off('mouseout',this._onMouseOut,this);if(this._container){this._popupPane.removeChild(this._container);this._container=null}},updateContent:function(t){if(!this._container){return this};t.subtext=t.subtext||'';if(t.subtext.length===0&&!this._singleLineLabel){L.DomUtil.addClass(this._container,'leaflet-draw-tooltip-single');this._singleLineLabel=!0}
else if(t.subtext.length>0&&this._singleLineLabel){L.DomUtil.removeClass(this._container,'leaflet-draw-tooltip-single');this._singleLineLabel=!1};this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+'</span><br />':'')+'<span>'+t.text+'</span>';return this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;if(this._container){i.style.visibility='inherit';L.DomUtil.setPosition(i,e)};return this},showAsError:function(){if(this._container){L.DomUtil.addClass(this._container,'leaflet-error-draw-tooltip')};return this},removeError:function(){if(this._container){L.DomUtil.removeClass(this._container,'leaflet-error-draw-tooltip')};return this},_onMouseOut:function(){if(this._container){this._container.style.visibility='hidden'}}});
;L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:'draw'},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var o in this.options){if(this.options.hasOwnProperty(o)){if(t[o]){t[o]=L.extend({},this.options[o],t[o])}}};this._toolbarClass='leaflet-draw-draw';L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var o in this._modes){if(this._modes.hasOwnProperty(o)&&t.hasOwnProperty(o)){this._modes[o].handler.setOptions(t[o])}}}});
;L.EditToolbar=L.Toolbar.extend({statics:{TYPE:'edit'},options:{edit:{selectedPathOptions:{dashArray:'10, 10',fill:!0,fillColor:'#fe57a1',fillOpacity:0.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){if(t.edit){if(typeof t.edit.selectedPathOptions==='undefined'){t.edit.selectedPathOptions=this.options.edit.selectedPathOptions};t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)};if(t.remove){t.remove=L.extend({},this.options.remove,t.remove)};if(t.poly){t.poly=L.extend({},this.options.poly,t.poly)};this._toolbarClass='leaflet-draw-edit';L.Toolbar.prototype.initialize.call(this,t);this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this},{title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);this._checkDisabled();this.options.featureGroup.on('layeradd layerremove',this._checkDisabled,this);return e},removeToolbar:function(){this.options.featureGroup.off('layeradd layerremove',this._checkDisabled,this);L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){if(!this.enabled()){return};this._activeMode.handler.revertLayers();L.Toolbar.prototype.disable.call(this)},_save:function(){this._activeMode.handler.save();if(this._activeMode){this._activeMode.handler.disable()}},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers();if(this._activeMode){this._activeMode.handler.disable()}},_checkDisabled:function(){var o=this.options.featureGroup,e=o.getLayers().length!==0,t;if(this.options.edit){t=this._modes[L.EditToolbar.Edit.TYPE].button;if(e){L.DomUtil.removeClass(t,'leaflet-disabled')}
else{L.DomUtil.addClass(t,'leaflet-disabled')};t.setAttribute('title',e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)};if(this.options.remove){t=this._modes[L.EditToolbar.Delete.TYPE].button;if(e){L.DomUtil.removeClass(t,'leaflet-disabled')}
else{L.DomUtil.addClass(t,'leaflet-disabled')};t.setAttribute('title',e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled)}}});
;L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:'edit'},includes:L.Mixin.Events,initialize:function(t,e){L.Handler.prototype.initialize.call(this,t);L.setOptions(this,e);this._featureGroup=e.featureGroup;if(!(this._featureGroup instanceof L.FeatureGroup)){throw new Error('options.featureGroup must be a L.FeatureGroup')};this._uneditedLayerProps={};this.type=L.EditToolbar.Edit.TYPE},enable:function(){if(this._enabled||!this._hasAvailableLayers()){return};this.fire('enabled',{handler:this.type});this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type});L.Handler.prototype.enable.call(this);this._featureGroup.on('layeradd',this._enableLayerEdit,this).on('layerremove',this._disableLayerEdit,this)},disable:function(){if(!this._enabled){return};this._featureGroup.off('layeradd',this._enableLayerEdit,this).off('layerremove',this._disableLayerEdit,this);L.Handler.prototype.disable.call(this);this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type});this.fire('disabled',{handler:this.type})},addHooks:function(){var t=this._map;if(t){t.getContainer().focus();this._featureGroup.eachLayer(this._enableLayerEdit,this);this._tooltip=new L.Draw.Tooltip(this._map);this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext});t._editTooltip=this._tooltip;this._updateTooltip();this._map.on('mousemove',this._onMouseMove,this).on('touchmove',this._onMouseMove,this).on('MSPointerMove',this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this)}},removeHooks:function(){if(this._map){this._featureGroup.eachLayer(this._disableLayerEdit,this);this._uneditedLayerProps={};this._tooltip.dispose();this._tooltip=null;this._map.off('mousemove',this._onMouseMove,this).off('touchmove',this._onMouseMove,this).off('MSPointerMove',this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this)}},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup();this._featureGroup.eachLayer(function(e){if(e.edited){t.addLayer(e);e.edited=!1}});this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);if(!this._uneditedLayerProps[e]){if(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle){this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}}
else if(t instanceof L.Circle){this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}}
else if(t instanceof L.Marker){this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}}}},_getTooltipText:function(){return({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1;if(this._uneditedLayerProps.hasOwnProperty(e)){if(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle){t.setLatLngs(this._uneditedLayerProps[e].latlngs)}
else if(t instanceof L.Circle){t.setLatLng(this._uneditedLayerProps[e].latlng);t.setRadius(this._uneditedLayerProps[e].radius)}
else if(t instanceof L.Marker){t.setLatLng(this._uneditedLayerProps[e].latlng)};t.fire('revert-edited',{layer:t})}},_enableLayerEdit:function(e){var t=e.layer||e.target||e,i,o;this._backupLayer(t);if(this.options.poly){o=L.Util.extend({},this.options.poly);t.options.poly=o};if(this.options.selectedPathOptions){i=L.Util.extend({},this.options.selectedPathOptions);if(i.maintainColor){i.color=t.options.color;i.fillColor=t.options.fillColor};t.options.original=L.extend({},t.options);t.options.editing=i};if(t instanceof L.Marker){if(t.editing){t.editing.enable()};t.dragging.enable();t.on('dragend',this._onMarkerDragEnd).on('touchmove',this._onTouchMove,this).on('MSPointerMove',this._onTouchMove,this).on('touchend',this._onMarkerDragEnd,this).on('MSPointerUp',this._onMarkerDragEnd,this)}
else{t.editing.enable()}},_disableLayerEdit:function(e){var t=e.layer||e.target||e;t.edited=!1;if(t.editing){t.editing.disable()};delete t.options.editing;delete t.options.original;if(this._selectedPathOptions){if(t instanceof L.Marker){this._toggleMarkerHighlight(t)}
else{t.setStyle(t.options.previousOptions);delete t.options.previousOptions}};if(t instanceof L.Marker){t.dragging.disable();t.off('dragend',this._onMarkerDragEnd,this).off('touchmove',this._onTouchMove,this).off('MSPointerMove',this._onTouchMove,this).off('touchend',this._onMarkerDragEnd,this).off('MSPointerUp',this._onMarkerDragEnd,this)}
else{t.editing.disable()}},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0;this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=t.originalEvent.changedTouches[0],i=this._map.mouseEventToLayerPoint(e),o=this._map.layerPointToLatLng(i);t.target.setLatLng(o)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}});
;L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:'remove'},includes:L.Mixin.Events,initialize:function(e,t){L.Handler.prototype.initialize.call(this,e);L.Util.setOptions(this,t);this._deletableLayers=this.options.featureGroup;if(!(this._deletableLayers instanceof L.FeatureGroup)){throw new Error('options.featureGroup must be a L.FeatureGroup')};this.type=L.EditToolbar.Delete.TYPE},enable:function(){if(this._enabled||!this._hasAvailableLayers()){return};this.fire('enabled',{handler:this.type});this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type});L.Handler.prototype.enable.call(this);this._deletableLayers.on('layeradd',this._enableLayerDelete,this).on('layerremove',this._disableLayerDelete,this)},disable:function(){if(!this._enabled){return};this._deletableLayers.off('layeradd',this._enableLayerDelete,this).off('layerremove',this._disableLayerDelete,this);L.Handler.prototype.disable.call(this);this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type});this.fire('disabled',{handler:this.type})},addHooks:function(){var e=this._map;if(e){e.getContainer().focus();this._deletableLayers.eachLayer(this._enableLayerDelete,this);this._deletedLayers=new L.LayerGroup();this._tooltip=new L.Draw.Tooltip(this._map);this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text});this._map.on('mousemove',this._onMouseMove,this)}},removeHooks:function(){if(this._map){this._deletableLayers.eachLayer(this._disableLayerDelete,this);this._deletedLayers=null;this._tooltip.dispose();this._tooltip=null;this._map.off('mousemove',this._onMouseMove,this)}},revertLayers:function(){this._deletedLayers.eachLayer(function(e){this._deletableLayers.addLayer(e);e.fire('revert-deleted',{layer:e})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(e){this._removeLayer({layer:e})},this);this.save()},_enableLayerDelete:function(e){var t=e.layer||e.target||e;t.on('click',this._removeLayer,this)},_disableLayerDelete:function(e){var t=e.layer||e.target||e;t.off('click',this._removeLayer,this);this._deletedLayers.removeLayer(t)},_removeLayer:function(e){var t=e.layer||e.target||e;this._deletableLayers.removeLayer(t);this._deletedLayers.addLayer(t);t.fire('deleted')},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}});
;L.Draw.Rectangle=L.Draw.Rectangle||L.Draw.Feature.extend({});L.Draw.Circle=L.Draw.Circle||L.Draw.Feature.extend({});
(function(t){var e;if(typeof define==='function'&&define.amd){define(['leaflet'],t)}
else if(typeof module!=='undefined'){e=require('leaflet');module.exports=t(e)}
else{if(typeof window.L==='undefined')throw'Leaflet must be loaded first';t(window.L)}}(function(t){'use strict';t.Polyline._flat=t.Polyline._flat||function(e){return!t.Util.isArray(e[0])||(typeof e[0][0]!=='object'&&typeof e[0][0]!=='undefined')};t.GeometryUtil=t.extend(t.GeometryUtil||{},{distance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))},distanceSegment:function(e,n,r,i){var a=e.latLngToLayerPoint(n),o=e.latLngToLayerPoint(r),l=e.latLngToLayerPoint(i);return t.LineUtil.pointToSegmentDistance(a,o,l)},readableDistance:function(t,e){var r=(e!=='imperial'),n;if(r){if(t>1000){n=(t/1000).toFixed(2)+' km'}
else{n=Math.ceil(t)+' m'}}
else{t*=1.09361;if(t>1760){n=(t/1760).toFixed(2)+' miles'}
else{n=Math.ceil(t)+' yd'}};return n},belongsSegment:function(t,e,n,r){r=r===undefined?0.2:r;var i=e.distanceTo(n),a=e.distanceTo(t)+t.distanceTo(n)-i;return a/i<r},length:function(e){var n=t.GeometryUtil.accumulatedLengths(e);return n.length>0?n[n.length-1]:0},accumulatedLengths:function(t){if(typeof t.getLatLngs=='function'){t=t.getLatLngs()};if(t.length===0)return[];var n=0,r=[0];for(var e=0,i=t.length-1;e<i;e++){n+=t[e].distanceTo(t[e+1]);r.push(n)};return r},closestOnSegment:function(e,n,r,i){var a=e.getMaxZoom();if(a===Infinity)a=e.getZoom();var o=e.project(n,a),l=e.project(r,a),s=e.project(i,a),f=t.LineUtil.closestPointOnSegment(o,l,s);return e.unproject(f,a)},closest:function(n,e,r,o){var l,s=Infinity,a=null,i,u,f;if(e instanceof Array){if(e[0]instanceof Array&&typeof e[0][0]!=='number'){for(var i=0;i<e.length;i++){var c=t.GeometryUtil.closest(n,e[i],r,o);if(c.distance<s){s=c.distance;a=c}};return a}
else if(e[0]instanceof t.LatLng||typeof e[0][0]==='number'||typeof e[0].lat==='number'){e=t.polyline(e)}
else{return a}};if(!(e instanceof t.Polyline))return a;l=JSON.parse(JSON.stringify(e.getLatLngs().slice(0)));if(e instanceof t.Polygon){var h=function(e){if(t.Polyline._flat(e)){e.push(e[0])}
else{for(var n=0;n<e.length;n++){h(e[n])}}};h(l)};if(!t.Polyline._flat(l)){for(var i=0;i<l.length;i++){var c=t.GeometryUtil.closest(n,l[i],r,o);if(c.distance<s){s=c.distance;a=c}};return a}
else{if(o){for(i=0,u=l.length;i<u;i++){var L=l[i];f=t.GeometryUtil.distance(n,r,L);if(f<s){s=f;a=L;a.distance=f}};return a};for(i=0,u=l.length;i<u-1;i++){var g=l[i],y=l[i+1];f=t.GeometryUtil.distanceSegment(n,r,g,y);if(f<=s){s=f;a=t.GeometryUtil.closestOnSegment(n,r,g,y);a.distance=f}};return a}},closestLayer:function(e,n,r){var l=Infinity,c=null,a=null,o=Infinity;for(var f=0,u=n.length;f<u;f++){var i=n[f];if(i instanceof t.LayerGroup){var s=t.GeometryUtil.closestLayer(e,i.getLayers(),r);if(s.distance<l){l=s.distance;c=s}}
else{if(typeof i.getLatLng=='function'){a=i.getLatLng();o=t.GeometryUtil.distance(e,r,a)}
else{a=t.GeometryUtil.closest(e,i,r);if(a)o=a.distance};if(o<l){l=o;c={layer:i,latlng:a,distance:o}}}};return c},nClosestLayers:function(e,n,r,i){i=typeof i==='number'?i:n.length;if(i<1||n.length<1){return null};var o=[],f,l;for(var s=0,u=n.length;s<u;s++){var a=n[s];if(a instanceof t.LayerGroup){var c=t.GeometryUtil.closestLayer(e,a.getLayers(),r);o.push(c)}
else{if(typeof a.getLatLng=='function'){l=a.getLatLng();f=t.GeometryUtil.distance(e,r,l)}
else{l=t.GeometryUtil.closest(e,a,r);if(l)f=l.distance};o.push({layer:a,latlng:l,distance:f})}};o.sort(function(t,e){return t.distance-e.distance});if(o.length>i){return o.slice(0,i)}
else{return o}},layersWithin:function(e,n,r,i){i=typeof i=='number'?i:Infinity;var f=[],a=null,l=0;for(var s=0,u=n.length;s<u;s++){var o=n[s];if(typeof o.getLatLng=='function'){a=o.getLatLng();l=t.GeometryUtil.distance(e,r,a)}
else{a=t.GeometryUtil.closest(e,o,r);if(a)l=a.distance};if(a&&l<i){f.push({layer:o,latlng:a,distance:l})}};var c=f.sort(function(t,e){return t.distance-e.distance});return c},closestLayerSnap:function(e,n,r,i,o){i=typeof i=='number'?i:Infinity;o=typeof o=='boolean'?o:!0;var a=t.GeometryUtil.closestLayer(e,n,r);if(!a||a.distance>i)return null;if(o&&typeof a.layer.getLatLngs=='function'){var l=t.GeometryUtil.closest(e,a.layer,a.latlng,!0);if(l.distance<i){a.latlng=l;a.distance=t.GeometryUtil.distance(e,l,r)}};return a},interpolateOnPointSegment:function(e,n,r){return t.point((e.x*(1-r))+(r*n.x),(e.y*(1-r))+(r*n.y))},interpolateOnLine:function(n,e,r){e=(e instanceof t.Polyline)?e.getLatLngs():e;var g=e.length;if(g<2){return null};r=Math.max(Math.min(r,1),0);if(r===0){return{latLng:e[0]instanceof t.LatLng?e[0]:t.latLng(e[0]),predecessor:-1}};if(r==1){return{latLng:e[e.length-1]instanceof t.LatLng?e[e.length-1]:t.latLng(e[e.length-1]),predecessor:e.length-2}};var u=n.getMaxZoom();if(u===Infinity)u=n.getZoom();var a=[],L=0;for(var i=0;i<g;i++){a[i]=n.project(e[i],u);if(i>0)L+=a[i-1].distanceTo(a[i])};var y=L*r,s=a[0],o=a[1],f=0,l=s.distanceTo(o),c=1;for(;c<g&&l<y;c++){s=o;f=l;o=a[c];l+=s.distanceTo(o)};var h=((l-f)!==0)?((y-f)/(l-f)):0,d=t.GeometryUtil.interpolateOnPointSegment(s,o,h);return{latLng:n.unproject(d,u),predecessor:c-2}},locateOnLine:function(e,n,r){var i=n.getLatLngs();if(r.equals(i[0]))return 0.0;if(r.equals(i[i.length-1]))return 1.0;var f=t.GeometryUtil.closest(e,n,r,!1),o=t.GeometryUtil.accumulatedLengths(i),y=o[o.length-1],l=0,c=!1;for(var a=0,g=i.length-1;a<g;a++){var s=i[a],u=i[a+1];l=o[a];if(t.GeometryUtil.belongsSegment(f,s,u)){l+=s.distanceTo(f);c=!0;break}};if(!c){throw'Could not interpolate '+r.toString()+' within '+n.toString()};return l/y},reverse:function(e){return t.polyline(e.getLatLngs().slice(0).reverse())},extract:function(e,n,r,i){if(r>i){return t.GeometryUtil.extract(e,t.GeometryUtil.reverse(n),1.0-r,1.0-i)};r=Math.max(Math.min(r,1),0);i=Math.max(Math.min(i,1),0);var f=n.getLatLngs(),a=t.GeometryUtil.interpolateOnLine(e,n,r),o=t.GeometryUtil.interpolateOnLine(e,n,i);if(r==i){var s=t.GeometryUtil.interpolateOnLine(e,n,i);return[s.latLng]};if(a.predecessor==-1)a.predecessor=0;if(o.predecessor==-1)o.predecessor=0;var l=f.slice(a.predecessor+1,o.predecessor+1);l.unshift(a.latLng);l.push(o.latLng);return l},isBefore:function(t,e){if(!e)return!1;var n=t.getLatLngs(),r=e.getLatLngs();return(n[n.length-1]).equals(r[0])},isAfter:function(t,e){if(!e)return!1;var r=t.getLatLngs(),n=e.getLatLngs();return(r[0]).equals(n[n.length-1])},startsAtExtremity:function(t,e){if(!e)return!1;var i=t.getLatLngs(),n=e.getLatLngs(),r=i[0];return r.equals(n[0])||r.equals(n[n.length-1])},computeAngle:function(t,e){return(Math.atan2(e.y-t.y,e.x-t.x)*180/Math.PI)},computeSlope:function(t,e){var n=(e.y-t.y)/(e.x-t.x),r=t.y-(n*t.x);return{'a':n,'b':r}},rotatePoint:function(e,n,r,i){var o=e.getMaxZoom();if(o===Infinity)o=e.getZoom();var l=r*Math.PI/180,s=e.project(n,o),a=e.project(i,o),f=Math.cos(l)*(s.x-a.x)-Math.sin(l)*(s.y-a.y)+a.x,c=Math.sin(l)*(s.x-a.x)+Math.cos(l)*(s.y-a.y)+a.y;return e.unproject(new t.Point(f,c),o)},bearing:function(t,e){var n=Math.PI/180,a=t.lat*n,r=e.lat*n,o=t.lng*n,l=e.lng*n,s=Math.sin(l-o)*Math.cos(r),f=Math.cos(a)*Math.sin(r)-Math.sin(a)*Math.cos(r)*Math.cos(l-o),i=((Math.atan2(s,f)*180/Math.PI)+360)%360;return i>=180?i-360:i},destination:function(e,n,r){n=(n+360)%360;var a=Math.PI/180,o=180/Math.PI,l=6378137,h=e.lng*a,s=e.lat*a,f=n*a,c=Math.sin(s),u=Math.cos(s),g=Math.cos(r/l),y=Math.sin(r/l),L=Math.asin(c*g+u*y*Math.cos(f)),i=h+Math.atan2(Math.sin(f)*y*u,g-c*Math.sin(L));i=i*o;i=i>180?i-360:i<-180?i+360:i;return t.latLng([L*o,i])}});return t.GeometryUtil}));
(function(){L.Handler.MarkerSnap=L.Handler.extend({options:{snapDistance:15,snapVertices:!0},initialize:function(i,e,t){L.Handler.prototype.initialize.call(this,i);this._markers=[];this._guides=[];if(arguments.length==2){if(!(e instanceof L.Class)){t=e;e=null}};L.Util.setOptions(this,t||{});if(e){if(!e.dragging)e.dragging=new L.Handler.MarkerDrag(e);e.dragging.enable();this.watchMarker(e)};function n(){this._buffer=i.layerPointToLatLng(new L.Point(0,0)).lat-i.layerPointToLatLng(new L.Point(this.options.snapDistance,0)).lat};i.on('zoomend',n,this);i.whenReady(n,this);n.call(this)},enable:function(){this.disable();for(var i=0;i<this._markers.length;i++){this.watchMarker(this._markers[i])}},disable:function(){for(var i=0;i<this._markers.length;i++){this.unwatchMarker(this._markers[i])}},watchMarker:function(i){if(this._markers.indexOf(i)==-1)this._markers.push(i);i.on('move',this._snapMarker,this)},unwatchMarker:function(i){i.off('move',this._snapMarker,this);delete i['snap']},addGuideLayer:function(i){for(var e=0,t=this._guides.length;e<t;e++)if(L.stamp(i)===L.stamp(this._guides[e]))return;this._guides.push(i)},_snapMarker:function(i){var t=i.target,s=t.getLatLng(),n=[];function r(i){if(i.getLatLng){return L.stamp(t)!==L.stamp(i)}
else{if(i.editing&&i.editing._enabled){var n=i.editing._verticesHandlers[0]._markerGroup.getLayers();for(var e=0,a=n.length;e<a;e++){if(L.stamp(n[e])===L.stamp(t)){return!1}}}};return!0};function o(i){if((i._layers!==undefined)&&(typeof i.searchBuffer!=='function')){for(var t in i._layers){o(i._layers[t])}}
else if(typeof i.searchBuffer==='function'){var e=i.searchBuffer(s,this._buffer);n=n.concat(e.filter(function(i){return r(i)}))}
else if(r(i)){n.push(i)}};for(var a=0,l=this._guides.length;a<l;a++){var p=this._guides[a];o.call(this,p)};var e=this._findClosestLayerSnap(this._map,n,s,this.options.snapDistance,this.options.snapVertices);e=e||{layer:null,latlng:null};this._updateSnap(t,e.layer,e.latlng)},_findClosestLayerSnap:function(i,e,t,n,a){return L.GeometryUtil.closestLayerSnap(i,e,t,n,a)},_updateSnap:function(i,e,t){if(e&&t){i._latlng=L.latLng(t);i.update();if(i.snap!=e){i.snap=e;if(i._icon)L.DomUtil.addClass(i._icon,'marker-snapped');i.fire('snap',{layer:e,latlng:t})}}
else{if(i.snap){if(i._icon)L.DomUtil.removeClass(i._icon,'marker-snapped');i.fire('unsnap',{layer:i.snap})};delete i['snap']}}});if(!L.Edit){return};L.Handler.PolylineSnap=L.Edit.Poly.extend({initialize:function(i,e,t){var n=this;L.Edit.Poly.prototype.initialize.call(this,e,t);this._snapper=new L.Handler.MarkerSnap(i,t);e.on('remove',function(){n.disable()})},addGuideLayer:function(i){this._snapper.addGuideLayer(i)},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++){this._verticesHandlers.push(new L.Edit.PolyVerticesEditSnap(this._poly,this.latlngs[i],this.options))}}});L.Edit.PolyVerticesEditSnap=L.Edit.PolyVerticesEdit.extend({_createMarker:function(i,e){var t=L.Edit.PolyVerticesEdit.prototype._createMarker.call(this,i,e),n=e===undefined;if(n){t.on('dragstart',function(){this._poly.snapediting._snapper.watchMarker(t)},this)}
else{this._poly.snapediting._snapper.watchMarker(t)};return t}});L.EditToolbar.SnapEdit=L.EditToolbar.Edit.extend({snapOptions:{snapDistance:15,snapVertices:!0},initialize:function(i,e){L.EditToolbar.Edit.prototype.initialize.call(this,i,e);if(e.snapOptions){L.Util.extend(this.snapOptions,e.snapOptions)};if(Array.isArray(this.snapOptions.guideLayers)){this._guideLayers=this.snapOptions.guideLayers}
else if(e.guideLayers instanceof L.LayerGroup){this._guideLayers=this.snapOptions.guideLayers.getLayers()}
else{this._guideLayers=[]}},addGuideLayer:function(i){var e=this._guideLayers.findIndex(function(e){return L.stamp(i)===L.stamp(e)});if(e===-1){this._guideLayers.push(i);this._featureGroup.eachLayer(function(i){if(i.snapediting){i.snapediting._guides.push(i)}})}},removeGuideLayer:function(i){var e=this._guideLayers.findIndex(function(e){return L.stamp(i)===L.stamp(e)});if(e!==-1){this._guideLayers.splice(e,1);this._featureGroup.eachLayer(function(i){if(i.snapediting){i.snapediting._guides.splice(e,1)}})}},clearGuideLayers:function(){this._guideLayers=[];this._featureGroup.eachLayer(function(i){if(i.snapediting){i.snapediting._guides=[]}})},_enableLayerEdit:function(i){L.EditToolbar.Edit.prototype._enableLayerEdit.call(this,i);var e=i.layer||i.target||i;if(!e.snapediting){if(e.getLatLng){e.snapediting=new L.Handler.MarkerSnap(e._map,e,this.snapOptions)}
else{if(e.editing){e.editing._verticesHandlers[0]._markerGroup.clearLayers();delete e.editing};e.editing=e.snapediting=new L.Handler.PolylineSnap(e._map,e,this.snapOptions)};for(var t=0,n=this._guideLayers.length;t<n;t++){e.snapediting.addGuideLayer(this._guideLayers[t])}};e.snapediting.enable()}});L.Draw.Feature.SnapMixin={_snap_initialize:function(){this.on('enabled',this._snap_on_enabled,this);this.on('disabled',this._snap_on_disabled,this)},_snap_on_enabled:function(){if(!this.options.guideLayers){return};if(!this._mouseMarker){this._map.on('layeradd',this._snap_on_enabled,this);return}
else{this._map.off('layeradd',this._snap_on_enabled,this)};if(!this._snapper){this._snapper=new L.Handler.MarkerSnap(this._map);if(this.options.snapDistance){this._snapper.options.snapDistance=this.options.snapDistance};if(this.options.snapVertices){this._snapper.options.snapVertices=this.options.snapVertices}};for(var e=0,n=this.options.guideLayers.length;e<n;e++)this._snapper.addGuideLayer(this.options.guideLayers[e]);var i=this._mouseMarker;this._snapper.watchMarker(i);var t=i.options.icon;i.on('snap',function(e){i.setIcon(this.options.icon);i.setOpacity(1)},this).on('unsnap',function(e){i.setIcon(t);i.setOpacity(0)},this);i.on('click',this._snap_on_click,this)},_snap_on_click:function(i){if(this._markers){var n=this._markers.length,e=this._markers[n-1];if(this._mouseMarker.snap){if(i){e.setLatLng(i.target._latlng);if(this._poly){var t=this._poly._latlngs.length;this._poly._latlngs[t-1]=i.target._latlng;this._poly.redraw()}};L.DomUtil.addClass(e._icon,'marker-snapped')}}},_snap_on_disabled:function(){delete this._snapper},};L.Draw.Feature.include(L.Draw.Feature.SnapMixin);L.Draw.Feature.addInitHook('_snap_initialize')})();
;L.Control.Draw.Plus=L.Control.Draw.extend({snapLayers:new L.FeatureGroup(),editLayers:new L.FeatureGroup(),options:{draw:{marker:!1,polyline:!1,polygon:!1,rectangle:!1,circle:!1},edit:{edit:!1,remove:!1},entry:'edit-json',jsonOptions:{},changed:'edit-changed'},initialize:function(e){L.Util.extend(L.Draw.Polyline.prototype.options.shapeOptions,L.Polyline.prototype.options);L.Util.extend(L.Draw.Polygon.prototype.options.shapeOptions,L.Polygon.prototype.options);e.edit=L.extend(this.options.edit,e.edit);e.draw=L.extend(this.options.draw,e.draw);for(var t in e.draw)if(e.draw[t])e.draw[t]={guideLayers:[this.snapLayers]};L.Control.Draw.prototype.initialize.call(this,e)},onAdd:function(e){this._toolbars['edit'].options.featureGroup=this.editLayers;this.editLayers.addTo(this.snapLayers);this.snapLayers.addTo(e);e.on('draw:created',function(e){this.addLayer(e.layer)},this);e.on('layerremove',function(e){this.editLayers.removeLayer(e.layer)},this);var t=document.getElementById(this.options.entry);if(t){var i=typeof t.value!='undefined'?'value':'innerHTML',r=JSON.parse(t[i].replace(/\s/g,'')||'{"type":"FeatureCollection","features":[]}');new L.GeoJSON(this.explodeMultiFeatures(r),this.options.jsonOptions).addTo(this)};e.on('draw:created draw:editvertex',this._optimSavGeom,this);this._optimSavGeom(!1);return L.Control.Draw.prototype.onAdd.call(this,e)},explodeMultiFeatures:function(e){var i={type:'FeatureCollection',features:[]};switch(e.type){case'FeatureCollection':for(var t=0;t<e.features.length;t++)i.features.push(this.explodeMultiFeatures(e.features[t]));return i;case'Feature':return this.explodeMultiFeatures(e.geometry);case'MultiPoint':case'MultiLineString':case'MultiPolygon':for(var t=0;t<e.coordinates.length;t++)i.features.push({type:e.type.replace('Multi',''),coordinates:e.coordinates[t]});return i};return e},addLayer:function(e){if(e._layers){for(var t in e._layers)this.addLayer(e._layers[t]);return};e.on('mouseover mouseout',function(e){if(typeof e.target.setStyle=='function')e.target.setStyle({color:e.type=='mouseover'?'red':L.Polyline.prototype.options.color})});e.addTo(this.editLayers);if(e._latlng)e.snapediting=new L.Handler.MarkerSnap(this._map,e);else if(e._latlngs)e.snapediting=new L.Handler.PolylineSnap(this._map,e);else return;e.snapediting.addGuideLayer(this.snapLayers);e.snapediting.enable();this._optimSavGeom();e.on('deleted',function(){for(m in this._toolbars['edit']._modes)this._toolbars['edit']._modes[m].handler.disable();this._optimSavGeom()},this)},_optimSavGeom:function(i){var r=this.editLayers._layers;if(!this._map.noOptim)for(var o in r){var e=r[o]._latlngs;if(e&&!r[o].options.fill){if(e[0].equals(e[e.length-1])&&e.length>3){this.editLayers.removeLayer(r[o]);this.addLayer(new L.Polygon(e));return};for(var s in r){var t=r[s]._latlngs,a=null;if(o<s&&t&&!r[s].options.fill){if(e[0].equals(t[0])){e.reverse();a=t}
else if(e[0].equals(t[t.length-1])){e.reverse();a=t.reverse()}
else if(e[e.length-1].equals(t[0])){a=t}
else if(e[e.length-1].equals(t[t.length-1])){a=t.reverse()};if(a){a.shift();this.editLayers.removeLayer(r[o]);this.editLayers.removeLayer(r[s]);this.addLayer(new L.Polyline(e.concat(a)));return}}}}};var n=document.getElementById(this.options.entry),l=document.getElementById(this.options.changed);if(n){var d=typeof n.value!='undefined'?'value':'innerHTML';n[d]=JSON.stringify(this.editLayers.toGeoJSON())};this._map.fire('draw:entry-changed');if(l)l.style.display=i===!1?'none':''}});eval('L.Edit.PolyVerticesEdit.prototype._createMiddleMarker = '+L.Edit.PolyVerticesEdit.prototype._createMiddleMarker.toString().replace(/'click', onClick, this|'click',[a-z],this/g,'\'click\',this._cut,this'));L.Edit.PolyVerticesEdit.include({_cut:function(e){var i=0,t=[[],[]];for(m in this._markers){t[i].push(this._markers[m]._latlng);if(this._markers[m]._middleRight&&this._markers[m]._middleRight._leaflet_id==e.target._leaflet_id)i=1};this._map.removeLayer(this._poly);if(this._poly.options.fill)this._map.fire('draw:created',{layer:new L.Polyline(t[1].concat(t[0]))});else for(f in t)if(t[f].length>1)this._map.fire('draw:created',{layer:new L.Polyline(t[f])});this._map.fire('draw:editvertex')}});
;L.Control.Layers.include({addTo:function(o){var t=L.Control.prototype.addTo.call(this,o);L.DomEvent.on(this._container,{mouseleave:this.expand,mouseenter:function(){o.fire('cl_collapse',this)}},this);o.on('cl_collapse',this._collapse_others,this);o.on('mouseout',this.collapse,this);return t},_collapse_others:function(o){if(o._leaflet_id!=this._leaflet_id)this.collapse()},remove:function(){map.off('cl_collapse',this._collapse_others,this);map.off('mouseout',this.collapse,this);L.Control.prototype.remove.call(this)}});
;L.myLeafletVersion="1.0";L.Control.Scale.prototype.options.imperial=!1;L.Edit.PolyVerticesEdit.prototype.options.touchIcon.options.iconSize=new L.Point(8,8);if(navigator.language||navigator.userLanguage=="fr"){if(L.Control.Zoom)L.Control.Zoom=L.Control.Zoom.extend({options:{zoomInTitle:"Rapprocher",zoomOutTitle:"Eloigner"}});if(L.Control.Fullscreen)L.Control.Fullscreen=L.Control.Fullscreen.extend({options:{title:{"false":"Plein écran","true":"Sortir du plein écran"}}});if(L.Control.Gps)L.Control.Gps=L.Control.Gps.extend({options:{title:"Afficher votre position GPS"}});if(L.Control.FileLayerLoad)L.Control.FileLayerLoad=L.Control.FileLayerLoad.extend({statics:{TITLE:"Importer un fichier GPX, KML, GeoJSON",LABEL:"&#8657;"}});if(L.Control.OSMGeocoder)L.Control.OSMGeocoder=L.Control.OSMGeocoder.extend({options:{text:"Chercher"}});L.drawLocal={draw:{toolbar:{actions:{title:"Annuler le dessin",text:"Annuler"},finish:{title:"Finir le dessin",text:"Finir"},undo:{title:"Supprimer le dernier point",text:"Supprimer le dernier point"},buttons:{polyline:"Tracer une ligne",polygon:"Tracer un polygone",rectangle:"Tracer un rectangle",circle:"Tracer un cercle",marker:"Placer un marqueur"}},handlers:{circle:{tooltip:{start:"Cliquer et glisser pour tracer un cercle"},radius:"Rayon"},marker:{tooltip:{start:"Cliquer sur la carte pour placer un marqueur"}},polygon:{tooltip:{start:"Cliquer pour commencer le dessin d'un polygone",cont:"Cliquer pour continuer le dessin d'un polygone",end:"Cliquer sur le premier point clôt le polygone"}},polyline:{error:"<strong>Erreur:</strong> Les contours de la forme ne peuvent pas se croiser !",tooltip:{start:"Cliquer pour commencer une ligne",cont:"Cliquer pour continuer le dessin de la ligne",end:"Cliquer sur le dernier point pour finir la ligne"}},rectangle:{tooltip:{start:"Cliquer et glisser pour tracer un rectangle"}},simpleshape:{tooltip:{end:"Relacher la souris pour finir le dessin"}}}},edit:{toolbar:{actions:{save:{title:"Finir les changements",text:"Finir"},cancel:{title:"Annuler les changements",text:"Annuler"}},buttons:{edit:"Editer les éléments",editDisabled:"Pas d'élément",remove:"Supprimer un élément",removeDisabled:"Pas d'élément"}},handlers:{edit:{tooltip:{text:"Cliquer et glisser pour editer",subtext:"Cliquer annuler pour annuler les changements"}},remove:{tooltip:{text:"Cliquer sur un élément pour le supprimer"}}}}}};
;var originalInitTile=L.GridLayer.prototype._initTile;L.GridLayer.include({_initTile:function(i){originalInitTile.call(this,i);var t=this.getTileSize();i.style.width=t.x+1+'px';i.style.height=t.y+1+'px'}});L.Map.addInitHook(function(i){this.on('fullscreenchange',function(){this.invalidateSize()},this)});
;if(navigator.userAgent.search(/arach|archiver|bot|crawl|curl|factory|index|partner|rss|seek|search|semantic|scoot|spider|spyder|yandex/i)!=-1)L.Map.prototype.addLayer=function(){};